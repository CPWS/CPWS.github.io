<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>springdata | Prossible&#39;s Blog</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="SpringData内容介绍Spring整合Hibernate  Spring整合Hibernate步骤 Hibernate添加、修改、删除操作 Hibernate-HQL查询 Hibernate-SQL查询 Hibernate-QBC查询  Spring整合Hibernate基于JPA规范  Spring整合Hibernate JPA规范 Hibernate JPA中的CRUD操作 Hibern">
<meta name="keywords" content="springdata">
<meta property="og:type" content="article">
<meta property="og:title" content="springdata">
<meta property="og:url" content="https://CPWS.github.io/2019/12/28/springdata/index.html">
<meta property="og:site_name" content="Prossible&#39;s Blog">
<meta property="og:description" content="SpringData内容介绍Spring整合Hibernate  Spring整合Hibernate步骤 Hibernate添加、修改、删除操作 Hibernate-HQL查询 Hibernate-SQL查询 Hibernate-QBC查询  Spring整合Hibernate基于JPA规范  Spring整合Hibernate JPA规范 Hibernate JPA中的CRUD操作 Hibern">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://i.loli.net/2019/12/28/uvY6kPX5Wh3risV.png">
<meta property="og:image" content="https://i.loli.net/2019/12/28/uvY6kPX5Wh3risV.png">
<meta property="og:image" content="https://i.loli.net/2019/12/28/7vAEgPrCejct3QG.png">
<meta property="og:image" content="https://i.loli.net/2019/12/28/uvY6kPX5Wh3risV.png">
<meta property="og:image" content="https://i.loli.net/2019/12/28/7vAEgPrCejct3QG.png">
<meta property="og:image" content="https://i.loli.net/2019/12/28/xo5apukLfyw6iQ9.png">
<meta property="og:image" content="https://i.loli.net/2019/12/29/49coWOSUs8DlbyM.png">
<meta property="og:image" content="https://i.loli.net/2019/12/30/PMv5oOeBGY7zhy8.png">
<meta property="og:updated_time" content="2020-01-16T05:16:31.152Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="springdata">
<meta name="twitter:description" content="SpringData内容介绍Spring整合Hibernate  Spring整合Hibernate步骤 Hibernate添加、修改、删除操作 Hibernate-HQL查询 Hibernate-SQL查询 Hibernate-QBC查询  Spring整合Hibernate基于JPA规范  Spring整合Hibernate JPA规范 Hibernate JPA中的CRUD操作 Hibern">
<meta name="twitter:image" content="https://i.loli.net/2019/12/28/uvY6kPX5Wh3risV.png">
  
    <link rel="alternative" href="/atom.xml" title="Prossible&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg">
  
  <link rel="stylesheet" href="/CPWS.github.io/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head></html>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://img.mp.itc.cn/q_mini,c_zoom,w_640/upload/20161221/c495640d0fc24a91b9c95dc0d54b6002_th.jpeg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">zhuli</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/CPWS.github.io/archives">所有文章</a></li>
				        
							<li><a href="/CPWS.github.io/">主页</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/CPWS.github.io/tags/Elasticsearch/" style="font-size: 10px;">Elasticsearch</a> <a href="/CPWS.github.io/tags/Hibernate4/" style="font-size: 10px;">Hibernate4</a> <a href="/CPWS.github.io/tags/HttpClient/" style="font-size: 10px;">HttpClient</a> <a href="/CPWS.github.io/tags/Java框架下载路径/" style="font-size: 10px;">Java框架下载路径</a> <a href="/CPWS.github.io/tags/Java邮箱接口/" style="font-size: 10px;">Java邮箱接口</a> <a href="/CPWS.github.io/tags/Log4j与Junit测试/" style="font-size: 10px;">Log4j与Junit测试</a> <a href="/CPWS.github.io/tags/Lucene/" style="font-size: 10px;">Lucene</a> <a href="/CPWS.github.io/tags/Mybatis3/" style="font-size: 10px;">Mybatis3</a> <a href="/CPWS.github.io/tags/SSM/" style="font-size: 10px;">SSM</a> <a href="/CPWS.github.io/tags/SSM框架整合-配置文件/" style="font-size: 10px;">SSM框架整合-配置文件</a> <a href="/CPWS.github.io/tags/Struts2/" style="font-size: 10px;">Struts2</a> <a href="/CPWS.github.io/tags/Struts2-5/" style="font-size: 10px;">Struts2.5</a> <a href="/CPWS.github.io/tags/fastdsf/" style="font-size: 10px;">fastdsf</a> <a href="/CPWS.github.io/tags/hibernate5/" style="font-size: 10px;">hibernate5</a> <a href="/CPWS.github.io/tags/maven/" style="font-size: 10px;">maven</a> <a href="/CPWS.github.io/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/CPWS.github.io/tags/redis/" style="font-size: 10px;">redis</a> <a href="/CPWS.github.io/tags/solr/" style="font-size: 10px;">solr</a> <a href="/CPWS.github.io/tags/spring4/" style="font-size: 10px;">spring4</a> <a href="/CPWS.github.io/tags/springdata/" style="font-size: 10px;">springdata</a> <a href="/CPWS.github.io/tags/springmvc/" style="font-size: 10px;">springmvc</a> <a href="/CPWS.github.io/tags/专插本c语言/" style="font-size: 10px;">专插本c语言</a> <a href="/CPWS.github.io/tags/四级翻译/" style="font-size: 10px;">四级翻译</a> <a href="/CPWS.github.io/tags/四级选词填空/" style="font-size: 10px;">四级选词填空</a> <a href="/CPWS.github.io/tags/搜索引擎框架介绍/" style="font-size: 10px;">搜索引擎框架介绍</a> <a href="/CPWS.github.io/tags/数据库系统概述/" style="font-size: 10px;">数据库系统概述</a> <a href="/CPWS.github.io/tags/文件上传/" style="font-size: 10px;">文件上传</a> <a href="/CPWS.github.io/tags/文档study/" style="font-size: 10px;">文档study</a> <a href="/CPWS.github.io/tags/正则表达式/" style="font-size: 10px;">正则表达式</a> <a href="/CPWS.github.io/tags/注解与反射/" style="font-size: 10px;">注解与反射</a> <a href="/CPWS.github.io/tags/深入使用struts2/" style="font-size: 10px;">深入使用struts2</a> <a href="/CPWS.github.io/tags/英语四级作文/" style="font-size: 10px;">英语四级作文</a> <a href="/CPWS.github.io/tags/解决中文乱码/" style="font-size: 10px;">解决中文乱码</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">zhuli</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://img.mp.itc.cn/q_mini,c_zoom,w_640/upload/20161221/c495640d0fc24a91b9c95dc0d54b6002_th.jpeg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">zhuli</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/CPWS.github.io/archives">所有文章</a></li>
		        
					<li><a href="/CPWS.github.io/">主页</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-springdata" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/CPWS.github.io/2019/12/28/springdata/" class="article-date">
  	<time datetime="2019-12-28T00:47:10.000Z" itemprop="datePublished">2019-12-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      springdata
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/CPWS.github.io/tags/springdata/">springdata</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/CPWS.github.io/categories/back-end/">back-end</a>
	</div>


        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="SpringData内容介绍"><a href="#SpringData内容介绍" class="headerlink" title="SpringData内容介绍"></a><code>SpringData</code>内容介绍</h2><p><strong><code>Spring</code>整合<code>Hibernate</code></strong></p>
<ol>
<li>Spring整合Hibernate步骤</li>
<li>Hibernate添加、修改、删除操作</li>
<li>Hibernate-HQL查询</li>
<li>Hibernate-SQL查询</li>
<li>Hibernate-QBC查询</li>
</ol>
<p><strong><code>Spring</code>整合<code>Hibernate</code>基于<code>JPA</code>规范</strong></p>
<ol>
<li>Spring整合Hibernate JPA规范</li>
<li>Hibernate JPA中的CRUD操作</li>
<li>Hibernate JPA中的HQL查询</li>
<li>Hibernate JPA中的SQL查询</li>
<li>Hibernate JPA中的QBC查询</li>
</ol>
<p><strong><code>Spring Data JPA</code></strong></p>
<ol>
<li><p>Spring Data JPA 初级</p>
<ol>
<li>Spring Data JPA介绍</li>
<li>Spring Data整合JPA</li>
<li>Spring Data JPA核心与继承结构</li>
<li>Spring Data JPA源码分析</li>
</ol>
</li>
<li><p>Spring Data JPA接口详解</p>
<ol>
<li>Repository接口-方法命名规则查询</li>
<li>Repository接口-@Query注解查询</li>
<li>Repository接口-@Query注解跟新操作</li>
<li>CrudRepository接口讲解</li>
<li>PagingAndSortingRepository接口讲解</li>
<li>JpaRepository接口讲解</li>
<li>JpaspecificationExecutor接口讲解</li>
<li>自定义Repository接口</li>
</ol>
</li>
<li><p>Spring Data JPA关联关系查询</p>
<ol>
<li>Spring Data JPA一对一关联关系查询</li>
<li>Spring Data JPA一对多关联关系查询</li>
<li>Spring Data JPA多对多关联关系查询</li>
</ol>
</li>
</ol>
<p><strong><code>Spring Data Redis</code></strong></p>
<ol>
<li>Redis安装</li>
<li>Spring Data Redis整合Redis</li>
<li>Spring Data Redis序列化器使用</li>
</ol>
<p>课程中使用到的工具</p>
<ol>
<li>JDK1.7.0_72 </li>
<li>Eclipse Mars</li>
<li>Hibernate:5.0.7Final</li>
<li>Spring 4.2.0RELEASE</li>
<li>Spring Data JPA：1.9.0RELEASE</li>
<li>Spring Data Redis：1.6.0RELEASE</li>
</ol>
<p>课程技术要求</p>
<ul>
<li>需要对<code>Spring</code>、<code>Hibernate</code>、<code>Redis</code>技术有一定的了解</li>
</ul>
<h2 id="课程技术介绍"><a href="#课程技术介绍" class="headerlink" title="课程技术介绍"></a>课程技术介绍</h2><p><strong>Hibernate</strong></p>
<ul>
<li>Hibernate是一个开放源代码的对象关系映射框架，它对JDBC进行了非常轻量级的对象封装，它将POJO与数据库表建立映射关系，是一个全自动的orm框架，hibernate可以自动生成SQL语句，自动执行，使得Java程序员可以随心所欲的使用对象编程思维来操纵数据库。 Hibernate可以应用在任何使用JDBC的场合，既可以在Java的客户端程序使用，也可以在Servlet/JSP的Web应用中使用，最具革命意义的是，Hibernate可以在应用EJB的JaveEE架构中取代CMP，完成数据持久化的重任。</li>
</ul>
<p><strong>JPA标准</strong></p>
<ul>
<li>JPA是Java Persistence API的简称，中文名Java持久层API，是JDK 5.0注解或XML描述对象－关系表的映射关系，并将运行期的实体对象持久化到数据库中。 [1] </li>
<li>Sun引入新的JPA ORM规范出于两个原因：其一，简化现有Java EE和Java SE应用开发工作；其二，Sun希望整合ORM技术，实现天下归一。</li>
</ul>
<p><strong>Hibernate JPA</strong></p>
<ul>
<li>Hibernate在3.2以后根据JPA规范提供了一套操作持久层的API</li>
</ul>
<p><strong>Spring Data</strong></p>
<ul>
<li>Spring Data’s mission is to provide a familiar and consistent, Spring-based programming model for data access while still retaining the special traits of the underlying data store.</li>
</ul>
<p><strong>Spring Data JPA</strong></p>
<ul>
<li>Spring Data JPA, part of the larger Spring Data family, makes it easy to easily implement JPA based repositories. This module deals with enhanced support for JPA based data access layers. It makes it easier to build Spring-powered applications that use data access technologies.</li>
<li>Spring Data JPA底层默认使用Hibernate来做JPA实现。</li>
</ul>
<p><strong>Spring Data Redis</strong></p>
<ul>
<li>Spring Data Redis, part of the larger Spring Data family, provides easy configuration and access to Redis from Spring applications. It offers both low-level and high-level abstractions for interacting with the store, freeing the user from infrastructural concerns.</li>
</ul>
<h2 id="SpringData第一章-Spring整合Hibernate"><a href="#SpringData第一章-Spring整合Hibernate" class="headerlink" title="SpringData第一章 Spring整合Hibernate"></a>SpringData第一章 Spring整合Hibernate</h2><p><strong>创建项目</strong></p>
<ol>
<li><p>导入jar包</p>
<ul>
<li>Hibernate</li>
<li>Hibernate C3P0</li>
<li>spring-ioc、spring-aop、spring-jdbc、spring-orm、spring-test</li>
<li>commons-logging-1.1.1</li>
<li>mysql驱动包</li>
<li>单元测试：junit4</li>
</ul>
</li>
</ol>
<p><img src="https://i.loli.net/2019/12/28/uvY6kPX5Wh3risV.png" alt="1577500768_1_.png"></p>
<ol start="2">
<li>创建Spring的配置文件<strong>applicationContext.xml</strong>,存放在src目录下</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong><code>Spring</code> 整合 <code>Hibernate</code> 配置文件：applicationContext.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">     	</span><br><span class="line">     	<span class="comment">&lt;!-- 配置读取properties文件的工具类 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:jdbc.properties"</span>/&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置C3P0数据库连接池 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置Hibernate的SessionFactory --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate5.LocalSessionFactoryBean"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="comment">&lt;!-- Hibernate Properties属性：配置与Hibernate相关的内容，如显示sql语句，开启正向工程 --&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 显示当前执行的sql语句 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 开启正向工程 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                     <span class="comment">&lt;!-- mysql数据库方言 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQL5InnoDBDialect<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 指定采用的是数据库连接池 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.temp.use_jdbc_metadata_defaults"</span>&gt;</span>false<span class="tag">&lt;/<span class="name">prop</span>&gt;</span>  </span><br><span class="line">     			<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="comment">&lt;!-- 扫描实体所在的包 --&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"packagesToScan"</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">value</span>&gt;</span>com.gdaib.pojo<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置Hibernate的事务管理器 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate5.HibernateTransactionManager"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sessionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置开启注解事务处理 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">tx:annotation-driven</span>  <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置Spring IOC的注解扫描--&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>Hibernate完成CRUD操作</strong></p>
<ol>
<li>mysql下创建test数据库</li>
<li>在com.gdaib.pojo包下创建一个实体类：Users.java</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"t_users"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Users</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//GenerationType.IDENTITY：id自增长</span></span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">	<span class="meta">@Column</span>(name=<span class="string">"userid"</span>)</span><br><span class="line">	<span class="keyword">private</span> Integer userid;</span><br><span class="line">	<span class="meta">@Column</span>(name=<span class="string">"username"</span>)</span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="meta">@Column</span>(name=<span class="string">"userage"</span>)</span><br><span class="line">	<span class="keyword">private</span> Integer userage;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getUserid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userid;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserid</span><span class="params">(Integer userid)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.userid = userid;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> username;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.username = username;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getUserage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userage;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserage</span><span class="params">(Integer userage)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.userage = userage;</span><br><span class="line">	&#125;	</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>编写UsersDao接口和实现类</p>
<ul>
<li>修改配置文件，添加HibernateTemplate的配置</li>
</ul>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置HibernateTemplate对象 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"hibernateTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate5.HibernateTemplate"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sessionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>接口实现类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.hibernate5.HibernateTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.dao.UsersDao;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.pojo.Users;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UsersDaoImpl</span> <span class="keyword">implements</span> <span class="title">UsersDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> HibernateTemplate hibernateTemplate;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUsers</span><span class="params">(Users users)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">this</span>.hibernateTemplate.save(users);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUsers</span><span class="params">(Users users)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">this</span>.hibernateTemplate.update(users);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUsers</span><span class="params">(Users users)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">this</span>.hibernateTemplate.delete(users);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Users <span class="title">selectUsersById</span><span class="params">(Integer userid)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.hibernateTemplate.get(Users.class, userid);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>编写测试代码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.annotation.Rollback;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.dao.UsersDao;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.pojo.Users;</span><br><span class="line"></span><br><span class="line"><span class="comment">//spring整合junit</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</span><br><span class="line"><span class="meta">@ContextConfiguration</span>(<span class="string">"classpath:applicationContext.xml"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UsersDaoImplTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UsersDao usersDao;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 测试添加用户</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="meta">@Transactional</span> <span class="comment">//在测试类，对于事务提交默认的是回滚，在业务逻辑类中不会，此时应该再加一个注解</span></span><br><span class="line">	<span class="meta">@Rollback</span>(<span class="keyword">false</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">textInsertUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Users users=<span class="keyword">new</span> Users();</span><br><span class="line">		users.setUserage(<span class="number">20</span>);</span><br><span class="line">		users.setUsernames(<span class="string">"李四"</span>);</span><br><span class="line">		<span class="keyword">this</span>.usersDao.insertUsers(users);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 跟新用户</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="meta">@Transactional</span></span><br><span class="line">	<span class="meta">@Rollback</span>(<span class="keyword">false</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Users users=<span class="keyword">new</span> Users();</span><br><span class="line">		users.setUserid(<span class="number">1</span>);</span><br><span class="line">		users.setUserage(<span class="number">22</span>);</span><br><span class="line">		users.setUsernames(<span class="string">"王五"</span>);</span><br><span class="line">		<span class="keyword">this</span>.usersDao.updateUsers(users);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 根据userid查询用户</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectUsersById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Users users = <span class="keyword">this</span>.usersDao.selectUsersById(<span class="number">1</span>);</span><br><span class="line">		System.out.println(users);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 删除用户</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="meta">@Transactional</span></span><br><span class="line">	<span class="meta">@Rollback</span>(<span class="keyword">false</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Users users=<span class="keyword">new</span> Users();</span><br><span class="line">		users.setUserid(<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">this</span>.usersDao.deleteUsers(users);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>HQL查询</strong></p>
<p>HQL：<code>Hibernate Query Language</code></p>
<p>HQL的语法：就是将原来的sql语句中表和字段换成对象与属性的名称就可以了。</p>
<p>业务代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">selectUserByName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//getCurrentSession：当前session必须要有事务边界，且只能处理唯一的一个事务。当事务提交或者回滚后session自动失效</span></span><br><span class="line">    <span class="comment">//openSession：每次都会打开一个新的session。假如每次使用多次，则获得不同的session对象。使用完毕后我们需要手动clase方法关闭session</span></span><br><span class="line">    Session session=<span class="keyword">this</span>.hibernateTemplate.getSessionFactory().getCurrentSession();</span><br><span class="line">    Query query = session.createQuery(<span class="string">"from Users where usernames=:abc"</span>);</span><br><span class="line">    Query queryTemp = query.setString(<span class="string">"abc"</span>,name);</span><br><span class="line">    <span class="keyword">return</span> queryTemp.list();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">* HQL测试</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectUsersByName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Users&gt; list = <span class="keyword">this</span>.usersDao.selectUserByName(<span class="string">"李四"</span>);</span><br><span class="line">    <span class="keyword">for</span> (Users users : list) &#123;</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>SQL查询</strong></p>
<p>业务代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">selectUserByNameUseSQL</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    Session session=<span class="keyword">this</span>.hibernateTemplate.getSessionFactory().getCurrentSession();</span><br><span class="line">    Query query=session.createSQLQuery(<span class="string">"select * from t_user where usernames=?"</span>)</span><br><span class="line">                        .addEntity(Users.class)</span><br><span class="line">                        .setString(<span class="number">0</span>, name);</span><br><span class="line">    <span class="keyword">return</span> query.list();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">* SQL测试</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectUsersByNameUseSQL</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Users&gt; list = <span class="keyword">this</span>.usersDao.selectUserByNameUseSQL(<span class="string">"李四"</span>);</span><br><span class="line">    <span class="keyword">for</span> (Users users : list) &#123;</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>QBC查询</strong></p>
<p>QBC：Query By Criteria</p>
<p>业务代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">selectUserByNameUseCriteria</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    Session session=<span class="keyword">this</span>.hibernateTemplate.getSessionFactory().getCurrentSession();</span><br><span class="line">    <span class="comment">//select * from t_user where username = ?</span></span><br><span class="line">    <span class="comment">//session.createCriteria(Users.class)相当于select * from t_users</span></span><br><span class="line">    Criteria c = session.createCriteria(Users.class);</span><br><span class="line">    c.add(Restrictions.eq(<span class="string">"usernames"</span>,name));</span><br><span class="line">    <span class="keyword">return</span> c.list();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">* QBC测试</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectUsersByNameUseCriteria</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Users&gt; list = <span class="keyword">this</span>.usersDao.selectUserByNameUseCriteria(<span class="string">"李四"</span>);</span><br><span class="line">    <span class="keyword">for</span> (Users users : list) &#123;</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SpringData第二章-Spring整合Hibernate-JPA"><a href="#SpringData第二章-Spring整合Hibernate-JPA" class="headerlink" title="SpringData第二章 Spring整合Hibernate JPA"></a>SpringData第二章 Spring整合Hibernate JPA</h2><p>JPA：由sun公司提供了一对对持久层操作的标准（接口+文档）<br>Hibernate: 是Gravin King开发的一套持久层操作全自动的ORM框架<br>Hibernate JPA：是在Hibernate3.2版本中提供了对于JPA标准的实现。提供了一套按照JPA标准来实现持久层开发的API.</p>
<p><strong>Spring整合Hibernate JPA</strong></p>
<ol>
<li><p>创建项目</p>
</li>
<li><p>导入jar包</p>
<ul>
<li>Hibernate</li>
<li>Hibernate C3P0</li>
<li>spring-ioc、spring-aop、spring-jdbc、spring-orm、spring-test</li>
<li>commons-logging-1.1.1</li>
<li>mysql驱动包</li>
<li>单元测试：junit4</li>
<li>Hibernate JPA相关的jar包</li>
</ul>
</li>
</ol>
<p><img src="https://i.loli.net/2019/12/28/uvY6kPX5Wh3risV.png" alt="1577500768_1_.png"><br><img src="https://i.loli.net/2019/12/28/7vAEgPrCejct3QG.png" alt="1577523613_1_.png"></p>
<ol start="3">
<li>Spring整合hibernate jpa配置文件，applicationContext.xml</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">     	</span><br><span class="line">     	<span class="comment">&lt;!-- 配置读取properties文件的工具类 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:jdbc.properties"</span>/&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置C3P0数据库连接池 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- Spring整合Hibernate JPA 配置EntityManagerFactory --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"entityManagerFactory"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="comment">&lt;!-- 决定使用哪个JPA标准 --&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jpaVedorAdapter"</span> &gt;</span></span><br><span class="line">     			<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- hibernate相关属性的注入 --&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 配置数据库类型 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"database"</span> <span class="attr">value</span>=<span class="string">"MYSQL"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 正向工程 自动创建表 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"generateDbl"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 显示执行的SQL --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"showSql"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="comment">&lt;!-- 扫描实体包 --&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"packagesToScan"</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">value</span>&gt;</span>com.gdaib.pojo<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	</span><br><span class="line">     	</span><br><span class="line">     	<span class="comment">&lt;!-- 配置Hibernate的事务管理器 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.JpaTransactionManager"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"entityManagerFactory"</span> <span class="attr">ref</span>=<span class="string">"entityManagerFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置开启注解事务处理 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">tx:annotation-driven</span>  <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置Spring IOC的注解扫描--&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>hibernate-jpa实现CRUD操作</strong></p>
<p>接口实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.EntityManager;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.PersistenceContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.dao.UsersDao;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.pojo.Users;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UsersDaoImpl</span> <span class="keyword">implements</span> <span class="title">UsersDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//@PersistenceContext(name="entityManagerFactory")：从工厂中取出一个对象，赋值给EntityManager</span></span><br><span class="line">	<span class="meta">@PersistenceContext</span>(name=<span class="string">"entityManagerFactory"</span>)</span><br><span class="line">	<span class="keyword">private</span> EntityManager entityManager;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUsers</span><span class="params">(Users users)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">this</span>.entityManager.persist(users);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUsers</span><span class="params">(Users users)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.entityManager.merge(users);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUsers</span><span class="params">(Users users)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Users u = <span class="keyword">this</span>.selectUsersById(users.getUserid());</span><br><span class="line">		<span class="keyword">this</span>.entityManager.remove(u);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Users <span class="title">selectUsersById</span><span class="params">(Integer userid)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.entityManager.find(Users.class, userid);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试代码与之前雷同</p>
<p><strong>hibernate-jpa中的HQL语句</strong></p>
<p>Hibernate JPA中的HQL语句</p>
<p>接口实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">selectUserByName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.entityManager.createQuery(<span class="string">"from Users where usernames =:abc"</span>)</span><br><span class="line">        .setParameter(<span class="string">"abc"</span>,name)</span><br><span class="line">        .getResultList(); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>测试代码与上面雷同</li>
</ul>
<p><strong>hibernate-jpa中的SQL语句</strong></p>
<p>Hibernate JPA中的SQL语句</p>
<p>接口实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">selectUserByNameUseSQL</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">    <span class="comment">//在hibernate jpa中如果通过?方法来绑定参数，那么它的查数是从1开始，而hibernate是从0开始</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.entityManager.createNativeQuery(<span class="string">"select * from t_users where usernames = ? "</span>, Users.class)</span><br><span class="line">            .setParameter(<span class="number">1</span>, name)</span><br><span class="line">            .getResultList();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>测试代码与上面雷同</li>
</ul>
<p><strong>hibernate-jpa中的Criteria语句</strong></p>
<p>Hibernate JPA中的QBC语句</p>
<ul>
<li>接口实现类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">selectUserByNameUseCriteria</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">    <span class="comment">//CriteriaBuilder对象：创建一个CriteriaQuery，创建查询条件</span></span><br><span class="line">    CriteriaBuilder builder=<span class="keyword">this</span>.entityManager.getCriteriaBuilder();</span><br><span class="line">    <span class="comment">//CriteriaQuery对象：执行查询的criteria对象</span></span><br><span class="line">    <span class="comment">//下面代码相当于select * from t_users</span></span><br><span class="line">    CriteriaQuery&lt;Users&gt; query = builder.createQuery(Users.class);</span><br><span class="line">    <span class="comment">//获取要查询的实体类对象</span></span><br><span class="line">    Root&lt;Users&gt; root=query.from(Users.class);</span><br><span class="line">    <span class="comment">//封装查询条件</span></span><br><span class="line">    Predicate cate = builder.equal(root.get(<span class="string">"usernames"</span>), name);</span><br><span class="line">    query.where(cate);<span class="comment">//加查询条件 where usernames=name;</span></span><br><span class="line">    <span class="comment">//执行查询</span></span><br><span class="line">    TypedQuery&lt;Users&gt; typeQuery=<span class="keyword">this</span>.entityManager.createQuery(query);</span><br><span class="line">    <span class="keyword">return</span> typeQuery.getResultList();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SpringData-第三章-Spring-Data-JPA（重点）"><a href="#SpringData-第三章-Spring-Data-JPA（重点）" class="headerlink" title="SpringData 第三章 Spring Data JPA（重点）"></a>SpringData 第三章 Spring Data JPA（重点）</h2><p>Spring Data JPA：Spring Data JPA是Spring Data项目下的一个模块。提供了一套基于JPA标准操作数据库的简化方案。底层默认的是依赖Hibernate JPA来实现的。</p>
<p>Spring Data JPA的技术特点： 我们只需要定义接口并继承Spring Data JPA中所提供的的接口就可以了，不需要编写接口实现类。</p>
<p><strong>创建Spring Data JPA项目</strong></p>
<ol>
<li><p>创建项目</p>
</li>
<li><p>导入jar包</p>
<ul>
<li>Hibernate</li>
<li>Hibernate C3P0</li>
<li>spring-ioc、spring-aop、spring-jdbc、spring-orm、spring-test</li>
<li>commons-logging-1.1.1</li>
<li>mysql驱动包</li>
<li>单元测试：junit4</li>
<li>Hibernate JPA相关的jar包</li>
<li>spring-data-jpa两个jar包</li>
<li>slf4j三个jar包</li>
</ul>
</li>
</ol>
<p><img src="https://i.loli.net/2019/12/28/uvY6kPX5Wh3risV.png" alt="1577500768_1_.png"><br><img src="https://i.loli.net/2019/12/28/7vAEgPrCejct3QG.png" alt="1577523613_1_.png"><br><img src="https://i.loli.net/2019/12/28/xo5apukLfyw6iQ9.png" alt="1577537711_1_.png"></p>
<ol start="3">
<li>修改配置文件 applicationContext.xml</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:jpa</span>=<span class="string">"http://www.springframework.org/schema/data/jpa"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/data/jpa </span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/data/jpa/spring-jpa.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">     	</span><br><span class="line">     	<span class="comment">&lt;!-- 配置读取properties文件的工具类 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:jdbc.properties"</span>/&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置C3P0数据库连接池 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- Spring整合Hibernate JPA 配置EntityManagerFactory --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"entityManagerFactory"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="comment">&lt;!-- 决定使用哪个JPA标准 --&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jpaVendorAdapter"</span> &gt;</span></span><br><span class="line">     			<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- hibernate相关属性的注入 --&gt;</span></span><br><span class="line">     				</span><br><span class="line">     				<span class="comment">&lt;!-- 配置数据库类型 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"database"</span> <span class="attr">value</span>=<span class="string">"MYSQL"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 正向工程 自动创建表 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"generateDdl"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 显示执行的SQL --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"showSql"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="comment">&lt;!-- 扫描实体包 --&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"packagesToScan"</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">value</span>&gt;</span>com.gdaib.pojo<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	</span><br><span class="line">     	<span class="comment">&lt;!-- 配置Hibernate的事务管理器 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.JpaTransactionManager"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"entityManagerFactory"</span> <span class="attr">ref</span>=<span class="string">"entityManagerFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置开启注解事务处理 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">tx:annotation-driven</span>  <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置Spring IOC的注解扫描--&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- Spring Data JPA的配置 --&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- base-package：扫描dao接口所在的包 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">jpa:repositories</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib.dao"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>编写DAO接口</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.pojo.Users;</span><br><span class="line"><span class="comment">//第一个参数要操作的实体类型，第二个参数为主键的数据类型</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UsersDao</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Users</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>编写测试类</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UsersDao usersDao;</span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">	* 测试添加用户</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Transactional</span> <span class="comment">//在测试类，对于事务提交默认的是回滚，在业务逻辑类中不会，此时应该再加一个注解</span></span><br><span class="line"><span class="meta">@Rollback</span>(<span class="keyword">false</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">textInsertUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Users users=<span class="keyword">new</span> Users();</span><br><span class="line">	users.setUserage(<span class="number">29</span>);</span><br><span class="line">	users.setUsernames(<span class="string">"possible"</span>);</span><br><span class="line">	<span class="keyword">this</span>.usersDao.save(users);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Spring Data JPA的接口继承结构</strong></p>
<p><img src="https://i.loli.net/2019/12/29/49coWOSUs8DlbyM.png" alt="1577609676_1_.png"></p>
<p><strong>Spring Data JPA的运行原理</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> EntityManager entityManager;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//org.springframework.data.jpa.repository.support.SimpleJpaRepository@320494b6</span></span><br><span class="line">	<span class="comment">//System.out.println(this.usersDao);</span></span><br><span class="line">	<span class="comment">//class com.sun.proxy.$Proxy30(代理对象) 是基于jdk动态代理实现的</span></span><br><span class="line">	<span class="comment">//System.out.println(this.usersDao.getClass());</span></span><br><span class="line">	JpaRepositoryFactory factory=<span class="keyword">new</span> JpaRepositoryFactory(entityManager);</span><br><span class="line">	<span class="comment">//factory.getRepository(UsersDao.class)可以帮助我们为接口生成实现类，而这个实现类是SimpleJpaRepository的代理对象</span></span><br><span class="line">	<span class="comment">//要求：该接口必须要继承Repository接口</span></span><br><span class="line">	UsersDao ud = factory.getRepository(UsersDao.class);</span><br><span class="line">	System.out.println(ud);</span><br><span class="line">	System.out.println(ud.getClass());</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Repository接口</strong></p>
<p>Repository接口是Spring Data JPA中为我们提供的所有接口的顶层接口.</p>
<p>Repository提供了两种查询方式的支持<br>    1. 基于方法名称命名规则查询<br>    2. 基于@Query查询</p>
<p><strong>方法名称命名规则查询</strong></p>
<p>规则： findBy(关键字)+属性名称（属性名称的首字母大写）+查询条件(首字母大写)</p>
<p><img src="https://i.loli.net/2019/12/30/PMv5oOeBGY7zhy8.png" alt="1577708111_1_.png"></p>
<p>创建接口UsersDao.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.data.repository.Repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.pojo.Users;</span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * Repository接口讲解</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 1huangzewei</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//第一个参数要操作的实体类型，第二个参数为主键的数据类型</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UsersDao</span> <span class="keyword">extends</span> <span class="title">Repository</span>&lt;<span class="title">Users</span>,<span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function">List&lt;Users&gt; <span class="title">findByUsernamesIs</span><span class="params">(String string)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">List&lt;Users&gt; <span class="title">findByUsernamesLike</span><span class="params">(String string)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function">List&lt;Users&gt; <span class="title">findByUsernamesAndUserageGreaterThanEqual</span><span class="params">(String name,Integer age)</span></span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建测试类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.dao.UsersDao;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.pojo.Users;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * Repository接口测试</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 1huangzewei</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</span><br><span class="line"><span class="meta">@ContextConfiguration</span>(<span class="string">"classpath:applicationContext.xml"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RepositoryTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UsersDao usersDao;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 需求，使用用户名作为查询条件</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">/***</span></span><br><span class="line"><span class="comment">		 * 判断相等的条件，有三种表示方式</span></span><br><span class="line"><span class="comment">		 * 1、什么都不写，默认就是做相等判断</span></span><br><span class="line"><span class="comment">		 * 2. Is</span></span><br><span class="line"><span class="comment">		 * 3. Equal</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		List&lt;Users&gt; list = <span class="keyword">this</span>.usersDao.findByUsernamesIs(<span class="string">"李四"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> (Users users : list) &#123;</span><br><span class="line">			System.out.println(users);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 需求：根据用户姓名做like查询</span></span><br><span class="line"><span class="comment">	 * Like：条件关键字</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		List&lt;Users&gt; list = <span class="keyword">this</span>.usersDao.findByUsernamesLike(<span class="string">"王"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> (Users users : list) &#123;</span><br><span class="line">			System.out.println(users);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 需求：查询名称为王五并且他的年龄大于等于22</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span></span>&#123;</span><br><span class="line">		List&lt;Users&gt; list = <span class="keyword">this</span>.usersDao.findByUsernamesAndUserageGreaterThanEqual(<span class="string">"王五"</span>,<span class="number">22</span>);</span><br><span class="line">		<span class="keyword">for</span> (Users users : list) &#123;</span><br><span class="line">			System.out.println(list);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>基于@Query注解的查询</strong></p>
<p>通过JPQL查询</p>
<ul>
<li>JPQL:通过Hibernate的HQL演变过来。它和HQL语法极其相似 </li>
</ul>
<p>通过SQL语句查询</p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/CPWS.github.io/2020/02/06/hello-world/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          Hello World
        
      </div>
    </a>
  
  
    <a href="/CPWS.github.io/2019/12/12/四级选词填空/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">四级选词填空</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>


<div class="ds-share share" data-thread-key="springdata" data-title="springdata" data-url="https://CPWS.github.io/CPWS.github.io/2019/12/28/springdata/"  data-images="http://img.mp.itc.cn/q_mini,c_zoom,w_640/upload/20161221/c495640d0fc24a91b9c95dc0d54b6002_th.jpeg" data-content="springdata">
    <div class="ds-share-inline">
      <ul  class="ds-share-icons-16">
      	<li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
        <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
        <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
      </ul>
      <div class="ds-share-icons-more">
      </div>
    </div>
 </div>
 





</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2020 zhuli
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/CPWS.github.io/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/CPWS.github.io/js/main.js"></script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>