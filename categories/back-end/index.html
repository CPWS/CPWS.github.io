<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">

    

    

    <title>Category: back-end | Prossible&#39;s Blog</title>
    <meta name="author" content="zhuli">
    <meta name="keywords" content>
    <meta name="description" content>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">

    
    <link rel="alternate" href="/CPWS.github.io/atom.xml" title="Prossible&#39;s Blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/CPWS.github.io/images/favicon.ico">
    

    <style type="text/css">
    @font-face {
        font-family: 'icomoon';
        src: url("/CPWS.github.io/fonts/icomoon.eot?q628ml");
        src: url("/CPWS.github.io/fonts/icomoon.eot?q628ml#iefix") format('embedded-opentype'),
             url("/CPWS.github.io/fonts/icomoon.ttf?q628ml") format('truetype'),
             url("/CPWS.github.io/fonts/icomoon.woff?q628ml") format('woff'),
             url("/CPWS.github.io/fonts/icomoon.svg?q628ml#icomoon") format('svg');
        font-weight: normal;
        font-style: normal;
    }
    </style>
    <link rel="stylesheet" href="/CPWS.github.io/css/style.css">

    <!--[if lt IE 9]>
    <style type="text/css">
    .nav-inner {top:0;}
    .author-meta {position:static;top:0;}
    .search-form {height:36px;}
    </style>
    <script type="text/javascript" src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
    <![endif]-->
</head>
<body>

    <main class="app">
        <header id="header" class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">Prossible&#39;s Blog</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item" href="/CPWS.github.io/">
                <span class="nav-text">首页</span>
            </a>
        
            <a class="nav-item" href="/CPWS.github.io/categories/front-end">
                <span class="nav-text">前端</span>
            </a>
        
            <a class="nav-item active" href="/CPWS.github.io/categories/back-end">
                <span class="nav-text">后端</span>
            </a>
        
            <a class="nav-item" href="/CPWS.github.io/tags">
                <span class="nav-text">标签</span>
            </a>
        
            <a class="nav-item" href="/CPWS.github.io/archives">
                <span class="nav-text">归档</span>
            </a>
        
            <a class="nav-item" href="/CPWS.github.io/atom.xml">
                <span class="nav-text">订阅</span>
            </a>
        
            <a class="nav-item" href="/CPWS.github.io/about">
                <span class="nav-text">关于</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="https://CPWS.github.io"></form>

        
        

        
        <div class="author-meta">
            
            <div class="author-avatar">
                <a href="/CPWS.github.io/">
                    <img src="http://img.mp.itc.cn/q_mini,c_zoom,w_640/upload/20161221/c495640d0fc24a91b9c95dc0d54b6002_th.jpeg" title="ZHUCHULI">
                </a>
            </div>
            
            <div class="author-name">ZHUCHULI</div>
            <div class="author-work">Web Developer &amp; Designer</div>
            <div class="author-location">
                <i class="icon-location vm"></i>
                <span class="vm">GuangZhou, China</span>
            </div>
            
            <div class="author-thread-wrap">
                <div class="author-threads clearfix">
                    
                        <a class="thread-item" href="https://github.com/CPWS" target="_blank" rel="noopener">
                            <!-- Generated by IcoMoon.io -->
<svg viewbox="0 0 1024 1024" width="38" height="38" fill="currentColor">
<path d="M512 32.12c-265.004 0-479.88 220.23-479.88 492.090 0 217.446 137.536 401.684 328.202 466.81 23.994 4.498 32.778-10.712 32.778-23.78 0-11.782-0.428-42.632-0.642-83.764-133.466 29.778-161.744-65.984-161.744-65.984-21.852-56.772-53.344-71.982-53.344-71.982-43.49-30.636 3.214-29.992 3.214-29.992 48.202 3.428 73.482 50.772 73.482 50.772 42.846 75.196 112.258 53.558 139.68 40.918 4.284-31.706 16.71-53.558 30.42-65.77-106.474-12.426-218.516-54.63-218.516-243.152 0-53.772 18.638-97.69 49.274-131.966-4.928-12.426-21.424-62.556 4.714-130.252 0 0 40.276-13.282 131.966 50.344 38.348-10.926 79.266-16.282 120.184-16.496 40.704 0.214 81.836 5.57 120.184 16.496 91.692-63.626 131.752-50.344 131.752-50.344 26.136 67.698 9.64 117.828 4.714 130.252 30.636 34.492 49.274 78.408 49.274 131.966 0 188.952-112.258 230.514-219.16 242.724 17.138 15.21 32.564 45.202 32.564 91.048 0 65.77-0.642 118.898-0.642 134.966 0 13.068 8.57 28.492 32.992 23.566 191.094-64.912 328.418-249.152 328.418-466.382 0-271.86-214.874-492.090-479.88-492.090z"/>
</svg>

                        </a>
                    
                        <a class="thread-item" href="http://weibo.com/sanonz" target="_blank" rel="noopener">
                            <!-- Generated by IcoMoon.io -->
<svg viewbox="0 0 1024 1024" width="38" height="38" fill="currentColor">
<path d="M21.332 512c0-270.988 219.68-490.666 490.668-490.666s490.666 219.68 490.666 490.666c0 270.988-219.678 490.666-490.666 490.666s-490.666-219.678-490.666-490.666zM960 512c0-247.424-200.576-448-448-448s-448 200.576-448 448c0 247.424 200.576 448 448 448s448-200.576 448-448zM768 597.332c47.128 0 85.332-38.206 85.332-85.332s-38.206-85.332-85.332-85.332c-47.128 0-85.332 38.204-85.332 85.332s38.206 85.332 85.332 85.332zM512 597.332c47.128 0 85.332-38.206 85.332-85.332s-38.206-85.332-85.332-85.332c-47.128 0-85.332 38.204-85.332 85.332s38.204 85.332 85.332 85.332zM255.998 597.332c47.128 0 85.332-38.206 85.332-85.332s-38.204-85.332-85.332-85.332c-47.128 0-85.332 38.204-85.332 85.332s38.204 85.332 85.332 85.332z"/>
</svg>

                        </a>
                    
                        <a class="thread-item" href="https://twitter.com/sanonze" target="_blank" rel="noopener">
                            <!-- Generated by IcoMoon.io -->
<svg viewbox="0 0 1024 1024" width="38" height="38" fill="currentColor">
<path d="M512.029 31.011c-263.32 0-476.784 213.502-476.784 476.784 0 263.32 213.464 476.743 476.784 476.743s476.743-213.424 476.743-476.743c0-263.282-213.444-476.784-476.743-476.784zM752.193 411.663c0.251 5.151 0.349 10.319 0.349 15.548 0 158.786-120.856 341.85-341.85 341.85-67.844 0-131.021-19.884-184.188-53.961 9.41 1.104 18.955 1.665 28.656 1.665 56.305 0 108.115-19.208 149.221-51.425-52.567-0.987-96.925-35.741-112.22-83.468 7.32 1.433 14.85 2.149 22.595 2.149 10.959 0 21.569-1.433 31.656-4.201-54.987-11.035-96.402-59.634-96.402-117.796 0-0.524 0-1.025 0.020-1.549 16.186 9.003 34.716 14.404 54.427 15.044-32.258-21.587-53.458-58.317-53.458-100.023 0-22.015 5.925-42.673 16.264-60.408 59.266 72.683 147.807 120.527 247.676 125.521-2.053-8.77-3.118-17.968-3.118-27.378 0-66.333 53.787-120.14 120.158-120.14 34.561 0 65.771 14.599 87.69 37.93 27.378-5.363 53.091-15.393 76.305-29.16-9.003 28.074-28.036 51.618-52.858 66.47 24.338-2.903 47.495-9.37 69.024-18.917-16.070 24.144-36.459 45.306-59.945 62.248z"/>
</svg>

                        </a>
                    
                </div>
            </div>
            
        </div>
        
    </div>
</aside>

</header>

        <div id="content" class="content">
            <div id="wrapper" class="wrapper" style="max-width: 800px">
                
    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/30/Lucene/">Lucene</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-30T04:52:24.000Z" itemprop="datePublished">2019-11-30</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/Lucene/">Lucene</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h1 id="Lucene-amp-Solr第一天"><a href="#Lucene-amp-Solr第一天" class="headerlink" title="Lucene&amp;Solr第一天"></a><code>Lucene</code>&amp;<code>Solr</code>第一天</h1><hr>
<h2 id="什么是全文检索"><a href="#什么是全文检索" class="headerlink" title="什么是全文检索"></a>什么是全文检索</h2><ul>
<li>数据分类<blockquote>
<ul>
<li>结果化数据：有固定的格式和有限长度，比如<code>Oracle</code>或<code>mysql</code>表中的数据。<blockquote>
<ul>
<li>使用SQL语句查询结构化数据，速度快。</li>
<li>如果数据量大时，可以在数据库中创建索引，但是此时创建的索引是不支持模糊查询，需要创建另外一套索引库。</li>
</ul>
</blockquote>
</li>
<li>非结构化数据：没有固定格式也没有有限长度。比如：磁盘上的文件，excel、word、pdf、txt、ppt等<blockquote>
<ul>
<li>查询非结构化数据：1、目测（顺序扫描法）、IO读取、3、全文检索</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>对数据源创建索引，在索引上搜索这个过程就是全文检索。（创建索引+查询）</li>
</ul>
<hr>
<h2 id="全文检索的应用场景"><a href="#全文检索的应用场景" class="headerlink" title="全文检索的应用场景"></a>全文检索的应用场景</h2><ul>
<li>搜索引擎：百度、搜狗、360 搜搜</li>
<li>站内搜索：淘宝、京东、微博、论坛</li>
</ul>
<hr>
<h2 id="怎么实现全文检索"><a href="#怎么实现全文检索" class="headerlink" title="怎么实现全文检索"></a>怎么实现全文检索</h2><ul>
<li>使用<code>lucene</code>实现</li>
</ul>
<hr>
<h2 id="Lucene简介"><a href="#Lucene简介" class="headerlink" title="Lucene简介"></a>Lucene简介</h2><ul>
<li>是<code>Apache</code>下的开源用来实现全文检索的工具包，API</li>
</ul>
<hr>
<h2 id="Lucene实现全文检索的流程"><a href="#Lucene实现全文检索的流程" class="headerlink" title="Lucene实现全文检索的流程"></a>Lucene实现全文检索的流程</h2><ol>
<li>创建索引<blockquote>
<ul>
<li>获取源文档<blockquote>
<ul>
<li>什么是源文档？场景1：搜索引擎：指的是互联网上的所有网页。场景2：站内搜索：磁盘上的文件或表中的数据。</li>
<li>获取源文档方式？场景1：搜索引擎：网络爬虫。场景2：站内搜索：IO流、sql查询</li>
</ul>
</blockquote>
</li>
<li>构建文档对象（Document）<blockquote>
<ul>
<li>一个<code>Document</code>对象中放的是：一个网页内容、或一个文件、或表中一条数据。</li>
</ul>
</blockquote>
</li>
<li>对内容分词（分析文档）<blockquote>
<ul>
<li>举例：一个文件包含信息：文件路径、文件名称、文件大小、文件内容。（document）</li>
<li>举例：一个网页包含信息：网络地址URL，网页内容、网页标题。(document)</li>
<li>举例：一条数据包含的信息：一条数据每个列的内容。（document）（有多少个列就有多少个域）</li>
<li>效果：<code>The Spring Framework provides a comprehensive programming and configuration model.</code>；</li>
<li>按空格大小分</li>
<li>处理大小写</li>
<li>停用词</li>
<li>标点符号</li>
<li>结果： spring、framework、provides、comprehensive、programming、configuration、model（每一个对应一个term）</li>
</ul>
</blockquote>
</li>
<li>创建索引（存储）<blockquote>
<ul>
<li>分词后的格式： name:spring name是自定义的域名城，spring是此域中的值；name:spring就是一个词汇item；一个文档中可以有多个域。不同的文档可以有不同的域。</li>
<li>创建索引是对语汇单元索引，通常词语找文档，这种索引结构叫做倒排索引结构。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>查询索引<blockquote>
<ul>
<li>用户查询接口：就是用户输入关键字的位置</li>
<li>创建查询</li>
<li>执行查询</li>
<li>渲染结果</li>
</ul>
</blockquote>
</li>
</ol>
<hr>
<h2 id="Lucene入门案例"><a href="#Lucene入门案例" class="headerlink" title="Lucene入门案例"></a>Lucene入门案例</h2><ul>
<li><p>所需要的<code>jar</code>包：</p>
<ul>
<li>核心的<code>jar</code>：<code>lucene-core-4.10.3.jar</code>、<code>lucene-analyzers-common-4.10.3.jar</code></li>
<li>IO所需要的包：commons-io.jar </li>
</ul>
</li>
<li><p>创建索引</p>
<ul>
<li>场景：给磁盘上的文件创建索引</li>
<li>步骤<ul>
<li>指定索引库位置 <code>Directory</code></li>
<li>创建写入索引位置<code>IndexWriter</code></li>
<li>获取源文档 <code>IO流</code></li>
<li>写入文档<code>indexWriter.addDocument(doc)；</code></li>
<li>关闭资源 <code>indexWriter.close();</code></li>
</ul>
</li>
<li>使用luke工具查看索引文件</li>
<li>luke安装地址：<code>https://github.com/DmitryKey/luke/releases</code><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.lucene;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.FileUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.Analyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.standard.StandardAnalyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.Document;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.Field;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.Field.Store;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.TextField;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.IndexWriter;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.IndexWriterConfig;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.store.FSDirectory;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.util.Version;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexWriterTest</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">	</span><br><span class="line">		<span class="comment">//1.指定索引库位置</span></span><br><span class="line">		FSDirectory directory = FSDirectory.open(<span class="keyword">new</span> File(<span class="string">"D:\\桌面\\Java\\lucene\\indexRepo"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//指定分词器</span></span><br><span class="line">		Analyzer analyzer=<span class="keyword">new</span> StandardAnalyzer();</span><br><span class="line">		</span><br><span class="line">		IndexWriterConfig config=<span class="keyword">new</span> IndexWriterConfig(Version.LATEST,analyzer);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//2.创建写入索引对象</span></span><br><span class="line">		IndexWriter indexWriter=<span class="keyword">new</span> IndexWriter(directory, config);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		3.获取源文档 </span></span><br><span class="line">		File srcFile = <span class="keyword">new</span> File(<span class="string">"D:\\txt"</span>);</span><br><span class="line">		File[] listFiles = srcFile.listFiles();</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		4. 把文档写入索引库</span></span><br><span class="line">		<span class="keyword">for</span> (File file : listFiles) &#123;</span><br><span class="line">			Document doc=<span class="keyword">new</span> Document();</span><br><span class="line">			<span class="comment">//文件路径、</span></span><br><span class="line">			String filePath = file.getPath();</span><br><span class="line">			Field pathField=<span class="keyword">new</span> TextField(<span class="string">"path"</span>, filePath, Store.YES) ;</span><br><span class="line">			doc.add(pathField);</span><br><span class="line">			<span class="comment">//文件名称、</span></span><br><span class="line">			String fileName = file.getName();</span><br><span class="line">			Field nameField=<span class="keyword">new</span> TextField(<span class="string">"name"</span>, fileName, Store.YES) ;</span><br><span class="line">			doc.add(nameField);</span><br><span class="line">			<span class="comment">//文件大小、</span></span><br><span class="line">			<span class="keyword">long</span> fileSize=FileUtils.sizeOf(file);</span><br><span class="line">			Field sizeField=<span class="keyword">new</span> TextField(<span class="string">"size"</span>, fileSize+<span class="string">""</span>, Store.YES) ;</span><br><span class="line">			doc.add(sizeField);</span><br><span class="line">			<span class="comment">//文件内容</span></span><br><span class="line">			String fileContent = FileUtils.readFileToString(file);</span><br><span class="line">			Field contentField=<span class="keyword">new</span> TextField(<span class="string">"content"</span>, fileContent+<span class="string">""</span>, Store.YES) ;</span><br><span class="line">			doc.add(contentField);</span><br><span class="line">			</span><br><span class="line">			indexWriter.addDocument(doc);</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//		5.关闭资源</span></span><br><span class="line">		indexWriter.close();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>查询索引</p>
<ul>
<li>指定索引库位置</li>
<li>创建读取索引对象</li>
<li>创建查询索引对象</li>
<li>执行索引</li>
<li>获取索引结果<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.lucene;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.Document;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.DirectoryReader;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.IndexReader;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.Term;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.search.IndexSearcher;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.search.Query;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.search.ScoreDoc;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.search.TermQuery;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.search.TopDocs;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.store.Directory;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.store.FSDirectory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexReaderTest</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//1. 指定索引库的位置</span></span><br><span class="line">		Directory directory = FSDirectory.open(<span class="keyword">new</span> File(<span class="string">"D:\\桌面\\Java\\lucene\\indexRepo"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//2.创建读取索引对象</span></span><br><span class="line">		IndexReader indexReader=DirectoryReader.open(directory);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//3. 创建查询索引对象</span></span><br><span class="line">		IndexSearcher indexSearcher = <span class="keyword">new</span> IndexSearcher(indexReader);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//4.执行查询方法 query:指定条件，result：查询数据量的限制</span></span><br><span class="line">		Term t=<span class="keyword">new</span> Term(<span class="string">"name"</span>,<span class="string">"spring"</span>);</span><br><span class="line">		Query query=<span class="keyword">new</span> TermQuery(t);</span><br><span class="line">		<span class="comment">//5.获取获取查询结果</span></span><br><span class="line">		TopDocs topDocs = indexSearcher.search(query, <span class="number">100</span>);</span><br><span class="line">		System.out.println(<span class="string">"总记录数："</span>+topDocs.totalHits);</span><br><span class="line">		ScoreDoc[] scoreDocs = topDocs.scoreDocs;</span><br><span class="line">		<span class="keyword">for</span> (ScoreDoc scoreDoc : scoreDocs) &#123;</span><br><span class="line">			<span class="keyword">int</span> docId = scoreDoc.doc;</span><br><span class="line">			Document doc = indexSearcher.doc(docId);</span><br><span class="line">			<span class="comment">//获取文档的内容</span></span><br><span class="line">			System.out.println(<span class="string">"文件名："</span>+doc.get(<span class="string">"name"</span>));</span><br><span class="line">			System.out.println(<span class="string">"文件大小："</span>+doc.get(<span class="string">"size"</span>));</span><br><span class="line">			System.out.println(<span class="string">"文件路径："</span>+doc.get(<span class="string">"path"</span>));</span><br><span class="line">			System.out.println(<span class="string">"文件内容："</span>+doc.get(<span class="string">"content"</span>));</span><br><span class="line">			System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//6.关闭资源</span></span><br><span class="line">		indexReader.close();</span><br><span class="line">				</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<hr>
<h2 id="分词器"><a href="#分词器" class="headerlink" title="分词器"></a>分词器</h2><ul>
<li><code>Analyzer</code>每个分词器的<code>tokenStream</code>方法<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.lucene;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.Analyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.TokenStream;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.cjk.CJKAnalyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.cn.smart.SmartChineseAnalyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.standard.StandardAnalyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.tokenattributes.CharTermAttribute;</span><br><span class="line"><span class="keyword">import</span> org.wltea.analyzer.lucene.IKAnalyzer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * StandardAnalyzer：按照空格分词（英文），中文是一个字一个字分隔（Analyzer analyzer=new StandardAnalyzer();）</span></span><br><span class="line"><span class="comment"> * CJKAnalyzer：Analyzer analyzer = new CJKAnalyzer();//中文两个字两个字</span></span><br><span class="line"><span class="comment"> * SmartChineseAnalyzer：中文还算可以，但是英文容易出现缺字母</span></span><br><span class="line"><span class="comment"> * IK-Analyzer：第三方分词器 IK-Analyzer 需要导入jar，需要加入两个配置文件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnalyzerTest</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">	</span><br><span class="line">		<span class="comment">//Analyzer analyzer=new StandardAnalyzer();</span></span><br><span class="line">		<span class="comment">//Analyzer analyzer = new CJKAnalyzer();//中文两个字两个字</span></span><br><span class="line">		<span class="comment">//Analyzer analyzer = new SmartChineseAnalyzer();</span></span><br><span class="line">		<span class="comment">//第三方分词器 IK-Analyzer 需要导入jar</span></span><br><span class="line">		Analyzer analyzer=<span class="keyword">new</span> IKAnalyzer();</span><br><span class="line">		TokenStream tokenStream = analyzer.tokenStream(<span class="keyword">null</span>, <span class="string">"apache场景1：搜索引擎：指的是互联网上的所有网页。场景2：站内搜索：磁盘上的文件或表中的数据。"</span>);</span><br><span class="line">		</span><br><span class="line">		CharTermAttribute charTermAttribute = tokenStream.addAttribute(CharTermAttribute.class);</span><br><span class="line">		</span><br><span class="line">		tokenStream.reset();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(tokenStream.incrementToken()) &#123;</span><br><span class="line">			System.out.println(charTermAttribute);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="分词器的使用时机"><a href="#分词器的使用时机" class="headerlink" title="分词器的使用时机"></a>分词器的使用时机</h2><ul>
<li>需要查询就需要分词器</li>
<li>查询时也需要分词</li>
</ul>
<hr>
<h1 id="Lucene-amp-Solr第二天"><a href="#Lucene-amp-Solr第二天" class="headerlink" title="Lucene&amp;Solr第二天"></a><code>Lucene</code>&amp;<code>Solr</code>第二天</h1><h2 id="索引库的维护"><a href="#索引库的维护" class="headerlink" title="索引库的维护"></a>索引库的维护</h2><h2 id="Lucene的查询"><a href="#Lucene的查询" class="headerlink" title="Lucene的查询"></a>Lucene的查询</h2><h2 id="相关度排序"><a href="#相关度排序" class="headerlink" title="相关度排序"></a>相关度排序</h2><h2 id="什么是solr"><a href="#什么是solr" class="headerlink" title="什么是solr"></a>什么是<code>solr</code></h2><h2 id="solr的安装和配置"><a href="#solr的安装和配置" class="headerlink" title="solr的安装和配置"></a><code>solr</code>的安装和配置</h2><h2 id="Solr后台的使用"><a href="#Solr后台的使用" class="headerlink" title="Solr后台的使用"></a><code>Solr</code>后台的使用</h2><h2 id="使用solrj维护索引库"><a href="#使用solrj维护索引库" class="headerlink" title="使用solrj维护索引库"></a>使用<code>solrj</code>维护索引库</h2>
        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/29/Elasticsearch/">Elasticsearch</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-29T11:18:12.000Z" itemprop="datePublished">2019-11-29</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/Elasticsearch/">Elasticsearch</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        
        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/29/solr/">solr</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-29T11:17:57.000Z" itemprop="datePublished">2019-11-29</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/solr/">solr</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="https-www-cs-usfca-edu-galles-visualization-AVLtree-html"><a href="#https-www-cs-usfca-edu-galles-visualization-AVLtree-html" class="headerlink" title="https://www.cs.usfca.edu/galles/visualization/AVLtree.html"></a><code>https://www.cs.usfca.edu/galles/visualization/AVLtree.html</code></h2><hr>
<h2 id="全文检索和Solr介绍、Solr环境安装"><a href="#全文检索和Solr介绍、Solr环境安装" class="headerlink" title="全文检索和Solr介绍、Solr环境安装"></a>全文检索和Solr介绍、Solr环境安装</h2><ul>
<li>安装步骤：<blockquote>
<ul>
<li>下载安装包：<code>https://lucene.apache.org/solr/downloads.html</code></li>
<li>上传到Linux上</li>
<li>解压文件 <code>tar -zxvf solr -C /usr/local</code> </li>
<li>进入目录.<code>/usr/local/solr-7.7.2/server/solr-webapp/webapp</code></li>
<li>把<code>webapp</code>下的案例文件拷贝到tomcat的webapps下.</li>
<li>修改该文件下的web.xml，添加如下内容：</li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/30/FLGtWZIz9odcS4v.png" alt="20.png"></p>
<blockquote>
<ul>
<li>拷贝相关jar包到tomcat目录下：</li>
</ul>
</blockquote>
<h2 id="java操作Solr服务器"><a href="#java操作Solr服务器" class="headerlink" title="java操作Solr服务器"></a>java操作Solr服务器</h2><h2 id="管理员运维命令以及集群搭建"><a href="#管理员运维命令以及集群搭建" class="headerlink" title="管理员运维命令以及集群搭建"></a>管理员运维命令以及集群搭建</h2><h2 id="案例实战"><a href="#案例实战" class="headerlink" title="案例实战"></a>案例实战</h2>
        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/29/搜索引擎框架介绍/">搜索引擎框架介绍</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-29T09:04:19.000Z" itemprop="datePublished">2019-11-29</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/搜索引擎框架介绍/">搜索引擎框架介绍</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="9个基于Java的搜索引擎框架"><a href="#9个基于Java的搜索引擎框架" class="headerlink" title="9个基于Java的搜索引擎框架"></a>9个基于Java的搜索引擎框架</h2><ul>
<li>转自：<code>https://blog.csdn.net/y19910825/article/details/78982429</code></li>
</ul>
<hr>
<h3 id="Java全文搜索引擎框架-Lucene"><a href="#Java全文搜索引擎框架-Lucene" class="headerlink" title="Java全文搜索引擎框架 Lucene"></a>Java全文搜索引擎框架 <code>Lucene</code></h3><ul>
<li>毫无疑问，Lucene是目前最受欢迎的Java全文搜索框架，准确地说，它是一个全文检索引擎的架构，提供了完整的查询引擎和索引引擎，部分文本分析引擎。Lucene为开发人员提供了相当完整的工具包，可以非常方便地实现强大的全文检索功能。下面有几款搜索引擎框架也是基于Lucene实现的。</li>
<li><code>官方网站：http://lucene.apache.org/</code><h3 id="开源Java搜索引擎Nutch"><a href="#开源Java搜索引擎Nutch" class="headerlink" title="开源Java搜索引擎Nutch"></a>开源Java搜索引擎<code>Nutch</code></h3></li>
<li>Nutch 是一个开源Java实现的搜索引擎。它提供了我们运行自己的搜索引擎所需的全部工具。包括全文搜索和Web爬虫。</li>
<li>利用Nutch，你可以做到以下这些功能：<ul>
<li>每为这些网页维护一个索引</li>
<li>个月取几十亿网页</li>
<li>对索引文件进行每秒上千次的搜索</li>
<li>提供高质量的搜索结果</li>
<li>最小的成本运作</li>
</ul>
</li>
<li><code>官方网站：http://nutch.apache.org/</code><h3 id="分布式搜索引擎Elasticsearch"><a href="#分布式搜索引擎Elasticsearch" class="headerlink" title="分布式搜索引擎Elasticsearch"></a>分布式搜索引擎<code>Elasticsearch</code></h3></li>
<li>ElasticSearch就是一款基于Lucene框架的分布式搜索引擎，并且也是一款为数不多的基于JSON进行索引的搜索引擎。ElasticSearch特别适合在云计算平台上使用。</li>
<li>官方网站：<a href="http://www.elasticsearch.org/" target="_blank" rel="noopener">http://www.elasticsearch.org/</a><h3 id="实时分布式搜索引擎Solandra"><a href="#实时分布式搜索引擎Solandra" class="headerlink" title="实时分布式搜索引擎Solandra"></a>实时分布式搜索引擎<code>Solandra</code></h3></li>
<li>Solandra 是一个实时的分布式搜索引擎，基于 Apache Solr 和 Apache Cassandra 构建。</li>
<li>其特性如下：<ul>
<li>支持Solr的大多数默认特性 (search, faceting, highlights)</li>
<li>数据复制，分片，缓存及压缩这些都由Cassandra来进行 </li>
<li>Multi-master (任意结点都可供读写)</li>
<li>实时性高，写操作完成即可读到</li>
<li>Easily add new SolrCores w/o restart across the cluster 轻松添加及重启结点</li>
</ul>
</li>
<li><code>官方网站：https://github.com/tjake/Solandra</code><h3 id="IndexTank"><a href="#IndexTank" class="headerlink" title="IndexTank"></a>IndexTank</h3></li>
<li>IndexTank是一套基于Java的索引-实时全文搜索引擎实现，IndexTank有以下几个特点：<ul>
<li>索引更新实时生效</li>
<li>地理位置搜索</li>
<li>支持多种客户端语言,<code>Ruby, Rails, Python, Java, PHP, .NET &amp; more!</code></li>
<li>支持灵活的排序与评分控制</li>
<li>支持自动完成</li>
<li>支持面搜索（facet search）</li>
<li>支持匹配高亮</li>
<li>支持海量数据扩展（Scalable from a personal blog to hundreds of millions of documents! ）</li>
<li>支持动态数据</li>
</ul>
</li>
<li><code>官方网站：https://github.com/linkedin/indextank-engine</code><h3 id="搜索引擎Compass"><a href="#搜索引擎Compass" class="headerlink" title="搜索引擎Compass"></a>搜索引擎Compass</h3></li>
<li>Compass是一个强大的,事务的,高性能的对象/搜索引擎映射(OSEM:object/search engine mapping)与一个Java持久层框架.Compass包括:<ul>
<li>搜索引擎抽象层(使用Lucene搜索引荐)</li>
<li>OSEM (Object/Search Engine Mapping) 支持</li>
<li>事务管理</li>
<li>类似于Google的简单关键字查询语言</li>
<li>可扩展与模块化的框架</li>
<li>简单的API</li>
</ul>
</li>
<li><code>官方网站：http://www.compass-project.org/</code><h3 id="Java全文搜索服务器solr"><a href="#Java全文搜索服务器solr" class="headerlink" title="Java全文搜索服务器solr"></a>Java全文搜索服务器<code>solr</code></h3></li>
<li>Solr也是基于Java实现的，并且是基于Lucene实现的，Solr的主要特性包括：高效、灵活的缓存功能，垂直搜索功能，高亮显示搜索结果。值得注意的是，Solr还提供一款很棒的Web界面来管理索引的数据。</li>
<li><code>官方网站：http://lucene.apache.org/solr/</code><h3 id="Lucene图片搜索-LIRE"><a href="#Lucene图片搜索-LIRE" class="headerlink" title="Lucene图片搜索 LIRE"></a>Lucene图片搜索 LIRE</h3></li>
<li>LIRE是一款基于Java的图片搜索框架，其核心也是基于Lucene的，利用该索引就能够构建一个基于内容的图像检索(content- based image retrieval，CBIR)系统，来搜索相似的图像。图片搜索LIRE</li>
<li><code>官方网站：http://www.semanticmetadata.net/lire/</code><h3 id="全文本搜索引擎Egothor"><a href="#全文本搜索引擎Egothor" class="headerlink" title="全文本搜索引擎Egothor"></a>全文本搜索引擎Egothor</h3></li>
<li>Egothor是一个用Java编写的开源而高效的全文本搜索引擎。借助Java的跨平台特性，Egothor能应用于任何环境的应用，既可配置为单独的搜索引擎，又能用于你的应用作为全文检索之用。</li>
<li><code>官方网站：http://www.egothor.org/cms/</code></li>
</ul>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/27/nginx/">nginx</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-27T02:46:39.000Z" itemprop="datePublished">2019-11-27</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/nginx/">nginx</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="什么是nginx"><a href="#什么是nginx" class="headerlink" title="什么是nginx"></a>什么是<code>nginx</code></h2><ul>
<li>是一个使用c语言开发的高性能的http服务器及反向代理服务器。</li>
<li>Nginx是一款高性能的http 服务器/反向代理服务器及电子邮件（IMAP/POP3）代理服务器。由俄罗斯的程序设计师Igor Sysoev所开发，官方测试nginx能够支支撑5万并发链接，并且cpu、内存等资源消耗却非常低，运行非常稳定。</li>
</ul>
<hr>
<h2 id="Nginx的应用场景"><a href="#Nginx的应用场景" class="headerlink" title="Nginx的应用场景"></a><code>Nginx</code>的应用场景</h2><ul>
<li>http服务器。Nginx是一个http服务可以独立提供http服务。可以做网页静态服务器。</li>
<li>虚拟主机。可以实现在一台服务器虚拟出多个网站。例如个人网站使用的虚拟主机。</li>
<li>反向代理，负载均衡。当网站的访问量达到一定程度后，单台服务器不能满足用户的请求时，需要用多台服务器集群可以使用nginx做反向代理。并且多台服务器可以平均分担负载，不会因为某台服务器负载高宕机而某台服务器闲置的情况。</li>
</ul>
<hr>
<h2 id="Nginx的安装"><a href="#Nginx的安装" class="headerlink" title="Nginx的安装"></a><code>Nginx</code>的安装</h2><ul>
<li><code>Nginx</code>一般推荐安装到linux系统，而且要安装c语言的编译环境gcc。</li>
<li>下载地址:<blockquote>
<ul>
<li>进入<code>http://nginx.org/en/download.html</code>下载<code>nginx1.8.0</code>版本（当前最新稳定版本）。</li>
</ul>
</blockquote>
</li>
<li>安装步骤：<blockquote>
<ul>
<li>先安装nginx依赖的包：<blockquote>
<ul>
<li>nginx是C语言开发，建议在linux上运行，本教程使用Centos6.5作为安装环境。</li>
<li>第一步：<code>gcc</code>：安装nginx需要先将官网下载的源码进行编译，编译依赖gcc环境，如果没有gcc环境，需要安装gcc：<code>yum install gcc-c++</code>；</li>
<li>第二步：<code>PCRE</code>：PCRE(Perl Compatible Regular Expressions)是一个Perl库，包括 perl 兼容的正则表达式库。nginx的http模块使用pcre来解析正则表达式，所以需要在linux上安装pcre库。<code>yum install -y pcre pcre-devel</code>；注：pcre-devel是使用pcre开发的一个二次开发库。nginx也需要此库；</li>
<li>第三步：<code>Zlib</code>：zlib库提供了很多种压缩和解压缩的方式，nginx使用zlib对http包的内容进行gzip，所以需要在linux上安装zlib库。<code>yum install -y zlib zlib-devel</code>；</li>
<li>第四步：<code>openssl</code>;OpenSSL 是一个强大的安全套接字层密码库，囊括主要的密码算法、常用的密钥和证书封装管理功能及SSL协议，并提供丰富的应用程序供测试或其它目的使用;nginx不仅支持http协议，还支持https（即在ssl协议上传输http），所以需要在linux安装openssl库;<code>yum install -y openssl openssl-devel</code>;</li>
</ul>
</blockquote>
</li>
<li>安装完依赖包之后，nginx的安装步骤：<blockquote>
<ul>
<li>第一步：把nginx的源码上传到linux系统。可以通过<code>finalshell</code>工具，该工具的下载链接在最下方。</li>
<li>第二步：把压缩包解压缩。</li>
<li>第三步：进行configure。<br>./configure \</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>-prefix=/usr/local/nginx \</li>
<li>-pid-path=/var/run/nginx/nginx.pid \</li>
<li>-lock-path=/var/lock/nginx.lock \</li>
<li>-error-log-path=/var/log/nginx/error.log \</li>
<li>-http-log-path=/var/log/nginx/access.log \</li>
<li>-with-http_gzip_static_module \</li>
<li>-http-client-body-temp-path=/var/temp/nginx/client \</li>
<li>-http-proxy-temp-path=/var/temp/nginx/proxy \</li>
<li>-http-fastcgi-temp-path=/var/temp/nginx/fastcgi \</li>
<li>-http-uwsgi-temp-path=/var/temp/nginx/uwsgi \</li>
<li>-http-scgi-temp-path=/var/temp/nginx/scgi</li>
</ul>
<p>注意：上边将临时文件目录指定为/var/temp/nginx，需要在/var下创建temp及nginx目录</p>
<blockquote>
<blockquote>
<ul>
<li>第四步：make</li>
<li>第五步：make install</li>
</ul>
</blockquote>
</blockquote>
<hr>
<h2 id="Nginx的启动、停止"><a href="#Nginx的启动、停止" class="headerlink" title="Nginx的启动、停止"></a>Nginx的启动、停止</h2><ul>
<li>启动：进入nginx的sbin目录，<code>./nginx</code>就可以启动。</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/zQnIYqt4TShNEO2.png" alt="图片1.png"></p>
<ul>
<li>如果访问不到，首先查看防火墙是否关闭。</li>
<li>service iptables status</li>
<li>关闭nginx：<blockquote>
<ul>
<li>可以使用kill命令，但是不推荐使用。</li>
<li>推荐使用：./nginx -s stop</li>
</ul>
</blockquote>
</li>
<li>刷新配置：./nginx -s reload</li>
</ul>
<hr>
<h2 id="Nginx的配置"><a href="#Nginx的配置" class="headerlink" title="Nginx的配置"></a><code>Nginx</code>的配置</h2><ul>
<li>在<code>/usr/local/nginx/conf</code>目录下<code>nginx.conf</code>文件是<code>nginx</code>的配置文件。</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/Yz6u8eRSIdqE9Al.png" alt="图片2.png"></p>
<hr>
<h2 id="使用nginx配置虚拟机"><a href="#使用nginx配置虚拟机" class="headerlink" title="使用nginx配置虚拟机"></a>使用<code>nginx</code>配置虚拟机</h2><ul>
<li><p>在<code>nginx.conf</code>文件中添加一个<code>Service</code>节点，修改端口号就可以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen       81;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html81;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过域名区分虚拟机</p>
<blockquote>
<ul>
<li>域名介绍</li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/x13mWjrUBS9zi2e.png" alt="1574833893_1_.png"></p>
<blockquote>
<ul>
<li>可以通过修改host文件指定域名的ip地址。</li>
<li>Host文件的位置：<code>C:\Windows\System32\drivers\etc</code></li>
</ul>
</blockquote>
<ul>
<li>配置基于域名的虚拟主机<blockquote>
<ul>
<li>需要修改nginx.conf配置文件。</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  test3.taotao.com;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html-test3;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<ul>
<li>修改配置后需要重新加载配置文件。</li>
</ul>
</blockquote>
<hr>
<h2 id="Nginx的反向代理"><a href="#Nginx的反向代理" class="headerlink" title="Nginx的反向代理"></a><code>Nginx</code>的反向代理</h2><ul>
<li>什么是反向代理<blockquote>
<ul>
<li>正向代理</li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/mYjQ9oKtSybpBrA.png" alt="1574834242_1_.png"></p>
<blockquote>
<ul>
<li>反向代理</li>
</ul>
</blockquote>
<p><img src="https://i.loli.net/2019/11/27/GZNuLDlJ8yiRwaM.png" alt="1574834269_1_.png"></p>
<blockquote>
<ul>
<li>反向代理服务器是引用在服务端。决定哪台服务器提供服务。</li>
<li>反向代理的模拟</li>
<li>反向代理:应该有一个nginx服务器有多个应用服务器（可以是tomcat）、可以使用一台虚拟机，安装一个nginx，多个tomcat，来模拟。</li>
<li>Nginx的配置文件：</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">upstream tomcats&#123;</span><br><span class="line">	server 192.168.25.148:8080;</span><br><span class="line">	server 192.168.25.148:8081;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  tomcat.taotao.com;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass   http://tomcats;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="nginx负载均衡"><a href="#nginx负载均衡" class="headerlink" title="nginx负载均衡"></a><code>nginx</code>负载均衡</h2><ul>
<li>只需要在upstream的server后面添加一个weight即可代表权重。权重越高，分配请求的数量就越多。默认权重是1</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/MNfPipO8eo2USCh.png" alt="图片3.png"></p>
<h2 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h2><ul>
<li><code>finalshell</code>下载链接：<code>http://www.hostbuf.com/</code></li>
</ul>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/21/redis/">redis</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-21T07:52:33.000Z" itemprop="datePublished">2019-11-21</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/redis/">redis</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="Redis简介"><a href="#Redis简介" class="headerlink" title="Redis简介"></a>Redis简介</h2><ul>
<li>Redis是完全开源免费的，遵守<code>BSD</code>协议，是一个高性能的key-value数据库.</li>
<li>Redis是一个开源的使用C语言编写的、支持网络、可基于内存亦可持久化的日志型、key-value数据库，并提供多种语言的API。</li>
<li>redis的作者，叫Salvatore Sanfilippo，来自意大利的西西里岛，现在居住在卡塔尼亚。目前供职于Pivotal公司。他使用的网名是antirez。</li>
<li>NOSQL介绍：<ul>
<li>泛指非关系型数据库：数据与数据之间没有关联关系</li>
</ul>
</li>
<li>SQL：<ul>
<li>关系型数据库：表与表之间有关联关系。</li>
</ul>
</li>
<li>NoSQL数据库的四大分类<ul>
<li>键值存储数据库：主要会使用哈希表；一个key对应一个value值，例如redis，MongoDb</li>
<li>列存储数据库：HBase</li>
<li>文档型数据库:MongoDb</li>
<li>图形数据库：Neo4J</li>
</ul>
</li>
<li>总结NoSQL数据库在以下的这几种情况下比较适用：<ul>
<li>数据模型比较简单；</li>
<li>需要灵活性更强的IT系统；</li>
<li>对数据库性能要求比较高；</li>
<li>不需要高度的数据库一致性；</li>
<li>对于给定的key，比较容易映射复杂值的情况;</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Linux安装"><a href="#Linux安装" class="headerlink" title="Linux安装"></a>Linux安装</h2><ul>
<li>官方网站：<code>http://redis.io</code></li>
<li>安装步骤<ul>
<li>安装gcc：<code>yum -y install gcc automake autoconf libtool make</code>  </li>
<li>到官网上下载<code>redis</code></li>
<li>把下载好的<code>redis</code>上传到<code>Linux</code>上</li>
<li>解压压缩文件 <code>tar zxvf 压缩文件名</code></li>
<li>然后进入redis文件夹，进行编译:<code>make</code>或<code>make MALLOC=libc</code>，如下图代表成功<br><img src="https://i.loli.net/2019/11/22/HINlM3DmErvZkqf.png" alt="1574386791_1_.png"></li>
<li><code>make PREFIX=/usr/local/redis install</code>：（安装编译后的文件）安装到指定目录。<ul>
<li>注意: PREFIX必须大写，同时会自动为我们创建redis目录，并将结果安装到此目录。</li>
</ul>
</li>
<li>到此<code>redis</code>安装完成。</li>
</ul>
</li>
<li><code>Redis</code>启动<ul>
<li>启动<code>Redis</code>服务<ul>
<li>进入对应的安装目录：<code>/usr/local/redis</code></li>
<li>执行命令：<code>./bin/redis-server</code> </li>
</ul>
</li>
<li>启动<code>Redis</code>客户端<ul>
<li>进入对应的安装目录：<code>/usr/local/redis</code></li>
<li>执行命令：<code>./bin/redis-cli</code> </li>
</ul>
</li>
<li>启动<code>redis</code>客户端命令：<ul>
<li>redis-cli -h IP地址 -p 端口</li>
</ul>
</li>
<li>退出客户端命令:<ul>
<li>Ctrl+C</li>
</ul>
</li>
<li>测试是否服务端启动<ul>
<li>启动redis客户端，打开终端并输入命令redis-cli。该命令连接到本地的redis服务。</li>
<li>使用<code>PING</code>检测是否连接成功。</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Redis配置文件详解redis-conf"><a href="#Redis配置文件详解redis-conf" class="headerlink" title="Redis配置文件详解redis.conf"></a><code>Redis</code>配置文件详解<code>redis.conf</code></h2><ul>
<li><code>Redis</code>的配置文件位于<code>Redis</code>安装目录下，文件名为<code>redis.conf</code>(Windows名为redis.windows.conf)。</li>
<li>到redis-4.0.14目录下的<code>redis</code>复制到<code>/usr/local/redis</code>:<code>cp redis.conf /usr/local/redis</code></li>
<li>你可以通过<code>CONFIG</code>命令查看或设置配置项。</li>
<li>语法：<code>Redis CONFIG</code>命令语法格式如下：<ul>
<li><code>reids 127.0.0.1:6379&gt;CONFIG GET CONFIG_SETTING_NAME</code> </li>
</ul>
</li>
<li>redis配置文件详解<ul>
<li><code>daemonize no</code>：Redis 默认不是以守护进程的方式运行，可以通过该配置项修改，使用 yes 启用守护进程（Windows 不支持守护线程的配置为 no ）。</li>
<li><code>pidfile /var/run/redis.pid</code>：当 Redis 以守护进程方式运行时，Redis 默认会把 pid 写入 /var/run/redis.pid 文件，可以通过 pidfile 指定。</li>
<li><code>port 6379</code>：指定 Redis 监听端口，默认端口为 6379，作者在自己的一篇博文中解释了为什么选用 6379 作为默认端口，因为 6379 在手机按键上 MERZ 对应的号码，而 MERZ 取自意大利歌女 Alessia Merz 的名字。</li>
<li><code>bind</code>命令：绑定主机地址.<code>bind 127.0.0.1</code>。</li>
<li><code>timeout 300</code>：当客户端闲置多长时间后关闭连接，如果指定为 0，表示关闭该功能</li>
<li><code>loglevel notice</code>：指定日志记录级别，Redis 总共支持四个级别：debug、verbose、notice、warning，默认为 notice。</li>
<li><code>logfile stdout</code>：日志记录方式，默认为标准输出，如果配置 Redis 为守护进程方式运行，而这里又配置为日志记录方式为标准输出，则日志将会发送给 /dev/null。</li>
<li><code>databases 16</code>：设置数据库的数量，默认数据库为0，可以使用SELECT 命令在连接上指定数据库id。</li>
<li><code>save &lt;seconds&gt; &lt;changes&gt;</code>：指定在多长时间内，有多少次更新操作，就将数据同步到数据文件，可以多个条件配合。<ul>
<li><code>redis</code>默认配置文件中提供如下三个：</li>
<li><code>save 900 1</code></li>
<li><code>save 300 10</code></li>
<li><code>save 60 10000</code></li>
<li>分别表示 900 秒（15 分钟）内有 1 个更改，300 秒（5 分钟）内有 10 个更改以及 60 秒内有 10000 个更改。</li>
</ul>
</li>
<li><code>rdbcompression yes</code>:指定存储至本地数据库时是否压缩数据，默认为 yes，Redis 采用 LZF 压缩，如果为了节省 CPU 时间，可以关闭该选项，但会导致数据库文件变的巨大.</li>
<li><code>dbfilename dump.rdb</code>：指定本地数据库文件名，默认值为 dump.rdb。</li>
<li><code>dir ./</code>：指定本地数据库存放目录。</li>
<li><code>slaveof &lt;masterip&gt; &lt;masterport&gt;</code>：设置当本机为 slave 服务时，设置 master 服务的 IP 地址及端口，在 Redis 启动时，它会自动从 master 进行数据同步。</li>
<li><code>masterauth &lt;master-password&gt;</code>：当 master 服务设置了密码保护时，slave 服务连接 master 的密码。</li>
<li><code>requirepass foobared</code>：设置 Redis 连接密码，如果配置了连接密码，客户端在连接 Redis 时需要通过 <code>AUTH &lt;password&gt;</code> 命令提供密码，默认关闭。</li>
<li><code>maxclients 128</code>：设置同一时间最大客户端连接数，默认无限制，Redis 可以同时打开的客户端连接数为 Redis 进程可以打开的最大文件描述符数，如果设置 maxclients 0，表示不作限制。当客户端连接数到达限制时，Redis 会关闭新的连接并向客户端返回 max number of clients reached 错误信息。</li>
<li><code>maxmemory &lt;bytes&gt;</code>：指定 Redis 最大内存限制，Redis 在启动时会把数据加载到内存中，达到最大内存后，Redis 会先尝试清除已到期或即将到期的 Key，当此方法处理 后，仍然到达最大内存设置，将无法再进行写入操作，但仍然可以进行读取操作。Redis 新的 vm 机制，会把 Key 存放内存，Value 会存放在 swap 区。</li>
<li><code>appendonly no</code>：指定是否在每次更新操作后进行日志记录，Redis 在默认情况下是异步的把数据写入磁盘，如果不开启，可能会在断电时导致一段时间内的数据丢失。因为 redis 本身同步数据文件是按上面 save 条件来同步的，所以有的数据会在一段时间内只存在于内存中。默认为 no。</li>
<li><code>appendfilename appendonly.aof</code>：指定更新日志文件名，默认为 appendonly.aof。</li>
<li><code>appendfsync everysec</code>：指定更新日志条件，公有三个可选值。no：表示等操作系统进行数据缓存同步到磁盘（快）；always：表示每次更新操作后手动调用 fsync() 将数据写到磁盘（慢，安全）；表示每秒同步一次（折中，默认值）；</li>
<li><code>vm-enabled no</code>：指定是否启用虚拟内存机制，默认值为 no，简单的介绍一下，VM 机制将数据分页存放，由 Redis 将访问量较少的页即冷数据 swap 到磁盘上，访问多的页面由磁盘自动换出到内存中（在后面的文章我会仔细分析 Redis 的 VM 机制）。</li>
<li><code>vm-swap-file /tmp/redis.swap</code>：虚拟内存文件路径，默认值为 /tmp/redis.swap，不可多个 Redis 实例共享。</li>
<li><code>vm-max-memory 0</code>：将所有大于 vm-max-memory 的数据存入虚拟内存，无论 vm-max-memory 设置多小，所有索引数据都是内存存储的(Redis 的索引数据 就是 keys)，也就是说，当 vm-max-memory 设置为 0 的时候，其实是所有 value 都存在于磁盘。默认值为 0。</li>
<li><code>vm-page-size 32</code>：Redis swap 文件分成了很多的 page，一个对象可以保存在多个 page 上面，但一个 page 上不能被多个对象共享，vm-page-size 是要根据存储的 数据大小来设定的，作者建议如果存储很多小对象，page 大小最好设置为 32 或者 64bytes；如果存储很大大对象，则可以使用更大的 page，如果不确定，就使用默认值。</li>
<li><code>vm-pages 134217728</code>：设置 swap 文件中的 page 数量，由于页表（一种表示页面空闲或使用的 bitmap）是在放在内存中的，，在磁盘上每 8 个 pages 将消耗 1byte 的内存。</li>
<li><code>vm-max-threads 4</code>：设置访问swap文件的线程数,最好不要超过机器的核数,如果设置为0,那么所有对swap文件的操作都是串行的，可能会造成比较长时间的延迟。默认值为4。</li>
<li><code>glueoutputbuf yes</code>：设置在向客户端应答时，是否把较小的包合并为一个包发送，默认为开启。</li>
<li><code>hash-max-zipmap-entries 64、hash-max-zipmap-value 512</code>：指定在超过一定的数量或者最大的元素超过某一临界值时，采用一种特殊的哈希算法。</li>
<li><code>activerehashing yes</code>：指定是否激活重置哈希，默认为开启（后面在介绍 Redis 的哈希算法时具体介绍）</li>
<li><code>include /path/to/local.conf</code>：指定包含其它的配置文件，可以在同一主机上多个Redis实例之间使用同一份配置文件，而同时各个实例又拥有自己的特定配置文件。</li>
</ul>
</li>
<li><code>Redis</code>缺点：占用很大的内存空间，在<code>redis</code>中有两种解决方案<ul>
<li>一是为数据设置超时时间。</li>
<li>二是采用LRU算法动态将不同的数据删除。</li>
</ul>
</li>
<li>设定内存空间，建议内存不要超过1G 256-512M</li>
<li>自定义配置<code>redis</code><ul>
<li>进入对应的安装目录：<code>/usr/local/redis</code>，修改redis.conf配置文件：<code>vim redis.conf</code></li>
<li>Redis配置默认必须修改<ul>
<li>daemonize no 修改为 daemonize yes</li>
<li>bind 127.0.0.1 注释掉</li>
<li>requirepass 设置密码 </li>
</ul>
</li>
</ul>
</li>
<li>重新启动redis服务：<code>./bin/redis-server ./redis-conf</code></li>
<li>查看状态：<code>ps -ef | grep -i redis</code></li>
<li>重启启动redis客户端：注意此时是带有密码。</li>
<li>远程服务执上行命令：<code>redis-cli -h host -p port -a password</code>、<code>redis-cli -h IP地址 -p 端口 -a 密码</code>。 </li>
<li><code>key *</code>：查看所有的key值。</li>
<li><code>set key</code>：指定key-value值。</li>
<li><code>get key</code>：获取key对应的值。</li>
</ul>
<hr>
<h2 id="Redis关闭"><a href="#Redis关闭" class="headerlink" title="Redis关闭"></a><code>Redis</code>关闭</h2><ul>
<li>第一种方式：（断电、非正常关闭。容易丢失数据）<ul>
<li>查询PID：<code>ps -ef | grep -i redis</code>。</li>
<li><code>kill -9 PID</code>。</li>
</ul>
</li>
<li>第二种方式：（正常关闭，数据保存）<ul>
<li><code>./bin/redis-cli shutdown</code>：关闭redis服务，通过客户端进行<code>shutdown</code></li>
<li>如果redis设置了密码，需要现在客户端通过密码登录，再进行<code>shutdown</code>即可关闭服务端。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Redis基本命令"><a href="#Redis基本命令" class="headerlink" title="Redis基本命令"></a><code>Redis</code>基本命令</h2><ul>
<li><code>Redis</code>命令用于在<code>Redis</code>服务上执行操作。</li>
<li>要在<code>Redis</code>服务上执行命令需要一个<code>Redis</code>客户端。</li>
<li><code>Redis</code>客户端在我们之前下载的<code>Redis</code>的安装包中。</li>
<li>Redis 键(key)<ul>
<li><code>Redis</code>健命令的基本语法：<code>COMMAND KEY_NAME</code></li>
<li><code>DEL key</code>：该命令用于在key存在时删除key。</li>
<li><code>DUMP key</code>：序列化给定key，并返回被序列化的值。</li>
<li><code>EXISTS key</code>：判断指定的key是否存在。 </li>
<li><code>EXPIRE key seconds</code>：为给定key设置过期时间，以秒计。</li>
<li><code>TTL key</code>：以秒为单位返回key的剩余的过期时间。</li>
<li><code>PTTL key</code>：以秒为单位返回key的剩余的过期时间（毫秒）。</li>
<li><code>EXPIRE key second</code>：为给定的key设置过期时间（以秒计）。</li>
<li><code>PEXPIRE key miilsecond</code>：为给定的key设置过期时间（以毫秒计）。</li>
<li><code>presist key</code>：将key永久有效</li>
<li><code>key pattern</code>：查找所有的key。* , ?</li>
<li><code>rename key newkey</code>：修改指定key的名称</li>
<li><code>move key  db</code>：将指定key移到指定数据库。</li>
<li><code>key</code>：返回指定key所存储的数据类型</li>
<li>… 剩余的查看<code>https://www.runoob.com/redis/redis-keys.html</code></li>
</ul>
</li>
<li>应用场景<ul>
<li><code>expire key seconds</code>：</li>
<li>限时的优惠活动信息。</li>
<li>网站数据缓存（对于一些需要定时更新的数据，例如：积分排行版）</li>
<li>手机验证码</li>
<li>限时网站访客访问频率（例如：1分钟最多访问10次）</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Redis中key的命名规范"><a href="#Redis中key的命名规范" class="headerlink" title="Redis中key的命名规范"></a><code>Redis</code>中key的命名规范</h2><ul>
<li><code>key</code>的命名建议：<ul>
<li><code>Redis</code>单个<code>key</code>存入512M大小</li>
<li>key可以不要太长，尽量不要超过1024字节，这不仅消耗内存，而且会降低查找的效率。</li>
<li>key也不要太短，太短的话，key的可读性会降低</li>
<li>在一个项目中，key最好使用统一的命名模式，例如<code>user:123:password</code></li>
<li>key的名称区分大小写</li>
</ul>
</li>
</ul>
<hr>
<h2 id="String类型简介"><a href="#String类型简介" class="headerlink" title="String类型简介"></a>String类型简介</h2><ul>
<li><p>String是redis最基本的类型，一个key对应一个value.</p>
</li>
<li><p>String是二进制完全。意思是redis的string可以包含任何数据。比如jpg图片或者是序列化对象.</p>
</li>
<li><p>String类型是redis最基本的数据类型，一个键最大能存储512MB。</p>
</li>
<li><p>二进制安全是指，在传输数据时，保证二进制数据的信息完全，也就是不被篡改、破译等，如果被攻击，能给即时检测出来。</p>
</li>
<li><p>二进制完全特点</p>
<ul>
<li>编码、解码发生在客户端完成，执行效率高。</li>
<li>不需要频繁的编解码，不会出现乱码。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="String类型的常用指令"><a href="#String类型的常用指令" class="headerlink" title="String类型的常用指令"></a>String类型的常用指令</h2><ul>
<li>赋值语法：SAET KEY_Name VALUE。用于给指定的key设置值，如果在key已经存储值，SET就覆写旧值，且无视类型。</li>
<li>取值语法：GET KEY_NAME，如果key不存在，则返回nil。如果key存储的值不是字符串类型，返回一个错误。</li>
<li>SETNX key value：如果key不存在时设置key的值。</li>
<li>getrange key start end：返回 key 中字符串值的子字符</li>
<li>GETBIT key offset：对 key 所储存的字符串值，获取指定偏移量上的位(bit)。</li>
<li>GETSET  key value： 将给定 key 的值设为 value ，并返回 key 的旧值(old value)。</li>
<li>MGET key1 <code>[key2..]</code>：获取所有(一个或多个)给定 key 的值。</li>
<li>strlen key：返回key所存储的字符串值的长度。</li>
<li>删除语法：del key_name：删除指定的key，如果存在，返回值数字类型。</li>
<li>自增/自减 incr key_name、DECR Key_Name；incrby key_name 数字/decrby ley_name 数字：自增数字/自减数字</li>
<li>set key value：解决分布式锁方案之一</li>
<li>应用场景<ul>
<li>String通常用于保存当个字符串或json字符串数据。</li>
<li>因String是二进制安全，通常可以利用它存储图片。</li>
<li>计数器。</li>
<li>Incr是原子性操作。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="哈希-Hash"><a href="#哈希-Hash" class="headerlink" title="哈希(Hash)"></a>哈希(Hash)</h2><ul>
<li>简介： hash 是一个 string 类型的 field 和 value 的映射表，hash 特别适合用于存储对象。Redis 中每个 hash 可以存储 232 - 1 键值对（40多亿）。</li>
<li>常用命令   <ul>
<li><code>hset key field value</code>：将哈希表中的key中的字段field的值设为value。</li>
<li><code>hmset key field value</code>：将多个值同时存储。</li>
<li><code>hget key field</code>：获取存储在哈希表中指定字段的值。</li>
<li><code>hmget key field1,field2</code>：获取key所有给定字段的值。</li>
<li><code>hmgetall key</code>：返回Hash表所有的字段和值。</li>
<li><code>hkeys key</code>：获取所有哈希表中的字段。</li>
<li><code>hlen key</code>：获取哈希表字段的数量。</li>
<li>删除语法: <code>hdel key field[field]</code>：删除指定key中的指定一个或多个属性。</li>
<li><code>hincrby key field increment</code>：将key中的field增加increment。</li>
<li><code>hsetex key age</code>：当不存在时设置值。</li>
<li><code>hexists key field</code>：查看hash表中，指定字段是否存在。</li>
<li><code>HINCRBYFLOAT key field increment</code>：为哈希表 key 中的指定字段的浮点数值加上增increment 。</li>
<li><code>hkeys key</code>：获取所有哈希表中的字段。</li>
<li><code>hvals key</code>:获取哈希表中所有值。</li>
</ul>
</li>
<li>应用场景:(存储一个用户信息对象数据)<ul>
<li>常用于存储一个对象。</li>
<li>为什么不使用string存储一个对象。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Java连接Redis"><a href="#Java连接Redis" class="headerlink" title="Java连接Redis"></a>Java连接Redis</h2><ul>
<li><p>在官方网站列一些Java客户端访问，有：Jedis/Redisson/Jredis/JDBC-Redis等，其中官方推荐使用的是Jedis和Redisson。常用Jedis。</p>
</li>
<li><p>Jedis的使用步骤:</p>
<ul>
<li>在Java工程中导入jar包</li>
<li>使用<code>Jedis jedis=new Jedis(&quot;192.168.166.132&quot;, 6379);</code>与redis建立连接，第一个参数为ip地址，第二个参数为端口号。</li>
<li>使用<code>jedis.auth(&quot;123456&quot;);</code>输入连接密码进行连接。</li>
<li>进行相关操作。注意：jedis中的方法与redis中的指令基本相同。</li>
<li>关闭连接对象。</li>
</ul>
</li>
<li><p>注意：此处还要释放Linux对外开放的端口号：6379；</p>
<ul>
<li>修改防火墙：<code>vim /etc/syscofnig/iptables</code></li>
<li>修改完之后重启防火墙：<code>service iptables restart</code></li>
</ul>
</li>
<li><p>案例实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String host=<span class="string">"192.168.166.132"</span>;</span><br><span class="line">    <span class="keyword">int</span> port=<span class="number">6379</span>;</span><br><span class="line">    <span class="comment">//连接redis服务器</span></span><br><span class="line">    Jedis jedis=<span class="keyword">new</span> Jedis(host, port);</span><br><span class="line">    <span class="comment">//连接redis密码</span></span><br><span class="line">    jedis.auth(<span class="string">"123456"</span>);</span><br><span class="line">    System.out.println(jedis.ping());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">    * 测试字符串string</span></span><br><span class="line"><span class="comment">    * Redis中有哪些命令，jedis就有哪些方法</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//连接redis服务器</span></span><br><span class="line">    Jedis jedis=<span class="keyword">new</span> Jedis(<span class="string">"192.168.166.132"</span>, <span class="number">6379</span>);</span><br><span class="line">    <span class="comment">//连接redis密码</span></span><br><span class="line">    jedis.auth(<span class="string">"123456"</span>);</span><br><span class="line">    jedis.set(<span class="string">"strName"</span>, <span class="string">"字符串的名称"</span>);</span><br><span class="line">    String strName = jedis.get(<span class="string">"strName"</span>);</span><br><span class="line">    System.out.println(<span class="string">"redis中的数据："</span>+strName);</span><br><span class="line">    <span class="comment">//关闭redis</span></span><br><span class="line">    jedis.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">    * redis作用：为了减轻数据库（Mysql）的访问压力</span></span><br><span class="line"><span class="comment">    * 需求：判断某key是否存在，如果存在，就从Redis中查询，如果不存在就查询数据库，且将查询结果存入到redis;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//连接redis服务器</span></span><br><span class="line">    Jedis jedis=<span class="keyword">new</span> Jedis(<span class="string">"192.168.166.132"</span>, <span class="number">6379</span>);</span><br><span class="line">    <span class="comment">//连接redis密码</span></span><br><span class="line">    jedis.auth(<span class="string">"123456"</span>);</span><br><span class="line">    </span><br><span class="line">    String key=<span class="string">"applicationName"</span>;<span class="comment">//key的名称</span></span><br><span class="line">    <span class="keyword">if</span>(jedis.exists(key)) &#123;</span><br><span class="line">        <span class="comment">//存在，直接获取</span></span><br><span class="line">        String result = jedis.get(key);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">        </span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//在数据库中查询</span></span><br><span class="line">        String result=<span class="string">"微信开发会议达人"</span>;</span><br><span class="line">        jedis.set(key, result);</span><br><span class="line">        System.out.println(<span class="string">"Mysql数据库中查询得到："</span>+result);</span><br><span class="line">    &#125;</span><br><span class="line">    jedis.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Jedis工具类"><a href="#Jedis工具类" class="headerlink" title="Jedis工具类"></a><code>Jedis</code>工具类</h2><ul>
<li><p><code>Jedis</code>连接池优化操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Jedis连接池</span></span><br><span class="line">    <span class="comment">//1.连接池Redis POOL 基本配置信息</span></span><br><span class="line">    JedisPoolConfig poolConfig=<span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">    poolConfig.setMaxTotal(<span class="number">5</span>);<span class="comment">//设置最大连接数</span></span><br><span class="line">    poolConfig.setMaxIdle(<span class="number">1</span>);<span class="comment">//设置最大空闲数</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="comment">//2. 连接池</span></span><br><span class="line">    JedisPool pool=<span class="keyword">new</span> JedisPool(poolConfig, <span class="string">"192.168.166.132"</span>,<span class="number">6379</span>);</span><br><span class="line">    Jedis jedis=pool.getResource();</span><br><span class="line">    jedis.auth(<span class="string">"123456"</span>);</span><br><span class="line">    System.out.println(jedis.ping());</span><br><span class="line">    jedis.close();</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Jedis</code>工具类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * 获取redis连接工具类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 1huangzewei</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisPoolUtil</span> </span>&#123;</span><br><span class="line">	<span class="comment">//Jedis连接池对象</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> JedisPool pool;</span><br><span class="line">	<span class="comment">//连接redis的IP地址</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String host=<span class="string">"192.168.166.132"</span>;</span><br><span class="line">	<span class="comment">//连接redis的IP地址的所在端口</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> port=<span class="number">6379</span>;</span><br><span class="line">	<span class="comment">//连接redis服务端的密码</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String pwd=<span class="string">"123456"</span>;</span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		<span class="comment">//Jedis连接池</span></span><br><span class="line">		<span class="comment">//1.连接池Redis POOL 基本配置信息</span></span><br><span class="line">		JedisPoolConfig poolConfig=<span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">		poolConfig.setMaxTotal(<span class="number">5</span>);<span class="comment">//设置最大连接数</span></span><br><span class="line">		poolConfig.setMaxIdle(<span class="number">1</span>);<span class="comment">//设置最大空闲数</span></span><br><span class="line">		<span class="comment">//...其他配置</span></span><br><span class="line">		<span class="comment">//2. 连接池</span></span><br><span class="line">		pool=<span class="keyword">new</span> JedisPool(poolConfig, host,port);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 获取连接对象</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> Jedis</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Jedis <span class="title">getJedis</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Jedis jedis = pool.getResource();</span><br><span class="line">		jedis.auth(pwd);</span><br><span class="line">		<span class="keyword">return</span> jedis;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 释放资源</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> jedis</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(Jedis jedis)</span> </span>&#123;</span><br><span class="line">		jedis.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<hr>
<h2 id="Jedis-hash类型读取"><a href="#Jedis-hash类型读取" class="headerlink" title="Jedis-hash类型读取"></a><code>Jedis-hash</code>类型读取</h2><ul>
<li><p>案例一</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">    * Jedis完成对hash类型操作</span></span><br><span class="line"><span class="comment">    * 需求：hash存储一个对象</span></span><br><span class="line"><span class="comment">    * 判断redis中是否存在该key，如果存在，直接返回，如果不存在，数据库查询，并将结果存储在redis</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Jedis jedis=RedisPoolUtil.getJedis();</span><br><span class="line">    String key=<span class="string">"users"</span>;</span><br><span class="line">    <span class="keyword">if</span>(jedis.exists(key)) &#123;</span><br><span class="line">        Map&lt;String, String&gt; map = jedis.hgetAll(key);</span><br><span class="line">        System.out.println(<span class="string">"从redis中查询的数据"</span>);</span><br><span class="line">        System.out.println(map.get(<span class="string">"id"</span>)+<span class="string">"\t"</span>+map.get(<span class="string">"name"</span>));</span><br><span class="line">        System.out.println(map.get(<span class="string">"age"</span>)+<span class="string">"\t"</span>+map.get(<span class="string">"remark"</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"从数据库中查询结果并且赋值到redis"</span>);</span><br><span class="line">        <span class="comment">//查询数据库并返回结果</span></span><br><span class="line">        jedis.hset(key,<span class="string">"id"</span>,<span class="string">"1"</span>);</span><br><span class="line">        jedis.hset(key,<span class="string">"name"</span>,<span class="string">"迪丽热巴"</span>);</span><br><span class="line">        jedis.hset(key, <span class="string">"age"</span>,<span class="string">"27"</span>);</span><br><span class="line">        jedis.hset(key, <span class="string">"remark"</span>,<span class="string">"这是一位女明星"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    RedisPoolUtil.close(jedis);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>案例二：对案例一进行优化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">    * 对上面方法进行优化</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t5</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Users selectById(String id);</span></span><br><span class="line">    Jedis jedis=RedisPoolUtil.getJedis();</span><br><span class="line">    <span class="keyword">int</span> id=<span class="number">1</span>;</span><br><span class="line">    String key=User.getKeyName()+id;<span class="comment">//user:1</span></span><br><span class="line">    <span class="keyword">if</span>(jedis.exists(key)) &#123;</span><br><span class="line">        <span class="comment">//从redis中取出对象</span></span><br><span class="line">        Map&lt;String, String&gt; hash = jedis.hgetAll(key);</span><br><span class="line">        User u=<span class="keyword">new</span> User(Integer.parseInt(hash.get(<span class="string">"id"</span>)),hash.get(<span class="string">"name"</span>),Integer.parseInt(hash.get(<span class="string">"age"</span>)),hash.get(<span class="string">"remark"</span>));</span><br><span class="line">        System.out.println(<span class="string">"redis中查询的结果："</span>+u);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//查询数据库并返回结果</span></span><br><span class="line">        User u=<span class="keyword">new</span> User(id,<span class="string">"迪丽热巴"</span>,<span class="number">27</span>,<span class="string">"这是一位女明星"</span>);</span><br><span class="line">        Map&lt;String,String&gt; map=<span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">        map.put(<span class="string">"id"</span>, id+<span class="string">""</span>);</span><br><span class="line">        map.put(<span class="string">"name"</span>,u.getName());</span><br><span class="line">        map.put(<span class="string">"age"</span>,u.getAge()+<span class="string">""</span>);</span><br><span class="line">        map.put(<span class="string">"remark"</span>,u.getRemark());</span><br><span class="line">        jedis.hmset(key, map);</span><br><span class="line">        System.out.println(<span class="string">"从数据库中查询结果并且赋值到redis的对象为："</span>+u);</span><br><span class="line">    &#125;</span><br><span class="line">    RedisPoolUtil.close(jedis);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<hr>
<p>-</p>
<h2 id="SpringData整合redis"><a href="#SpringData整合redis" class="headerlink" title="SpringData整合redis"></a>SpringData整合redis</h2><ol>
<li>步骤<blockquote>
<p>导入jar包</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Jedis客户端需要依赖的jar Redis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- springdata整个redis --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.data/spring-data-redis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.data<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/commons-logging/commons-logging --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<blockquote>
<p>编写配置文件：spring_redis.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 注解扫描 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib.service.impl"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span>	</span><br><span class="line">      <span class="comment">&lt;!-- 配置一个连接池信息 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jedisPoolConfig"</span> <span class="attr">class</span>=<span class="string">"redis.clients.jedis.JedisPoolConfig"</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 最大连接数 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxTotal"</span> <span class="attr">value</span>=<span class="string">"50"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 最大空闲数 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdle"</span> <span class="attr">value</span>=<span class="string">"5"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- Spring整合Jedis(redis) --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jedisConnectionFactory"</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.connection.jedis.JedisConnectionFactory"</span>&gt;</span> </span><br><span class="line">     	<span class="comment">&lt;!-- 指定服务器地址 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hostName"</span> <span class="attr">value</span>=<span class="string">"192.168.166.132"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 指定服务器端口号 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"port"</span> <span class="attr">value</span>=<span class="string">"6379"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 指定密码 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 自定义连接池配置 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"poolConfig"</span> <span class="attr">ref</span>=<span class="string">"jedisPoolConfig"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>	</span><br><span class="line">      <span class="comment">&lt;!-- RedisTemplate --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"redisTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.core.RedisTemplate"</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connectionFactory"</span> <span class="attr">ref</span>=<span class="string">"jedisConnectionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- key进行序列化设置，默认JDK改为String --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"keySerializer"</span>&gt;</span></span><br><span class="line">      		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.serializer.StringRedisSerializer"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- value JDK默认为String --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"valueSerializer"</span>&gt;</span></span><br><span class="line">      		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.serializer.StringRedisSerializer"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>编写业务逻辑接口：UserService</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * string 存和取测试</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getString</span><span class="params">(String key)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>编写该接口的实现类：UserServiceImpl.java</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * string类型测试	</span></span><br><span class="line"><span class="comment">	 * 通过某个key得到值</span></span><br><span class="line"><span class="comment">	 * 如果key在redis中不存在，到数据库查询</span></span><br><span class="line"><span class="comment">	 * 如果存在，就到redis中查询</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getString</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">		ValueOperations&lt;String, String&gt; string = redisTemplate.opsForValue();</span><br><span class="line">        <span class="comment">//先赋值后设置失效日期</span></span><br><span class="line">        <span class="comment">//redisTemplate.opsForValue().set("java1803", "这是一个测试数据");</span></span><br><span class="line">		<span class="comment">//redisTemplate.expire(key, 2, TimeUnit.HOURS);</span></span><br><span class="line">		redisTemplate.opsForValue().set(<span class="string">"java1803"</span>, <span class="string">"这是一个测试数据"</span>, <span class="number">2</span>, TimeUnit.SECONDS);</span><br><span class="line">		<span class="comment">//判断redis中是否存在key</span></span><br><span class="line">		<span class="keyword">if</span>(redisTemplate.hasKey(key)) &#123;</span><br><span class="line">			<span class="comment">//在redis中取出并返回</span></span><br><span class="line">			System.out.println(<span class="string">"在redis中取出并返回"</span>);</span><br><span class="line">			<span class="keyword">return</span> string.get(key);</span><br><span class="line">			</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">//查询数据库</span></span><br><span class="line">			String result=<span class="string">"RedisTemplate模板练习"</span>;</span><br><span class="line">			string.set(key,result);</span><br><span class="line">			System.out.println(<span class="string">"Mysql数据库中取出并返回"</span>);</span><br><span class="line">			<span class="keyword">return</span> result;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>编写测试类 RedisTemplateTest.java</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">    * 测试string RedisTemplate</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ApplicationContext ctx=<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"spring_redis.xml"</span>);</span><br><span class="line">    UserService userService = ctx.getBean(UserService.class);</span><br><span class="line">    String key=<span class="string">"java1803"</span>;</span><br><span class="line">    String result = userService.getString(key);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Redis客户端工具：<ul>
<li><code>https://redisdesktop.com/download</code></li>
<li><code>http://www.pc6.com/softview/SoftView_450180.html</code></li>
</ul>
</li>
<li>序列化：修改配置文件：<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- key进行序列化设置，默认JDK改为String --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"keySerializer"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.serializer.StringRedisSerializer"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- value JDK默认为String --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"valueSerializer"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.serializer.StringRedisSerializer"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<hr>
<h2 id="案例作业"><a href="#案例作业" class="headerlink" title="案例作业"></a>案例作业</h2><p>限制登录功能：用户在两个小时内仅允许输入错误密码3次。如果超过次数，限制其登录5小时。</p>
<ul>
<li>登录页面login.jsp（要求每次登录失败时，都给相应提示）</li>
<li>后台建个用户登录表。输入用户名和密码</li>
<li>如果用户在2分钟内输入密码错误3次，如果超过3次，给其提示：连续输错密码超过三次。限制其登录1小时</li>
<li>用户在2分钟内，仅允许输入错误密码5次、如果超过次数，限制其登录1小时。 （12306）</li>
</ul>
<hr>
<hr>
<h2 id="hash基本指令"><a href="#hash基本指令" class="headerlink" title="hash基本指令"></a>hash基本指令</h2><ul>
<li>案例<blockquote>
<p>业务逻辑 UserServiceImpl.java</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * hash 存储测试</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> u</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(User u)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">selectById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">	<span class="comment">//模板的简化</span></span><br><span class="line">	<span class="meta">@Resource</span>(name=<span class="string">"redisTemplate"</span>)</span><br><span class="line">	HashOperations&lt;String, String,User&gt; hash;</span><br><span class="line">    <span class="comment">//存储 往redis中存储hash数据</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(User u)</span> </span>&#123;</span><br><span class="line">		hash.put(<span class="string">"user"</span>, u.getId()+<span class="string">""</span>, u);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据用户主键id查询对象</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">selectById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//先判断Redis中key是否存在，如果存在，从Redis中取出，并且返回</span></span><br><span class="line">		Boolean bol=<span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			bol = hash.hasKey(<span class="string">"user"</span>,id+<span class="string">""</span>);</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			bol=<span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(bol) &#123;</span><br><span class="line">			User u = (User) redisTemplate.opsForHash().get(<span class="string">"user"</span>, id+<span class="string">""</span>);</span><br><span class="line">			System.out.println(<span class="string">"redis数据库中查询的数据"</span>);</span><br><span class="line">			<span class="keyword">return</span> u;</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">//hash存储类型</span></span><br><span class="line">			com.gdaib.pojo.User u=<span class="keyword">new</span> com.gdaib.pojo.User(id,<span class="string">"哈哈呵呵"</span>,<span class="number">25</span>,<span class="string">"这是一个女明星！"</span>);</span><br><span class="line">			System.out.println(<span class="string">"mysql中查询的数据"</span>);</span><br><span class="line">			hash.put(<span class="string">"user"</span>, u.getId()+<span class="string">""</span>, u);</span><br><span class="line">			<span class="keyword">return</span> u;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//如果不存在，从数据库中查询，取出付给Redis，返回</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>测试代码</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisTemplateTest</span> </span>&#123;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 测试hash</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ApplicationContext ctx=<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"spring_redis.xml"</span>);</span><br><span class="line">		UserService userService = ctx.getBean(UserService.class);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//hash存储类型</span></span><br><span class="line">		com.gdaib.pojo.User u=<span class="keyword">new</span> com.gdaib.pojo.User(<span class="number">2</span>,<span class="string">"欧阳娜娜"</span>,<span class="number">20</span>,<span class="string">"这是一个女明星！"</span>);</span><br><span class="line">		userService.add(u);</span><br><span class="line">		System.out.println(<span class="string">"---------hash数据存储成功hash---------"</span>);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 测试hash</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ApplicationContext ctx=<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"spring_redis.xml"</span>);</span><br><span class="line">		UserService userService = ctx.getBean(UserService.class);</span><br><span class="line">		<span class="keyword">int</span> id=<span class="number">7</span>;</span><br><span class="line">		User u = userService.selectById(id);</span><br><span class="line">		System.out.println(u);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>修改默认的序列化设置<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- RedisTemplate --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"redisTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.core.RedisTemplate"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connectionFactory"</span> <span class="attr">ref</span>=<span class="string">"jedisConnectionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- hash key序列化设置，默认jdk改为hash --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hashKeySerializer"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.serializer.StringRedisSerializer"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<hr>
<h2 id="List基本命令"><a href="#List基本命令" class="headerlink" title="List基本命令"></a><code>List</code>基本命令</h2><ul>
<li>Redis列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边）。</li>
<li>一个列表最多可以包含 2^32 - 1 个元素 (4294967295, 每个列表超过40亿个元素)。</li>
<li>类似于JAVA语言的<code>LinkedList</code>.</li>
<li>命令<blockquote>
<ul>
<li>赋值语法：<blockquote>
<ul>
<li><code>LPUSH key value1 [value2]</code>：讲一个或多个值插入到列表头部（从左侧添加）。</li>
<li><code>RPUSH key value1 [value2]</code>：在列表中添加一个或多个值（从右侧添加）。</li>
<li><code>LPUSHX key value</code>：将一个值插入到已经存在的列表头部。如果列表不存在，操作无效。</li>
<li><code>RPUSHX key value</code>：一个值插入到已经存在的列表的尾部（最右边）。如果列表不存在，操作无效。</li>
</ul>
</blockquote>
</li>
<li>取值语法：<blockquote>
<ul>
<li><code>LLEN key</code>：取得列表长度。</li>
<li><code>Lindex key index</code>：通过索引取得列表中的元素。</li>
<li><code>LRANGE key start stop</code>：获取列表指定范围的元素。（0代表一个元素，1代表第二个元素，-1代表最后元素，-2代表倒数第二个）</li>
</ul>
</blockquote>
</li>
<li>删除语法：<blockquote>
<ul>
<li><code>LPOP key</code>：溢出并获取列表的第一个元素（从左侧删除）。</li>
<li><code>RPOP key</code>：移除列表的最后一个元素，返回值为移除值。</li>
<li><code>BLPOP key1 [key2] timeout</code>：移除并获取列表的第一个元素，如果列表没有元素会阻塞列表直到等待超时或发现可弹出元素为止。（如果超时返回nil）</li>
<li><code>BRPOP key1 [key2 ] timeout</code>：移出并获取列表的最后一个元素， 如果列表没有元素会阻塞列表直到等待超时或发现可弹出元素为止。</li>
<li><code>LTRIM key start stop</code>：对一个列表进行修剪（trim），就是说，让列表只保留指定区间内的元素，不在指定区域内的元素都将被删除。</li>
</ul>
</blockquote>
</li>
<li>修改语法<blockquote>
<ul>
<li><code>LSET key index value</code>：通过索引设置列表元素的值。</li>
<li><code>LINSERT key BEFORE|AFTER world value2</code>:在列表指定元素前或后插入元素。</li>
</ul>
</blockquote>
</li>
<li>高级语法<blockquote>
<ul>
<li><code>RPOPLPUSH source destination</code>：移除列表最后一元素，并将该元素添加到另一个列表并返回。 </li>
<li><code>BRPOPLPUISH source destination timeout</code>：从列表中弹出一个值，将弹出的元素插入到另一个列表中并返回他；如果列表中没有元素会阻塞列表直到等待超时或者发现可弹出元素为止。</li>
<li><code>LREM key count value</code>：移除列表元素</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>应用场景<blockquote>
<ul>
<li>对数据量大的集合数据删减（列表展示、关注列表、粉丝列表、留言评价等…分页、热点新闻（TOP5）等）</li>
<li>任务队列</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Set类型"><a href="#Set类型" class="headerlink" title="Set类型"></a><code>Set</code>类型</h2><ul>
<li>Redis 的 Set 是 String 类型的无序集合。集合成员是唯一的，这就意味着集合中不能出现重复的数据。</li>
<li>Redis 中集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是 O(1)。</li>
<li>集合中最大的成员数为 232 - 1 (4294967295, 每个集合可存储40多亿个成员)。</li>
<li>底层是hashtable和intset。</li>
<li>命令<blockquote>
<ul>
<li>赋值语法<blockquote>
<ul>
<li><code>SADD key member1 [member2]</code>：向集合中添加一个或多个成员。</li>
</ul>
</blockquote>
</li>
<li>取值语法<blockquote>
<ul>
<li><code>SCARD key</code>：获取集合的成员数。</li>
<li><code>SMEMBERS key</code>：返回集合中的所有成员。</li>
<li><code>SISMENBER key member</code>：判断member元素是否是集合key的成员（开发中：验证是否存在判断）</li>
<li><code>SRANDMENBER key [count]</code>：返回集合中一个或多个随机数。</li>
<li><code>SSCAN key cursor [MATCH pattern] [COUNT count]</code>：迭代集合中的元素。</li>
</ul>
</blockquote>
</li>
<li>删除语法<blockquote>
<ul>
<li><code>SREM key member1 [member2]</code>：移除集合中一个或多个元素。</li>
<li><code>SPOP key[count]</code>：移除并返回集合中的一个随机元素。</li>
<li><code>SMOVE source destination member</code>：将member元素从source集合移动到destination集合。</li>
</ul>
</blockquote>
</li>
<li>差集语法<blockquote>
<ul>
<li><code>SDIFF key1 [key2]</code>：返回给定集合的差集（左侧）</li>
<li><code>SDIFFSTORE destination key1 [key2]</code>：返回给定所有集合的差集并存储在<code>destination</code>中。</li>
</ul>
</blockquote>
</li>
<li>交集语法<blockquote>
<ul>
<li><code>SINTER key1 [key2]</code>：返回给定所有集合的交集（共有的数据）。</li>
<li><code>SINTERSTORE key1 [key2]</code>：返回给定所有集合的交集并存储在<code>destination</code>中。</li>
</ul>
</blockquote>
</li>
<li>并集语法<blockquote>
<ul>
<li><code>SUNION key1 [key2]</code>：返回所有给定集合的并集。</li>
<li><code>SUNIONSTORE destination key1 [key2]</code>：返回所有给定集合的并集并存储在<code>destination</code>中。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>应用场景<blockquote>
<ul>
<li>常应用于：对两个集合间的数据【计算】进行并集、交集、差集运算。</li>
<li>非常方便实现如共同关注、共同爱好、二度好友等，</li>
<li>利用唯一性，还可以统计访问网站的所有独立IP。</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Zset类型"><a href="#Zset类型" class="headerlink" title="Zset类型"></a><code>Zset</code>类型</h2><ul>
<li>Redis 有序集合和集合一样也是string类型元素的集合,且不允许重复的成员。</li>
<li>不同的是每个元素都会关联一个double类型的分数。redis正是通过分数来为集合中的成员进行从小到大的排序。</li>
<li>有序集合的成员是唯一的,但分数(score)却可以重复。</li>
<li>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。 集合中最大的成员数为 232 - 1 (4294967295, 每个集合可存储40多亿个成员)。</li>
<li>底层是hashtable和intset。</li>
<li>命令<blockquote>
<ul>
<li>赋值语法<blockquote>
<ul>
<li><code>ZADD key source member1 [source2 member2]</code>：向有序集合中添加一个或多个成员，或者更新已存在成员的分数。</li>
</ul>
</blockquote>
</li>
<li>取值语法<blockquote>
<ul>
<li><code>ZCARD key</code>：获取有序集合元素的成员数。</li>
<li><code>ZCOUNT key min max</code>：计算在有序集合中指定区间分数的成员数。</li>
<li><code>ZRANK key member</code>：返回有序集合中指定成员（索引）。</li>
<li><code>ZRANGE key start stop [WITHSCORES]</code>：通过索引区间返回有序集合成员指定区间内的成员（低到高）。</li>
<li><code>ZREVRANGE key start stop[WITHSCORES]</code>：返回有序集合中指定区间内的成员，通过索引，分数从高到低。</li>
<li><code>ZREVRANGEBYSCORE key max min [WITHSCORES]</code>：返回有序集中指定分数区间内的成员，分数从高到低排序。</li>
<li><code>ZREVRANK key member</code>：返回有序集合中指定成员的排名，有序集成员按分数值递减(从大到小)排序。</li>
<li><code>ZSCORE key member</code>：返回有序集中，成员的分数值。</li>
<li><code>ZSCAN key cursor [MATCH pattern] [COUNT count]</code>:迭代有序集合中的元素（包括元素成员和元素分值）。</li>
<li><code>ZLEXCOUNT key min max</code>：在有序集合中计算指定字典区间内成员数量。</li>
<li><code>ZRANGEBYLEX key min max [LIMIT offset count]</code>：通过字典区间返回有序集合的成员。</li>
<li><code>ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT]</code>：通过分数返回有序集合指定区间内的成员。</li>
</ul>
</blockquote>
</li>
<li>删除语法<blockquote>
<ul>
<li><code>del key</code>：移除集合</li>
<li><code>ZREM key member [member2]</code>：移除有序集合中的一个或多个成员。</li>
<li><code>ZREMRANGEBYLEX key min max</code>：移除有序集合中给定的字典区间的所有成员。</li>
<li><code>ZREMRANGEBYRANK key start stop</code>：移除有序集合中给定的排名区间的所有成员(第一名为0)（低到高）。</li>
<li><code>ZREMRANGEBYSCORE key min max</code>：移除有序集合中给定的分数区间的所有成员。</li>
</ul>
</blockquote>
</li>
<li>并集语法<blockquote>
<ul>
<li><code>ZUNIONSTORE destination numkeys key [key ...]</code>：计算给定的一个或多个有序集的并集，并存储在新的 key 中</li>
</ul>
</blockquote>
</li>
<li>交集语法<blockquote>
<ul>
<li><code>ZINTERSTORE destination numkeys key [key ...]</code>：计算给定的一个或多个有序集的交集并将结果集存储在新的有序集合 key 中。</li>
</ul>
</blockquote>
</li>
<li>增量语法<blockquote>
<ul>
<li><code>ZINCRBY key increment member</code> ：有序集合中对指定成员的分数加上增量 increment。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>应用场景<blockquote>
<ul>
<li>常应用于：排行榜。</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="HyperLogLog类型"><a href="#HyperLogLog类型" class="headerlink" title="HyperLogLog类型"></a><code>HyperLogLog</code>类型</h2><ul>
<li>Redis 在 2.8.9 版本添加了 HyperLogLog 结构。</li>
<li>Redis HyperLogLog 是用来做基数统计的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定 的、并且是很小的。</li>
<li>在 Redis 里面，每个 HyperLogLog 键只需要花费 12 KB 内存，就可以计算接近 2^64 个不同元素的基 数。这和计算基数时，元素越多耗费内存就越多的集合形成鲜明对比。</li>
<li>但是，因为 HyperLogLog 只会根据输入元素来计算基数，而不会储存输入元素本身，所以 HyperLogLog 不能像集合那样，返回输入的各个元素。</li>
<li>什么是基数<blockquote>
<p>比如数据集 {1, 3, 5, 7, 5, 7, 8}， 那么这个数据集的基数集为 {1, 3, 5 ,7, 8}, 基数(不重复元素)为5。 基数估计就是在误差可接受的范围内，快速计算基数。</p>
</blockquote>
</li>
<li>命令<blockquote>
<ul>
<li>赋值语法<blockquote>
<ul>
<li><code>PFADD key element [element ...]</code>：添加指定元素到 HyperLogLog 中。</li>
</ul>
</blockquote>
</li>
<li>取值语法<blockquote>
<ul>
<li><code>PFCOUNT key [key ...]</code>：返回给定 HyperLogLog 的基数估算值。</li>
</ul>
</blockquote>
</li>
<li>合并语法<blockquote>
<ul>
<li><code>PFMERGE destkey sourcekey [sourcekey ...]</code>：将多个HyperLogLog合并为一个HyperLogLog。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Redis发布订阅"><a href="#Redis发布订阅" class="headerlink" title="Redis发布订阅"></a><code>Redis</code>发布订阅</h2><ul>
<li>简介：<ul>
<li>Redis发布订阅（pub/sub）是一种消息通信模式：发布者（pub）发布信息，订阅者（sub）接收信息。</li>
<li>Redis客户端可以订阅任意数量的频道。</li>
</ul>
</li>
<li>Redis 发布订阅命令<blockquote>
<ul>
<li>订阅频道<blockquote>
<ul>
<li><code>SUBSCRIBE channel [channel ...]</code>：订阅给定的一个或多个频道的信息。</li>
<li><code>PSUBSCRIBE pattern [pattern ...]</code>：订阅一个或多个符合给定模式的频道。</li>
</ul>
</blockquote>
</li>
<li>发布频道<blockquote>
<ul>
<li><code>PUBLISH channel message</code>：将信息发送到指定的频道。</li>
</ul>
</blockquote>
</li>
<li>退订频道<blockquote>
<ul>
<li><code>UNSUBSCRIBE [channel [channel ...]]</code>：指退订给定的频道。</li>
<li><code>PUNSUBSCRIBE [pattern [pattern ...]]</code>：退订所有给定模式的频道。</li>
</ul>
</blockquote>
</li>
<li>其他<blockquote>
<ul>
<li><code>PUBSUB subcommand [argument [argument ...]]</code>：查看订阅与发布系统状态。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>应用场景<blockquote>
<p>构建实时消息系统，比如普通的即时聊天，群聊等功能。</p>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Redis多数据库名称"><a href="#Redis多数据库名称" class="headerlink" title="Redis多数据库名称"></a><code>Redis</code>多数据库名称</h2><ul>
<li>简介<blockquote>
<ul>
<li><code>Redis</code>下，数据库是由一个整数索引标识，而不是由一个数据库名称。默认情况下，一个客户端连接到数据库0。</li>
<li><code>Redis</code>配置文件中下面的参数来控制数据库总数。<code>database 16(从0开始,1,2,3...15)</code></li>
</ul>
</blockquote>
</li>
<li>命令<blockquote>
<ul>
<li><code>select 数据库</code>：数据库切换。</li>
<li><code>move key名称 数据库</code>：将当前key移动另一库。</li>
<li><code>flushdb</code>：清除当前数据库所有的key。</li>
<li><code>flushall</code>：清除整个Redis的数据库所有key。</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Redis事务"><a href="#Redis事务" class="headerlink" title="Redis事务"></a><code>Redis</code>事务</h2><ul>
<li>简介<blockquote>
<ul>
<li>Redis 事务可以一次执行多个命令， 并且带有以下三个重要的保证：<blockquote>
<ul>
<li>批量操作在发送 EXEC 命令前被放入队列缓存。</li>
<li>收到 EXEC 命令后进入事务执行，事务中任意命令执行失败，其余的命令依然被执行。.</li>
<li>在事务执行过程，其他客户端提交的命令请求不会插入到事务执行命令序列中。</li>
</ul>
</blockquote>
</li>
<li>一个事务从开始到执行会经历以下三个阶段：<blockquote>
<ul>
<li>开始事务</li>
<li>命令入队</li>
<li>执行事务</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
</ul>
<h2 id><a href="#" class="headerlink" title></a><img src="https://i.loli.net/2019/11/24/FjEtpJTG7ebYIg2.png" alt="1574566543_1_.png"></h2><h2 id="Redis脚本"><a href="#Redis脚本" class="headerlink" title="Redis脚本"></a>Redis脚本</h2><ul>
<li>简介：<blockquote>
<ul>
<li>Redis脚本使用<code>Lua</code>解释器来执行脚本。Redis2.6版本通过内嵌支持Lua环境。执行脚本的命令为<code>EVAL</code>。</li>
</ul>
</blockquote>
</li>
<li>命令</li>
</ul>
<h2 id="-1"><a href="#-1" class="headerlink" title></a><img src="https://i.loli.net/2019/11/24/vz4SUXentQ2pONf.png" alt="1574586120_1_.png"></h2><h2 id="Redis连接"><a href="#Redis连接" class="headerlink" title="Redis连接"></a>Redis连接</h2><ul>
<li>redis连接命令主要用于连接redis服务</li>
<li>Redis连接命令<blockquote>
<ul>
<li><code>AUTH password</code>：检验密码是否正确</li>
<li><code>ECHO message</code>：打印字符串。</li>
<li><code>PING</code>：查看服务是否运行。</li>
<li><code>QUIT</code>：关闭当前连接。</li>
<li><code>SELECT index</code>：切换到指定的数据库。</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Redis持久化"><a href="#Redis持久化" class="headerlink" title="Redis持久化"></a>Redis持久化</h2><ul>
<li>简介<blockquote>
<ul>
<li>数据存放于：<blockquote>
<ul>
<li>内存：高效、断电内存会丢失。</li>
<li>硬盘：读写速度慢于内存，断电数据不会丢失。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>持久化方案<blockquote>
<ul>
<li>RDB</li>
<li>AOF</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Redis缓存与数据库一致性"><a href="#Redis缓存与数据库一致性" class="headerlink" title="Redis缓存与数据库一致性"></a><code>Redis</code>缓存与数据库一致性</h2><ul>
<li>解决方案<blockquote>
<ul>
<li>实现同步</li>
<li>异步队列</li>
<li>主从复制</li>
<li>采用UDF自定义函数的方式(触发器)</li>
<li>Lua实现</li>
<li>定时更新</li>
</ul>
</blockquote>
</li>
<li>缓存穿透</li>
<li>缓存雪崩</li>
<li>缓存击穿</li>
</ul>
<hr>
<h2 id="Redis高级"><a href="#Redis高级" class="headerlink" title="Redis高级"></a>Redis高级</h2><ul>
<li><p>高可用（一致都能用）0：通常描述一个系统经过专门的设计，从而减少停工时间，而保持其服务的高度可用性。</p>
</li>
<li><p>该并发：高并发式是互联网分布式系统架构设计中必须考虑的因素之一，他通常是指，通过设计保证系统能够同时并行处理很多请求。</p>
<blockquote>
<ul>
<li>高并发相关常用的一些指标有响应时间，吞吐量，每秒查询率（QPS）,并发用户数等。</li>
<li>响应时间：系统对请求做出响应的时间。例如系统处理一个HTTP请求需要200ms，这个200ms就是系统的响应时间。</li>
<li>吞吐量：单位时间内处理的请求数量。</li>
<li>QPS：每秒响应请求数。在互联网领域中，这个指标和吞吐量区分的没有这么明显。</li>
<li>并发用户数：同时承载正常使用系统功能的用户数量。 </li>
</ul>
</blockquote>
</li>
<li><p>提升系统的并发能力</p>
<blockquote>
<ul>
<li>垂直扩展</li>
<li>水平扩展</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Redis主从复制"><a href="#Redis主从复制" class="headerlink" title="Redis主从复制"></a>Redis主从复制</h2><ul>
<li>应用场景:多读少写</li>
</ul>
<hr>
<h2 id="Redis-Cluster集群"><a href="#Redis-Cluster集群" class="headerlink" title="Redis Cluster集群"></a><code>Redis Cluster</code>集群</h2><ul>
<li>简介：<blockquote>
<ul>
<li>为什么使用<code>redis-cluster</code>？</li>
<li>为了大流量访问下提供稳定的业务，集群化是存储的必然形态。</li>
<li>未来的发展趋势肯定是云计算和大数据紧密结合。</li>
<li>只有分布式架构满足需求。</li>
</ul>
</blockquote>
</li>
<li>Redis集群的搭建方案<blockquote>
<ul>
<li>Twitter开发的twemproxy</li>
<li>豌豆荚开发的codis</li>
<li>redis官方的redis-cluster</li>
</ul>
</blockquote>
</li>
<li><code>redis-cluster</code>特点</li>
<li><code>redis cluster</code>容错性</li>
</ul>
<hr>
<h2 id="Redis-Cluster集群搭建"><a href="#Redis-Cluster集群搭建" class="headerlink" title="Redis Cluster集群搭建"></a><code>Redis Cluster</code>集群搭建</h2><ul>
<li>简介：<blockquote>
<p>集群中至少应该有奇数个节点，所以搭建集群最少需要3台主机(master)。同时每个节点至少有一个备份节点（slaver），所以下面最少需要6台机器，才能完成Redis-Cluster集群（主节点，备节点由redis-cluster集群确定）</p>
</blockquote>
</li>
<li>真集群：准备6台机器</li>
<li>假集群：一台服务器存在6个redis服务。</li>
<li>搭建流程<blockquote>
<ul>
<li>创建<code>Redis</code>节点安装目录，<code>mkdir /usr/local/redis_cluster</code> //指定目录下 创建redis_cluster</li>
<li>在<code>redis_cluster</code>目录下，创建7001-7006个文件夹下，<code>mkdir 7001 7002 7003 7004 7005 7006</code></li>
<li>并将redis-conf分别拷贝到7001-7006文件夹下：<code>cp /root/redis-4.0.1/redis.conf ./7001</code></li>
<li>分别修改如下配置文件，修改如下内容：<blockquote>
<ul>
<li>同时<code>protected-mode</code>是为了禁止公网访问redis cache，加强了redis的安全性。</li>
<li>没有bind IP</li>
<li>没有设置访问密码</li>
<li>由于Linux上的redis处于安全保护模式，这就让你无法从虚拟机外部去轻松建立连接。</li>
<li>如果外部访问：redis.conf中设置保护模式：protected-mode yes </li>
<li>bind 127.0.0.1// 注释掉</li>
<li>port 7000 //绑定端口，必须修改，以此来区分Redis实例</li>
<li>daemonize yes//后台运行</li>
<li>pidfile /var/run/redis-7001.pid//修改pid进行文件名，以端口号命名</li>
<li>cluster-enabled yes//启用集群</li>
<li>cluster-config-file nodes-7000.conf //配置每个节点的配置文件，同样以端口为名称</li>
<li>cluster-node-timeout 15000 //配置集群的超时时间，可改可不改</li>
<li>appendonly yes://启动AOF增量持久化策略</li>
<li>appendfsync always//发生改变就记录日志</li>
</ul>
</blockquote>
</li>
<li>把redis/src/的文件拷贝到7001-7006目录下 cp -r ./src /usr/local/redis_cluster/7001</li>
<li>分别启动redis-server</li>
</ul>
</blockquote>
</li>
<li>创建集群<blockquote>
<ul>
<li>Redis官方提供了redis-trib.rb这个工具，就在解压目录下的src目录中（为了方便操作），将其文件复制到/usr//local/bin目录下，可直接访问此命令:<code>cd redis-4.0.1/</code>、<code>cd src</code>、<code>cp redis-trib.rb /usr/local/bin/</code></li>
<li>可以直接在命令中执行：ip:port格式<code>redis-trib.rb create --replicas 1 127.0.0.1:7001 ...</code> </li>
<li>如果出现下面此错误：则需要安装ruby，这个工具是用ruby实现的。</li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/r5NAg4F9Mikn1oj.png" alt="1574817437_1_.png"> </p>
<ul>
<li>安装ruby<blockquote>
<ul>
<li><code>yum -y install ruby ruby-devel rubygems rpm-build</code></li>
<li><code>gem install redis</code></li>
<li>如下错误原因，centos默认支持ruby到2.0.0，可gem安装redis需要最低是2.2.2</li>
<li>解决办法是：先安装rvm，再把ruby升级</li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/sk3GPXBix9MYUbW.png" alt="1574817822_1_.png"></p>
<ul>
<li><p>安装rvm （出现错误时查看以下一个点）</p>
<blockquote>
<ul>
<li><code>gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3</code></li>
<li><code>curl -sSL https://get.rvm.io | bash -s stable</code></li>
<li><code>find / -name rvm -print</code></li>
<li><code>source /usr/local/rvm/scripts/rvm</code></li>
<li><code>rvm list known</code>//查看rvm库中已知的ruby版本。</li>
</ul>
</blockquote>
</li>
<li><p>安装一个ruby版本</p>
<blockquote>
<ul>
<li><code>rvm install 2.4.4</code></li>
<li><code>rvm use 2.4.4</code>//使用一个ruby版本</li>
<li><code>rvm use 2.4.4 --default</code>//设置默认版本</li>
<li><code>ruby --version</code>//查看ruby版本</li>
<li><code>gem install redis</code>//安装redis</li>
</ul>
</blockquote>
</li>
<li><p>重新执行<code>redis-trib.rb create --replicas 1 127.0.0.1:7001 ...</code>创建集群，结果如下：</p>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/adNWkpr5PLX7jhS.png" alt="1574820682_1_.png"></p>
<ul>
<li>最终结果</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/YH6WpwbCTnctAUu.png" alt="1574820970_1_.png"></p>
<ul>
<li>创建成功。</li>
</ul>
<hr>
<h2 id="Linux-CentOS下通过ruby搭建redis集群"><a href="#Linux-CentOS下通过ruby搭建redis集群" class="headerlink" title="Linux CentOS下通过ruby搭建redis集群"></a>Linux CentOS下通过ruby搭建redis集群</h2><ul>
<li>通过下载安装包<blockquote>
<ul>
<li><code>ruby-2.3.1.tar.gz</code></li>
<li><code>redis-3.3.0.gem</code></li>
</ul>
</blockquote>
</li>
<li>通过wget命令<blockquote>
<ul>
<li><code>wget https://cache.ruby-lang.org/pub/ruby/2.3/ruby-2.3.1.tar.gz</code></li>
<li><code>wget http://rubygems.org/downloads/redis-3.3.0.gem</code></li>
</ul>
</blockquote>
</li>
<li>1跟2都会先出现 zlib包不存在以及openssl不存在的问题，zlib可以通过如下方式解决<blockquote>
<ul>
<li><code>yum -y install zlib-devel</code></li>
<li>进入ruby源码文件夹,安装ruby自身提供的zlib包<blockquote>
<ul>
<li><code>cd ruby-2.3.1/ext/zlib</code></li>
<li><code>ruby ./extconf.rb</code></li>
<li><code>make</code></li>
<li><code>make install</code></li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>通过yum install<blockquote>
<ul>
<li>默认安装的ruby版本低于2.2，无法创建redis集群，可以安装了之后再通过rvm工具升级，还不如直接使用rvm</li>
</ul>
</blockquote>
</li>
<li>通过ruby的版本管理工具rvm<blockquote>
<ul>
<li>4.1:<code>curl -L get.rvm.io | bash -s stable</code></li>
<li><code>yum install -y crul</code>（如果发现curl没有安装，则执行这个之后再执行4.1）</li>
<li>如果遇到<code>CURLE_SSL_CONNECT_ERROR return</code> status(35)的错误，执行<code>yum -y update nss</code>，再重新执行4.1</li>
<li>此时打印信息</li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/oldEYHkaNhJFgwi.png" alt="1574819789_1_.png"></p>
<blockquote>
<ul>
<li>通过以上信息，需要try to install GPG v2再 fetch the public key</li>
<li>因此执行 <code>command curl -sSL https://rvm.io/mpapis.asc | gpg2 --import -</code> 再执行 4.1</li>
</ul>
</blockquote>
<ul>
<li><code>find / -name rvm -print</code></li>
<li><code>source /usr/local/rvm/scripts/rvm</code></li>
<li><code>rvm list known</code></li>
</ul>
<hr>
<h2 id="Redis-cluster集群验证"><a href="#Redis-cluster集群验证" class="headerlink" title="Redis cluster集群验证"></a><code>Redis cluster</code>集群验证</h2><ul>
<li>Redis集群测试<blockquote>
<ul>
<li>为方便测试，可将<code>redis-cli</code>客户端命令放到<code>/usr/local/bin</code>目录下</li>
<li><code>cd /root/redis-4.0.14/src</code> //进入该目录</li>
<li><code>cp redis-cli /usr/local/bin</code></li>
</ul>
</blockquote>
</li>
<li>在某台机器上（或）连接集群的7001端口的节点上：<blockquote>
<ul>
<li><code>redis-cli -h 127.0.0.1 -c -p 7001</code></li>
</ul>
</blockquote>
</li>
<li>查看集群信息<blockquote>
<ul>
<li><code>info replication</code></li>
</ul>
</blockquote>
</li>
<li>查看主从关系<blockquote>
<ul>
<li>输入命令 <code>cluster nodes</code></li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/sVkTmc4ZuMAqEfH.png" alt="1574821797_1_.png"></p>
<p><img src="https://i.loli.net/2019/11/27/uTgBP5xiIEMNK3z.png" alt="1574821814_1_.png"></p>
<ul>
<li><p>主从复制：主做增删改，从做查询功能</p>
</li>
<li><p>外部使用(针对centos6)</p>
<blockquote>
<ul>
<li>开启端口权限，依次开放端口7001 7002…7006 <blockquote>
<ul>
<li><code>vi /etc/sysconfig/iptables</code> </li>
</ul>
</blockquote>
</li>
<li>重启防火墙<blockquote>
<ul>
<li><code>service iptables restart</code></li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
</ul>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/17/数据库系统概述/">数据库系统概述</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-17T11:50:32.000Z" itemprop="datePublished">2019-11-17</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/数据库系统概述/">数据库系统概述</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="第一章-绪论"><a href="#第一章-绪论" class="headerlink" title="第一章 绪论"></a>第一章 绪论</h2><h3 id="数据库系统概述"><a href="#数据库系统概述" class="headerlink" title="数据库系统概述"></a>数据库系统概述</h3><ol>
<li><p>数据库地位</p>
<blockquote>
<ul>
<li>数据库是管理数据的最新技术。</li>
<li>数据库技术是信息系统的核心和基础。</li>
</ul>
</blockquote>
</li>
<li><p>四个基本概念</p>
</li>
</ol>
<blockquote>
<ul>
<li><code>数据(data)</code><blockquote>
<ul>
<li>数据是数据库中存储的基本对象</li>
<li>数据的定义：描述事物的符号记录成为数据。</li>
<li>数据的语义：数据的含义成为数据的语义，数据与其语义是不可分的。</li>
<li>记录是计算机中表示和存储数据的一种格式或一种方法。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><code>数据库(DataBase，DB)</code><blockquote>
<ul>
<li>数据库，顾名思义，就是存储数据的仓库。只不过这个仓库是在计算机存储设备上，而且数据是按照一定的的格式存放的。</li>
<li>数据库的定义：数据库是长期存储在计算机中的、有组织的、可共享的大量的数据的集合。</li>
<li>数据库中的数据按照一定的额数据模型组织，描述和存储，具有较小的冗余度，较高的数据独立性和易扩展性，并可为多用户共享。</li>
<li>概括的讲，数据库数据具有永久存储、有组织和可共享三个基本特点。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><code>数据库管理系统(DataBase Management System，DBMS)</code><blockquote>
<ul>
<li>了解了数据和数据库的基本概念，下一个问题就是如何科学的组织和存储数据，如何高效的获取和恢复数据。完成这个任务的是一个软件–数据库管理系统。</li>
<li>数据库管理系统是位于用户与操作系统之间的一层数据管理软件。数据库管理系统与操作系统一样是计算机的基础软件，也是一个大型复杂的软件系统。</li>
<li>数据库管理的功能:数据定义功能(DDL)、数据组织，存储和管理、数据库的操纵功能、数据库的事务管理和运行管理、数据库的建立和维护功能、其他功能。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><code>数据库系统(DataBase System,DBS)</code><blockquote>
<ul>
<li>数据库系统是由数据库、数据库管理系统、应用程序和数据库管理员<code>(DataBase Administrator,DBA)</code>组成的存储、管理、处理和维护数据的系统。 </li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<p><img src="https://i.loli.net/2019/11/19/hfeGLaSRoBixvwp.png" alt="DBS.png"></p>
<blockquote>
<blockquote>
<ul>
<li>其中，数据库提供数据的存储功能，数据库管理系统提供数据的组织、存取、管理和维护等基础功能，数据库应用系统根据应用需求使用数据库，数据库管理员负责全面管理数据库系统。</li>
</ul>
</blockquote>
</blockquote>
<p><img src="https://i.loli.net/2019/11/19/BOz9LGVM4Z1Nxby.png" alt="层次结构.png"></p>
<blockquote>
<blockquote>
<ul>
<li>在一般不引起混杂的情况下，人们常常把数据库系统简称数据库。</li>
</ul>
</blockquote>
</blockquote>
<h3 id="数据库管理技术的产生和发展"><a href="#数据库管理技术的产生和发展" class="headerlink" title="数据库管理技术的产生和发展"></a>数据库管理技术的产生和发展</h3><ol>
<li>数据库技术是应数据管理任务的需要而产生的。</li>
<li>数据管理：数据管理是指对数据进行分类、组织、编码、存储、检索和维护，它是数据处理的中心问题。</li>
<li>数据处理：数据处理是指对各种数据进行收集、存储、加工和传播的一系列的活动的总和。</li>
<li>在应用需求的推动下，在计算机硬件、软件基础上，数据管理技术经历了人工管理、文件系统、数据库技术三个阶段。这三个阶段的特点如下表所示：</li>
</ol>
<p><img src="https://i.loli.net/2019/11/20/PWB5OjCcolwpfh7.png" alt="DBMS-3.png"></p>
<ol start="5">
<li>人工管理阶段<blockquote>
<ul>
<li>20世纪50年代中期以前，计算机主要用于科学计算。当时的硬件条件是，外存只有纸带、卡片和磁带、没有磁盘等直接存储的设备；软件条件是，没有操作系统，没有管理数据的专门软件;数据处理方式是批处理。</li>
<li>人工管理数据具有如下特点:<blockquote>
<ul>
<li>数据不保存</li>
<li>应用程序管理数据</li>
<li>数据不共享</li>
<li>数据不具备独立性</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
</ol>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/16/HttpClient/">HttpClient</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-16T08:24:20.000Z" itemprop="datePublished">2019-11-16</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/HttpClient/">HttpClient</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="HttpCLient使用步骤"><a href="#HttpCLient使用步骤" class="headerlink" title="HttpCLient使用步骤"></a>HttpCLient使用步骤</h2><p>模拟浏览器调用服务层请求数据.</p>
<h3 id="Get请求"><a href="#Get请求" class="headerlink" title="Get请求"></a>Get请求</h3><ul>
<li><p>实现步骤</p>
<ul>
<li>第一步：把HttpClient使用的jar包添加到工程中。</li>
<li>第二步：创建一个HttpClient的测试类</li>
<li>第三步：创建测试方法。</li>
<li>第四步：创建一个HttpClient对象</li>
<li>第五步：创建一个HttpGet对象，需要制定一个请求的url</li>
<li>第六步：执行请求。</li>
<li>第七步：接收返回结果。HttpEntity对象。</li>
<li>第八步：取响应的内容。</li>
<li>第九步：关闭HttpGet、HttpClient。</li>
</ul>
</li>
<li><p>测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testHttpGet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// 第一步：把HttpClient使用的jar包添加到工程中。</span></span><br><span class="line">    <span class="comment">// 第二步：创建一个HttpClient的测试类</span></span><br><span class="line">    <span class="comment">// 第三步：创建测试方法。</span></span><br><span class="line">    <span class="comment">// 第四步：创建一个HttpClient对象</span></span><br><span class="line">    CloseableHttpClient httpClient = HttpClients.createDefault();</span><br><span class="line">    <span class="comment">// 第五步：创建一个HttpGet对象，需要制定一个请求的url</span></span><br><span class="line">    HttpGet get = <span class="keyword">new</span> HttpGet(<span class="string">"http://www.itheima.com"</span>);</span><br><span class="line">    <span class="comment">// 第六步：执行请求。</span></span><br><span class="line">    CloseableHttpResponse response = httpClient.execute(get);</span><br><span class="line">    <span class="comment">// 第七步：接收返回结果。HttpEntity对象。</span></span><br><span class="line">    HttpEntity entity = response.getEntity();</span><br><span class="line">    <span class="comment">// 第八步：取响应的内容。</span></span><br><span class="line">    String html = EntityUtils.toString(entity);</span><br><span class="line">    System.out.println(html);</span><br><span class="line">    <span class="comment">// 第九步：关闭response、HttpClient。</span></span><br><span class="line">    response.close();</span><br><span class="line">    httpClient.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="Post请求"><a href="#Post请求" class="headerlink" title="Post请求"></a>Post请求</h3><ul>
<li>实现步骤<ul>
<li>第一步：创建一个httpClient对象</li>
<li>第二步：创建一个HttpPost对象。需要指定一个url</li>
<li>第三步：创建一个list模拟表单，list中每个元素是一个NameValuePair对象</li>
<li>第四步：需要把表单包装到Entity对象中。StringEntity</li>
<li>第五步：执行请求。</li>
<li>第六步：接收返回结果</li>
<li>第七步：关闭流。</li>
</ul>
</li>
<li>测试代码<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testHttpPost</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 第一步：创建一个httpClient对象</span></span><br><span class="line">    CloseableHttpClient httpClient = HttpClients.createDefault();</span><br><span class="line">    <span class="comment">// 第二步：创建一个HttpPost对象。需要指定一个url</span></span><br><span class="line">    HttpPost post = <span class="keyword">new</span> HttpPost(<span class="string">"http://localhost:8082/posttest.html"</span>);</span><br><span class="line">    <span class="comment">// 第三步：创建一个list模拟表单，list中每个元素是一个NameValuePair对象</span></span><br><span class="line">    List&lt;NameValuePair&gt; formList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    formList.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string">"name"</span>, <span class="string">"张三"</span>));</span><br><span class="line">    formList.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string">"pass"</span>, <span class="string">"1243"</span>));</span><br><span class="line">    <span class="comment">// 第四步：需要把表单包装到Entity对象中。StringEntity</span></span><br><span class="line">    StringEntity entity = <span class="keyword">new</span> UrlEncodedFormEntity(formList, <span class="string">"utf-8"</span>);</span><br><span class="line">    post.setEntity(entity);</span><br><span class="line">    <span class="comment">// 第五步：执行请求。</span></span><br><span class="line">    CloseableHttpResponse response = httpClient.execute(post);</span><br><span class="line">    <span class="comment">// 第六步：接收返回结果</span></span><br><span class="line">    HttpEntity httpEntity = response.getEntity();</span><br><span class="line">    String result = EntityUtils.toString(httpEntity);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">    <span class="comment">// 第七步：关闭流。</span></span><br><span class="line">    response.close();</span><br><span class="line">    httpClient.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/01/Java框架下载路径/">Java框架下载路径</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-01T11:50:29.000Z" itemprop="datePublished">2019-11-01</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/Java框架下载路径/">Java框架下载路径</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h3 id="Struts框架下载路径"><a href="#Struts框架下载路径" class="headerlink" title="Struts框架下载路径"></a>Struts框架下载路径</h3><ul>
<li><code>https://struts.apache.org/download.cgi#struts2520</code></li>
<li>学习视频：<code>https://www.bilibili.com/video/av31846422/</code><h3 id="Hibernate框架下载路径"><a href="#Hibernate框架下载路径" class="headerlink" title="Hibernate框架下载路径"></a>Hibernate框架下载路径</h3></li>
<li><code>http://hibernate.org/orm/releases/</code></li>
<li>学习视频：<code>https://www.bilibili.com/video/av31842997/</code><h3 id="Mybatis框架下载路径"><a href="#Mybatis框架下载路径" class="headerlink" title="Mybatis框架下载路径"></a>Mybatis框架下载路径</h3></li>
<li><code>https://github.com/mybatis/mybatis-3/releases</code><h3 id="Spring与Mybatis整合的jar包"><a href="#Spring与Mybatis整合的jar包" class="headerlink" title="Spring与Mybatis整合的jar包"></a>Spring与Mybatis整合的jar包</h3><code>https://blog.csdn.net/qiangqiang816/article/details/81541188</code><h3 id="Spring框架下载路径"><a href="#Spring框架下载路径" class="headerlink" title="Spring框架下载路径"></a>Spring框架下载路径</h3></li>
<li><code>https://repo.spring.io/release/org/springframework/spring/</code><h3 id="SpringMVC框架下载路径"><a href="#SpringMVC框架下载路径" class="headerlink" title="SpringMVC框架下载路径"></a>SpringMVC框架下载路径</h3></li>
<li><code>https://repo.spring.io/release/org/springframework/spring/</code></li>
<li>SSM学习视频：<code>https://www.bilibili.com/video/av41334365/</code><h3 id="maven仓库路径"><a href="#maven仓库路径" class="headerlink" title="maven仓库路径"></a>maven仓库路径</h3></li>
<li><code>https://mvnrepository.com/</code><h3 id="Commons-io-Commons-fileupload"><a href="#Commons-io-Commons-fileupload" class="headerlink" title="Commons-io,Commons-fileupload"></a>Commons-io,Commons-fileupload</h3></li>
<li><code>http://commons.apache.org/proper/commons-io/</code></li>
<li><code>http://commons.apache.org/proper/commons-fileupload/</code></li>
</ul>
<h3 id="redis安装"><a href="#redis安装" class="headerlink" title="redis安装"></a>redis安装</h3><ul>
<li>官方网站：<a href="http://redis.io" target="_blank" rel="noopener">http://redis.io</a></li>
</ul>
<h3 id="开发工具连接"><a href="#开发工具连接" class="headerlink" title="开发工具连接"></a>开发工具连接</h3><ul>
<li><code>https://pan.baidu.com/s/1A9VWHJMzow_zD0Pkp0d7jw</code></li>
<li><code>H97F</code><h3 id="项目实战"><a href="#项目实战" class="headerlink" title="项目实战"></a>项目实战</h3></li>
</ul>
<ol>
<li>917-web学生校园在线点餐系统源码ssm实现java+mysql项目源代码</li>
</ol>
<ul>
<li><code>https://pan.baidu.com/s/1mt9pDdOjoqTty-x-Dqm-FA</code></li>
<li>提取码：<code>rd37</code></li>
</ul>
<ol start="2">
<li></li>
</ol>
<ul>
<li>smm项目链接：<code>https://pan.baidu.com/s/185P0EwiVzr5M_d182PPmkA</code></li>
<li>提取码：<code>pvjc</code></li>
<li>springmvc+Mybatis链接：<code>https://pan.baidu.com/s/1CYIpdJhHzZjlSOOHBuak1g</code></li>
<li>提取码：<code>4gp2</code></li>
</ul>
<h3 id="lucene-solr"><a href="#lucene-solr" class="headerlink" title="lucene+solr"></a>lucene+solr</h3><ul>
<li>lucene+solr视频教程（四套）：</li>
<li><code>https://pan.baidu.com/s/10so9BJhlNj_bbRX7IBO2Pw</code>：<code>提取码: 74ew</code></li>
</ul>
<h3 id="elasticsearch"><a href="#elasticsearch" class="headerlink" title="elasticsearch"></a>elasticsearch</h3><ul>
<li>elasticsearch教程（三套）：</li>
<li>链接：<code>https://pan.baidu.com/s/1t0VLlWaZxLM5SHlnqVl15g</code>:<code>提取码：q4fg</code></li>
</ul>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/01/SSM框架整合-配置文件/">SSM框架整合-配置文件</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-01T11:49:43.000Z" itemprop="datePublished">2019-11-01</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/SSM框架整合-配置文件/">SSM框架整合-配置文件</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="Web-xml配置文件"><a href="#Web-xml配置文件" class="headerlink" title="Web.xml配置文件"></a>Web.xml配置文件</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span> <span class="attr">version</span>=<span class="string">"3.0"</span>&gt;</span></span><br><span class="line"> 	<span class="comment">&lt;!-- 配置上下文参数 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- SpringMVC前端控制器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 字符编码过滤器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Spring框架的常用配置"><a href="#Spring框架的常用配置" class="headerlink" title="Spring框架的常用配置"></a>Spring框架的常用配置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">default-autowire</span>=<span class="string">"byName"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 扫描注解 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib.service.impl"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 加载属性文件 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:db.properties"</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 数据源 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- SqlSessionFactory --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"factory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeAliasesPackage"</span> <span class="attr">value</span>=<span class="string">"com.gdaib.pojo"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 扫描器 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.gdaib.mapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactoryBeanName"</span> <span class="attr">value</span>=<span class="string">"factory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 事务管理器 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"txManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 声明式事务 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"txManager"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"ins*"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"del*"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"upd*"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"*"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 配置AOP --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.gdaib.service.impl.*.*(..))"</span> <span class="attr">id</span>=<span class="string">"mypoint"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"mypoint"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="SpringMVC的常用配置"><a href="#SpringMVC的常用配置" class="headerlink" title="SpringMVC的常用配置"></a>SpringMVC的常用配置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 扫描注解 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib.controller"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 注解确定， 注册HandlerMapping和HandlerAdapter--&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 设置静态 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/js/"</span> <span class="attr">mapping</span>=<span class="string">"/js/**"</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:resources</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/css/"</span> <span class="attr">mapping</span>=<span class="string">"/css/**"</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:resources</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/images/"</span> <span class="attr">mapping</span>=<span class="string">"/images/**"</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:resources</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 视图解析器 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"viewResource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">      		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">"*.jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="资源文件常用配置"><a href="#资源文件常用配置" class="headerlink" title="资源文件常用配置"></a>资源文件常用配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jdbc.driver=com.mysql.cj.jdbc.Driver</span><br><span class="line">jdbc.url=jdbc:mysql://localhost:3306/ssm?serverTimezone=UTC&amp;characterEncoding=utf8</span><br><span class="line">jdbc.password=123456</span><br><span class="line">jdbc.username=root</span><br></pre></td></tr></table></figure>
        
    </section>
</article>




<nav class="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/CPWS.github.io/categories/back-end/page/2/">2</a><a class="page-number" href="/CPWS.github.io/categories/back-end/page/3/">3</a><a class="extend next" rel="next" href="/CPWS.github.io/categories/back-end/page/2/">Next &raquo;</a>
</nav>



            </div>
        </div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?e4027971a230b210f4671f485b33846a";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
</footer>

    </main>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }

            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle();
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp();
            }, 3000);
        }
    });
    </script>
    

</body>
</html>
