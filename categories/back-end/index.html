<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">

    

    

    <title>Category: back-end | Prossible&#39;s Blog</title>
    <meta name="author" content="zhuli">
    <meta name="keywords" content>
    <meta name="description" content>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">

    
    <link rel="alternate" href="https://sanonz.github.io/atom.xml" title="Prossible&#39;s Blog" type="application/atom+xml">
    
    
    <link rel="icon" href="https://cpws.github.io/images/favicon.ico">
    

    <style type="text/css">
    @font-face {
        font-family: 'icomoon';
        src: url("/CPWS.github.io/fonts/icomoon.eot?q628ml");
        src: url("/CPWS.github.io/fonts/icomoon.eot?q628ml#iefix") format('embedded-opentype'),
             url("/CPWS.github.io/fonts/icomoon.ttf?q628ml") format('truetype'),
             url("/CPWS.github.io/fonts/icomoon.woff?q628ml") format('woff'),
             url("/CPWS.github.io/fonts/icomoon.svg?q628ml#icomoon") format('svg');
        font-weight: normal;
        font-style: normal;
    }
    </style>
    <link rel="stylesheet" href="/CPWS.github.io/css/style.css">

    <!--[if lt IE 9]>
    <style type="text/css">
    .nav-inner {top:0;}
    .author-meta {position:static;top:0;}
    .search-form {height:36px;}
    </style>
    <script type="text/javascript" src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
    <![endif]-->
</head>
<body>

    <main class="app">
        <header id="header" class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">Prossible&#39;s Blog</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item" href="/CPWS.github.io/">
                <span class="nav-text">首页</span>
            </a>
        
            <a class="nav-item" href="/CPWS.github.io/categories/front-end">
                <span class="nav-text">前端</span>
            </a>
        
            <a class="nav-item active" href="/CPWS.github.io/categories/back-end">
                <span class="nav-text">后端</span>
            </a>
        
            <a class="nav-item" href="/CPWS.github.io/tags">
                <span class="nav-text">标签</span>
            </a>
        
            <a class="nav-item" href="/CPWS.github.io/archives">
                <span class="nav-text">归档</span>
            </a>
        
            <a class="nav-item" href="https://sanonz.github.io/atom.xml">
                <span class="nav-text">订阅</span>
            </a>
        
            <a class="nav-item" href="/CPWS.github.io/about">
                <span class="nav-text">关于</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="https://CPWS.github.io"></form>

        
        

        
        <div class="author-meta">
            
            <div class="author-avatar">
                <a href="/CPWS.github.io/">
                    <img src="http://img.mp.itc.cn/q_mini,c_zoom,w_640/upload/20161221/c495640d0fc24a91b9c95dc0d54b6002_th.jpeg" title="ZHUCHULI">
                </a>
            </div>
            
            <div class="author-name">ZHUCHULI</div>
            <div class="author-work">Web Developer &amp; Designer</div>
            <div class="author-location">
                <i class="icon-location vm"></i>
                <span class="vm">GuangZhou, China</span>
            </div>
            
            <div class="author-thread-wrap">
                <div class="author-threads clearfix">
                    
                        <a class="thread-item" href="https://github.com/CPWS" target="_blank" rel="noopener">
                            <!-- Generated by IcoMoon.io -->
<svg viewbox="0 0 1024 1024" width="38" height="38" fill="currentColor">
<path d="M512 32.12c-265.004 0-479.88 220.23-479.88 492.090 0 217.446 137.536 401.684 328.202 466.81 23.994 4.498 32.778-10.712 32.778-23.78 0-11.782-0.428-42.632-0.642-83.764-133.466 29.778-161.744-65.984-161.744-65.984-21.852-56.772-53.344-71.982-53.344-71.982-43.49-30.636 3.214-29.992 3.214-29.992 48.202 3.428 73.482 50.772 73.482 50.772 42.846 75.196 112.258 53.558 139.68 40.918 4.284-31.706 16.71-53.558 30.42-65.77-106.474-12.426-218.516-54.63-218.516-243.152 0-53.772 18.638-97.69 49.274-131.966-4.928-12.426-21.424-62.556 4.714-130.252 0 0 40.276-13.282 131.966 50.344 38.348-10.926 79.266-16.282 120.184-16.496 40.704 0.214 81.836 5.57 120.184 16.496 91.692-63.626 131.752-50.344 131.752-50.344 26.136 67.698 9.64 117.828 4.714 130.252 30.636 34.492 49.274 78.408 49.274 131.966 0 188.952-112.258 230.514-219.16 242.724 17.138 15.21 32.564 45.202 32.564 91.048 0 65.77-0.642 118.898-0.642 134.966 0 13.068 8.57 28.492 32.992 23.566 191.094-64.912 328.418-249.152 328.418-466.382 0-271.86-214.874-492.090-479.88-492.090z"/>
</svg>

                        </a>
                    
                        <a class="thread-item" href="http://weibo.com/sanonz" target="_blank" rel="noopener">
                            <!-- Generated by IcoMoon.io -->
<svg viewbox="0 0 1024 1024" width="38" height="38" fill="currentColor">
<path d="M21.332 512c0-270.988 219.68-490.666 490.668-490.666s490.666 219.68 490.666 490.666c0 270.988-219.678 490.666-490.666 490.666s-490.666-219.678-490.666-490.666zM960 512c0-247.424-200.576-448-448-448s-448 200.576-448 448c0 247.424 200.576 448 448 448s448-200.576 448-448zM768 597.332c47.128 0 85.332-38.206 85.332-85.332s-38.206-85.332-85.332-85.332c-47.128 0-85.332 38.204-85.332 85.332s38.206 85.332 85.332 85.332zM512 597.332c47.128 0 85.332-38.206 85.332-85.332s-38.206-85.332-85.332-85.332c-47.128 0-85.332 38.204-85.332 85.332s38.204 85.332 85.332 85.332zM255.998 597.332c47.128 0 85.332-38.206 85.332-85.332s-38.204-85.332-85.332-85.332c-47.128 0-85.332 38.204-85.332 85.332s38.204 85.332 85.332 85.332z"/>
</svg>

                        </a>
                    
                        <a class="thread-item" href="https://twitter.com/sanonze" target="_blank" rel="noopener">
                            <!-- Generated by IcoMoon.io -->
<svg viewbox="0 0 1024 1024" width="38" height="38" fill="currentColor">
<path d="M512.029 31.011c-263.32 0-476.784 213.502-476.784 476.784 0 263.32 213.464 476.743 476.784 476.743s476.743-213.424 476.743-476.743c0-263.282-213.444-476.784-476.743-476.784zM752.193 411.663c0.251 5.151 0.349 10.319 0.349 15.548 0 158.786-120.856 341.85-341.85 341.85-67.844 0-131.021-19.884-184.188-53.961 9.41 1.104 18.955 1.665 28.656 1.665 56.305 0 108.115-19.208 149.221-51.425-52.567-0.987-96.925-35.741-112.22-83.468 7.32 1.433 14.85 2.149 22.595 2.149 10.959 0 21.569-1.433 31.656-4.201-54.987-11.035-96.402-59.634-96.402-117.796 0-0.524 0-1.025 0.020-1.549 16.186 9.003 34.716 14.404 54.427 15.044-32.258-21.587-53.458-58.317-53.458-100.023 0-22.015 5.925-42.673 16.264-60.408 59.266 72.683 147.807 120.527 247.676 125.521-2.053-8.77-3.118-17.968-3.118-27.378 0-66.333 53.787-120.14 120.158-120.14 34.561 0 65.771 14.599 87.69 37.93 27.378-5.363 53.091-15.393 76.305-29.16-9.003 28.074-28.036 51.618-52.858 66.47 24.338-2.903 47.495-9.37 69.024-18.917-16.070 24.144-36.459 45.306-59.945 62.248z"/>
</svg>

                        </a>
                    
                </div>
            </div>
            
        </div>
        
    </div>
</aside>

</header>

        <div id="content" class="content">
            <div id="wrapper" class="wrapper" style="max-width: 800px">
                
    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/12/28/springdata/">springdata</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-12-28T00:47:10.000Z" itemprop="datePublished">2019-12-28</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/springdata/">springdata</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="SpringData内容介绍"><a href="#SpringData内容介绍" class="headerlink" title="SpringData内容介绍"></a><code>SpringData</code>内容介绍</h2><p><strong><code>Spring</code>整合<code>Hibernate</code></strong></p>
<ol>
<li>Spring整合Hibernate步骤</li>
<li>Hibernate添加、修改、删除操作</li>
<li>Hibernate-HQL查询</li>
<li>Hibernate-SQL查询</li>
<li>Hibernate-QBC查询</li>
</ol>
<p><strong><code>Spring</code>整合<code>Hibernate</code>基于<code>JPA</code>规范</strong></p>
<ol>
<li>Spring整合Hibernate JPA规范</li>
<li>Hibernate JPA中的CRUD操作</li>
<li>Hibernate JPA中的HQL查询</li>
<li>Hibernate JPA中的SQL查询</li>
<li>Hibernate JPA中的QBC查询</li>
</ol>
<p><strong><code>Spring Data JPA</code></strong></p>
<ol>
<li><p>Spring Data JPA 初级</p>
<ol>
<li>Spring Data JPA介绍</li>
<li>Spring Data整合JPA</li>
<li>Spring Data JPA核心与继承结构</li>
<li>Spring Data JPA源码分析</li>
</ol>
</li>
<li><p>Spring Data JPA接口详解</p>
<ol>
<li>Repository接口-方法命名规则查询</li>
<li>Repository接口-@Query注解查询</li>
<li>Repository接口-@Query注解跟新操作</li>
<li>CrudRepository接口讲解</li>
<li>PagingAndSortingRepository接口讲解</li>
<li>JpaRepository接口讲解</li>
<li>JpaspecificationExecutor接口讲解</li>
<li>自定义Repository接口</li>
</ol>
</li>
<li><p>Spring Data JPA关联关系查询</p>
<ol>
<li>Spring Data JPA一对一关联关系查询</li>
<li>Spring Data JPA一对多关联关系查询</li>
<li>Spring Data JPA多对多关联关系查询</li>
</ol>
</li>
</ol>
<p><strong><code>Spring Data Redis</code></strong></p>
<ol>
<li>Redis安装</li>
<li>Spring Data Redis整合Redis</li>
<li>Spring Data Redis序列化器使用</li>
</ol>
<p>课程中使用到的工具</p>
<ol>
<li>JDK1.7.0_72 </li>
<li>Eclipse Mars</li>
<li>Hibernate:5.0.7Final</li>
<li>Spring 4.2.0RELEASE</li>
<li>Spring Data JPA：1.9.0RELEASE</li>
<li>Spring Data Redis：1.6.0RELEASE</li>
</ol>
<p>课程技术要求</p>
<ul>
<li>需要对<code>Spring</code>、<code>Hibernate</code>、<code>Redis</code>技术有一定的了解</li>
</ul>
<h2 id="课程技术介绍"><a href="#课程技术介绍" class="headerlink" title="课程技术介绍"></a>课程技术介绍</h2><p><strong>Hibernate</strong></p>
<ul>
<li>Hibernate是一个开放源代码的对象关系映射框架，它对JDBC进行了非常轻量级的对象封装，它将POJO与数据库表建立映射关系，是一个全自动的orm框架，hibernate可以自动生成SQL语句，自动执行，使得Java程序员可以随心所欲的使用对象编程思维来操纵数据库。 Hibernate可以应用在任何使用JDBC的场合，既可以在Java的客户端程序使用，也可以在Servlet/JSP的Web应用中使用，最具革命意义的是，Hibernate可以在应用EJB的JaveEE架构中取代CMP，完成数据持久化的重任。</li>
</ul>
<p><strong>JPA标准</strong></p>
<ul>
<li>JPA是Java Persistence API的简称，中文名Java持久层API，是JDK 5.0注解或XML描述对象－关系表的映射关系，并将运行期的实体对象持久化到数据库中。 [1] </li>
<li>Sun引入新的JPA ORM规范出于两个原因：其一，简化现有Java EE和Java SE应用开发工作；其二，Sun希望整合ORM技术，实现天下归一。</li>
</ul>
<p><strong>Hibernate JPA</strong></p>
<ul>
<li>Hibernate在3.2以后根据JPA规范提供了一套操作持久层的API</li>
</ul>
<p><strong>Spring Data</strong></p>
<ul>
<li>Spring Data’s mission is to provide a familiar and consistent, Spring-based programming model for data access while still retaining the special traits of the underlying data store.</li>
</ul>
<p><strong>Spring Data JPA</strong></p>
<ul>
<li>Spring Data JPA, part of the larger Spring Data family, makes it easy to easily implement JPA based repositories. This module deals with enhanced support for JPA based data access layers. It makes it easier to build Spring-powered applications that use data access technologies.</li>
<li>Spring Data JPA底层默认使用Hibernate来做JPA实现。</li>
</ul>
<p><strong>Spring Data Redis</strong></p>
<ul>
<li>Spring Data Redis, part of the larger Spring Data family, provides easy configuration and access to Redis from Spring applications. It offers both low-level and high-level abstractions for interacting with the store, freeing the user from infrastructural concerns.</li>
</ul>
<h2 id="SpringData第一章-Spring整合Hibernate"><a href="#SpringData第一章-Spring整合Hibernate" class="headerlink" title="SpringData第一章 Spring整合Hibernate"></a>SpringData第一章 Spring整合Hibernate</h2><p><strong>创建项目</strong></p>
<ol>
<li><p>导入jar包</p>
<ul>
<li>Hibernate</li>
<li>Hibernate C3P0</li>
<li>spring-ioc、spring-aop、spring-jdbc、spring-orm、spring-test</li>
<li>commons-logging-1.1.1</li>
<li>mysql驱动包</li>
<li>单元测试：junit4</li>
</ul>
</li>
</ol>
<p><img src="https://i.loli.net/2019/12/28/uvY6kPX5Wh3risV.png" alt="1577500768_1_.png"></p>
<ol start="2">
<li>创建Spring的配置文件<strong>applicationContext.xml</strong>,存放在src目录下</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong><code>Spring</code> 整合 <code>Hibernate</code> 配置文件：applicationContext.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">     	</span><br><span class="line">     	<span class="comment">&lt;!-- 配置读取properties文件的工具类 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:jdbc.properties"</span>/&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置C3P0数据库连接池 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置Hibernate的SessionFactory --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate5.LocalSessionFactoryBean"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="comment">&lt;!-- Hibernate Properties属性：配置与Hibernate相关的内容，如显示sql语句，开启正向工程 --&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 显示当前执行的sql语句 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 开启正向工程 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                     <span class="comment">&lt;!-- mysql数据库方言 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQL5InnoDBDialect<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 指定采用的是数据库连接池 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.temp.use_jdbc_metadata_defaults"</span>&gt;</span>false<span class="tag">&lt;/<span class="name">prop</span>&gt;</span>  </span><br><span class="line">     			<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="comment">&lt;!-- 扫描实体所在的包 --&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"packagesToScan"</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">value</span>&gt;</span>com.gdaib.pojo<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置Hibernate的事务管理器 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate5.HibernateTransactionManager"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sessionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置开启注解事务处理 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">tx:annotation-driven</span>  <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置Spring IOC的注解扫描--&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>Hibernate完成CRUD操作</strong></p>
<ol>
<li>mysql下创建test数据库</li>
<li>在com.gdaib.pojo包下创建一个实体类：Users.java</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"t_users"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Users</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//GenerationType.IDENTITY：id自增长</span></span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">	<span class="meta">@Column</span>(name=<span class="string">"userid"</span>)</span><br><span class="line">	<span class="keyword">private</span> Integer userid;</span><br><span class="line">	<span class="meta">@Column</span>(name=<span class="string">"username"</span>)</span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="meta">@Column</span>(name=<span class="string">"userage"</span>)</span><br><span class="line">	<span class="keyword">private</span> Integer userage;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getUserid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userid;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserid</span><span class="params">(Integer userid)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.userid = userid;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> username;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.username = username;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getUserage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userage;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserage</span><span class="params">(Integer userage)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.userage = userage;</span><br><span class="line">	&#125;	</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>编写UsersDao接口和实现类</p>
<ul>
<li>修改配置文件，添加HibernateTemplate的配置</li>
</ul>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置HibernateTemplate对象 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"hibernateTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate5.HibernateTemplate"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sessionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>接口实现类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.hibernate5.HibernateTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.dao.UsersDao;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.pojo.Users;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UsersDaoImpl</span> <span class="keyword">implements</span> <span class="title">UsersDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> HibernateTemplate hibernateTemplate;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUsers</span><span class="params">(Users users)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">this</span>.hibernateTemplate.save(users);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUsers</span><span class="params">(Users users)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">this</span>.hibernateTemplate.update(users);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUsers</span><span class="params">(Users users)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">this</span>.hibernateTemplate.delete(users);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Users <span class="title">selectUsersById</span><span class="params">(Integer userid)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.hibernateTemplate.get(Users.class, userid);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>编写测试代码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.annotation.Rollback;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.dao.UsersDao;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.pojo.Users;</span><br><span class="line"></span><br><span class="line"><span class="comment">//spring整合junit</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</span><br><span class="line"><span class="meta">@ContextConfiguration</span>(<span class="string">"classpath:applicationContext.xml"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UsersDaoImplTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UsersDao usersDao;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 测试添加用户</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="meta">@Transactional</span> <span class="comment">//在测试类，对于事务提交默认的是回滚，在业务逻辑类中不会，此时应该再加一个注解</span></span><br><span class="line">	<span class="meta">@Rollback</span>(<span class="keyword">false</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">textInsertUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Users users=<span class="keyword">new</span> Users();</span><br><span class="line">		users.setUserage(<span class="number">20</span>);</span><br><span class="line">		users.setUsernames(<span class="string">"李四"</span>);</span><br><span class="line">		<span class="keyword">this</span>.usersDao.insertUsers(users);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 跟新用户</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="meta">@Transactional</span></span><br><span class="line">	<span class="meta">@Rollback</span>(<span class="keyword">false</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Users users=<span class="keyword">new</span> Users();</span><br><span class="line">		users.setUserid(<span class="number">1</span>);</span><br><span class="line">		users.setUserage(<span class="number">22</span>);</span><br><span class="line">		users.setUsernames(<span class="string">"王五"</span>);</span><br><span class="line">		<span class="keyword">this</span>.usersDao.updateUsers(users);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 根据userid查询用户</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectUsersById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Users users = <span class="keyword">this</span>.usersDao.selectUsersById(<span class="number">1</span>);</span><br><span class="line">		System.out.println(users);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 删除用户</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="meta">@Transactional</span></span><br><span class="line">	<span class="meta">@Rollback</span>(<span class="keyword">false</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Users users=<span class="keyword">new</span> Users();</span><br><span class="line">		users.setUserid(<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">this</span>.usersDao.deleteUsers(users);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>HQL查询</strong></p>
<p>HQL：<code>Hibernate Query Language</code></p>
<p>HQL的语法：就是将原来的sql语句中表和字段换成对象与属性的名称就可以了。</p>
<p>业务代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">selectUserByName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//getCurrentSession：当前session必须要有事务边界，且只能处理唯一的一个事务。当事务提交或者回滚后session自动失效</span></span><br><span class="line">    <span class="comment">//openSession：每次都会打开一个新的session。假如每次使用多次，则获得不同的session对象。使用完毕后我们需要手动clase方法关闭session</span></span><br><span class="line">    Session session=<span class="keyword">this</span>.hibernateTemplate.getSessionFactory().getCurrentSession();</span><br><span class="line">    Query query = session.createQuery(<span class="string">"from Users where usernames=:abc"</span>);</span><br><span class="line">    Query queryTemp = query.setString(<span class="string">"abc"</span>,name);</span><br><span class="line">    <span class="keyword">return</span> queryTemp.list();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">* HQL测试</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectUsersByName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Users&gt; list = <span class="keyword">this</span>.usersDao.selectUserByName(<span class="string">"李四"</span>);</span><br><span class="line">    <span class="keyword">for</span> (Users users : list) &#123;</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>SQL查询</strong></p>
<p>业务代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">selectUserByNameUseSQL</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    Session session=<span class="keyword">this</span>.hibernateTemplate.getSessionFactory().getCurrentSession();</span><br><span class="line">    Query query=session.createSQLQuery(<span class="string">"select * from t_user where usernames=?"</span>)</span><br><span class="line">                        .addEntity(Users.class)</span><br><span class="line">                        .setString(<span class="number">0</span>, name);</span><br><span class="line">    <span class="keyword">return</span> query.list();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">* SQL测试</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectUsersByNameUseSQL</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Users&gt; list = <span class="keyword">this</span>.usersDao.selectUserByNameUseSQL(<span class="string">"李四"</span>);</span><br><span class="line">    <span class="keyword">for</span> (Users users : list) &#123;</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>QBC查询</strong></p>
<p>QBC：Query By Criteria</p>
<p>业务代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">selectUserByNameUseCriteria</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    Session session=<span class="keyword">this</span>.hibernateTemplate.getSessionFactory().getCurrentSession();</span><br><span class="line">    <span class="comment">//select * from t_user where username = ?</span></span><br><span class="line">    <span class="comment">//session.createCriteria(Users.class)相当于select * from t_users</span></span><br><span class="line">    Criteria c = session.createCriteria(Users.class);</span><br><span class="line">    c.add(Restrictions.eq(<span class="string">"usernames"</span>,name));</span><br><span class="line">    <span class="keyword">return</span> c.list();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">* QBC测试</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectUsersByNameUseCriteria</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Users&gt; list = <span class="keyword">this</span>.usersDao.selectUserByNameUseCriteria(<span class="string">"李四"</span>);</span><br><span class="line">    <span class="keyword">for</span> (Users users : list) &#123;</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SpringData第二章-Spring整合Hibernate-JPA"><a href="#SpringData第二章-Spring整合Hibernate-JPA" class="headerlink" title="SpringData第二章 Spring整合Hibernate JPA"></a>SpringData第二章 Spring整合Hibernate JPA</h2><p>JPA：由sun公司提供了一对对持久层操作的标准（接口+文档）<br>Hibernate: 是Gravin King开发的一套持久层操作全自动的ORM框架<br>Hibernate JPA：是在Hibernate3.2版本中提供了对于JPA标准的实现。提供了一套按照JPA标准来实现持久层开发的API.</p>
<p><strong>Spring整合Hibernate JPA</strong></p>
<ol>
<li><p>创建项目</p>
</li>
<li><p>导入jar包</p>
<ul>
<li>Hibernate</li>
<li>Hibernate C3P0</li>
<li>spring-ioc、spring-aop、spring-jdbc、spring-orm、spring-test</li>
<li>commons-logging-1.1.1</li>
<li>mysql驱动包</li>
<li>单元测试：junit4</li>
<li>Hibernate JPA相关的jar包</li>
</ul>
</li>
</ol>
<p><img src="https://i.loli.net/2019/12/28/uvY6kPX5Wh3risV.png" alt="1577500768_1_.png"><br><img src="https://i.loli.net/2019/12/28/7vAEgPrCejct3QG.png" alt="1577523613_1_.png"></p>
<ol start="3">
<li>Spring整合hibernate jpa配置文件，applicationContext.xml</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">     	</span><br><span class="line">     	<span class="comment">&lt;!-- 配置读取properties文件的工具类 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:jdbc.properties"</span>/&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置C3P0数据库连接池 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- Spring整合Hibernate JPA 配置EntityManagerFactory --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"entityManagerFactory"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="comment">&lt;!-- 决定使用哪个JPA标准 --&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jpaVedorAdapter"</span> &gt;</span></span><br><span class="line">     			<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- hibernate相关属性的注入 --&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 配置数据库类型 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"database"</span> <span class="attr">value</span>=<span class="string">"MYSQL"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 正向工程 自动创建表 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"generateDbl"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 显示执行的SQL --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"showSql"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="comment">&lt;!-- 扫描实体包 --&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"packagesToScan"</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">value</span>&gt;</span>com.gdaib.pojo<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	</span><br><span class="line">     	</span><br><span class="line">     	<span class="comment">&lt;!-- 配置Hibernate的事务管理器 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.JpaTransactionManager"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"entityManagerFactory"</span> <span class="attr">ref</span>=<span class="string">"entityManagerFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置开启注解事务处理 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">tx:annotation-driven</span>  <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置Spring IOC的注解扫描--&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>hibernate-jpa实现CRUD操作</strong></p>
<p>接口实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.EntityManager;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.PersistenceContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.dao.UsersDao;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.pojo.Users;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UsersDaoImpl</span> <span class="keyword">implements</span> <span class="title">UsersDao</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//@PersistenceContext(name="entityManagerFactory")：从工厂中取出一个对象，赋值给EntityManager</span></span><br><span class="line">	<span class="meta">@PersistenceContext</span>(name=<span class="string">"entityManagerFactory"</span>)</span><br><span class="line">	<span class="keyword">private</span> EntityManager entityManager;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertUsers</span><span class="params">(Users users)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">this</span>.entityManager.persist(users);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUsers</span><span class="params">(Users users)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.entityManager.merge(users);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUsers</span><span class="params">(Users users)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Users u = <span class="keyword">this</span>.selectUsersById(users.getUserid());</span><br><span class="line">		<span class="keyword">this</span>.entityManager.remove(u);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Users <span class="title">selectUsersById</span><span class="params">(Integer userid)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.entityManager.find(Users.class, userid);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试代码与之前雷同</p>
<p><strong>hibernate-jpa中的HQL语句</strong></p>
<p>Hibernate JPA中的HQL语句</p>
<p>接口实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">selectUserByName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.entityManager.createQuery(<span class="string">"from Users where usernames =:abc"</span>)</span><br><span class="line">        .setParameter(<span class="string">"abc"</span>,name)</span><br><span class="line">        .getResultList(); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>测试代码与上面雷同</li>
</ul>
<p><strong>hibernate-jpa中的SQL语句</strong></p>
<p>Hibernate JPA中的SQL语句</p>
<p>接口实现类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">selectUserByNameUseSQL</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">    <span class="comment">//在hibernate jpa中如果通过?方法来绑定参数，那么它的查数是从1开始，而hibernate是从0开始</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.entityManager.createNativeQuery(<span class="string">"select * from t_users where usernames = ? "</span>, Users.class)</span><br><span class="line">            .setParameter(<span class="number">1</span>, name)</span><br><span class="line">            .getResultList();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>测试代码与上面雷同</li>
</ul>
<p><strong>hibernate-jpa中的Criteria语句</strong></p>
<p>Hibernate JPA中的QBC语句</p>
<ul>
<li>接口实现类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Users&gt; <span class="title">selectUserByNameUseCriteria</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">    <span class="comment">//CriteriaBuilder对象：创建一个CriteriaQuery，创建查询条件</span></span><br><span class="line">    CriteriaBuilder builder=<span class="keyword">this</span>.entityManager.getCriteriaBuilder();</span><br><span class="line">    <span class="comment">//CriteriaQuery对象：执行查询的criteria对象</span></span><br><span class="line">    <span class="comment">//下面代码相当于select * from t_users</span></span><br><span class="line">    CriteriaQuery&lt;Users&gt; query = builder.createQuery(Users.class);</span><br><span class="line">    <span class="comment">//获取要查询的实体类对象</span></span><br><span class="line">    Root&lt;Users&gt; root=query.from(Users.class);</span><br><span class="line">    <span class="comment">//封装查询条件</span></span><br><span class="line">    Predicate cate = builder.equal(root.get(<span class="string">"usernames"</span>), name);</span><br><span class="line">    query.where(cate);<span class="comment">//加查询条件 where usernames=name;</span></span><br><span class="line">    <span class="comment">//执行查询</span></span><br><span class="line">    TypedQuery&lt;Users&gt; typeQuery=<span class="keyword">this</span>.entityManager.createQuery(query);</span><br><span class="line">    <span class="keyword">return</span> typeQuery.getResultList();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SpringData-第三章-Spring-Data-JPA（重点）"><a href="#SpringData-第三章-Spring-Data-JPA（重点）" class="headerlink" title="SpringData 第三章 Spring Data JPA（重点）"></a>SpringData 第三章 Spring Data JPA（重点）</h2><p>Spring Data JPA：Spring Data JPA是Spring Data项目下的一个模块。提供了一套基于JPA标准操作数据库的简化方案。底层默认的是依赖Hibernate JPA来实现的。</p>
<p>Spring Data JPA的技术特点： 我们只需要定义接口并继承Spring Data JPA中所提供的的接口就可以了，不需要编写接口实现类。</p>
<p><strong>创建Spring Data JPA项目</strong></p>
<ol>
<li><p>创建项目</p>
</li>
<li><p>导入jar包</p>
<ul>
<li>Hibernate</li>
<li>Hibernate C3P0</li>
<li>spring-ioc、spring-aop、spring-jdbc、spring-orm、spring-test</li>
<li>commons-logging-1.1.1</li>
<li>mysql驱动包</li>
<li>单元测试：junit4</li>
<li>Hibernate JPA相关的jar包</li>
<li>spring-data-jpa两个jar包</li>
<li>slf4j三个jar包</li>
</ul>
</li>
</ol>
<p><img src="https://i.loli.net/2019/12/28/uvY6kPX5Wh3risV.png" alt="1577500768_1_.png"><br><img src="https://i.loli.net/2019/12/28/7vAEgPrCejct3QG.png" alt="1577523613_1_.png"><br><img src="https://i.loli.net/2019/12/28/xo5apukLfyw6iQ9.png" alt="1577537711_1_.png"></p>
<ol start="3">
<li>修改配置文件 applicationContext.xml</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:jpa</span>=<span class="string">"http://www.springframework.org/schema/data/jpa"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/data/jpa </span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/data/jpa/spring-jpa.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">     	</span><br><span class="line">     	<span class="comment">&lt;!-- 配置读取properties文件的工具类 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:jdbc.properties"</span>/&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置C3P0数据库连接池 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- Spring整合Hibernate JPA 配置EntityManagerFactory --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"entityManagerFactory"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="comment">&lt;!-- 决定使用哪个JPA标准 --&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jpaVendorAdapter"</span> &gt;</span></span><br><span class="line">     			<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- hibernate相关属性的注入 --&gt;</span></span><br><span class="line">     				</span><br><span class="line">     				<span class="comment">&lt;!-- 配置数据库类型 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"database"</span> <span class="attr">value</span>=<span class="string">"MYSQL"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 正向工程 自动创建表 --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"generateDdl"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">     				<span class="comment">&lt;!-- 显示执行的SQL --&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"showSql"</span> <span class="attr">value</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     		<span class="comment">&lt;!-- 扫描实体包 --&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"packagesToScan"</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">     				<span class="tag">&lt;<span class="name">value</span>&gt;</span>com.gdaib.pojo<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">     			<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	</span><br><span class="line">     	<span class="comment">&lt;!-- 配置Hibernate的事务管理器 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.JpaTransactionManager"</span>&gt;</span></span><br><span class="line">     		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"entityManagerFactory"</span> <span class="attr">ref</span>=<span class="string">"entityManagerFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置开启注解事务处理 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">tx:annotation-driven</span>  <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- 配置Spring IOC的注解扫描--&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- Spring Data JPA的配置 --&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!-- base-package：扫描dao接口所在的包 --&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">jpa:repositories</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib.dao"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>编写DAO接口</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.pojo.Users;</span><br><span class="line"><span class="comment">//第一个参数要操作的实体类型，第二个参数为主键的数据类型</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UsersDao</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Users</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>编写测试类</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UsersDao usersDao;</span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">	* 测试添加用户</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Transactional</span> <span class="comment">//在测试类，对于事务提交默认的是回滚，在业务逻辑类中不会，此时应该再加一个注解</span></span><br><span class="line"><span class="meta">@Rollback</span>(<span class="keyword">false</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">textInsertUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Users users=<span class="keyword">new</span> Users();</span><br><span class="line">	users.setUserage(<span class="number">29</span>);</span><br><span class="line">	users.setUsernames(<span class="string">"possible"</span>);</span><br><span class="line">	<span class="keyword">this</span>.usersDao.save(users);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Spring Data JPA的接口继承结构</strong></p>
<p><img src="https://i.loli.net/2019/12/29/49coWOSUs8DlbyM.png" alt="1577609676_1_.png"></p>
<p><strong>Spring Data JPA的运行原理</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> EntityManager entityManager;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//org.springframework.data.jpa.repository.support.SimpleJpaRepository@320494b6</span></span><br><span class="line">	<span class="comment">//System.out.println(this.usersDao);</span></span><br><span class="line">	<span class="comment">//class com.sun.proxy.$Proxy30(代理对象) 是基于jdk动态代理实现的</span></span><br><span class="line">	<span class="comment">//System.out.println(this.usersDao.getClass());</span></span><br><span class="line">	JpaRepositoryFactory factory=<span class="keyword">new</span> JpaRepositoryFactory(entityManager);</span><br><span class="line">	<span class="comment">//factory.getRepository(UsersDao.class)可以帮助我们为接口生成实现类，而这个实现类是SimpleJpaRepository的代理对象</span></span><br><span class="line">	<span class="comment">//要求：该接口必须要继承Repository接口</span></span><br><span class="line">	UsersDao ud = factory.getRepository(UsersDao.class);</span><br><span class="line">	System.out.println(ud);</span><br><span class="line">	System.out.println(ud.getClass());</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Repository接口</strong></p>
<p>Repository接口是Spring Data JPA中为我们提供的所有接口的顶层接口.</p>
<p>Repository提供了两种查询方式的支持<br>    1. 基于方法名称命名规则查询<br>    2. 基于@Query查询</p>
<p><strong>方法名称命名规则查询</strong></p>
<p>规则： findBy(关键字)+属性名称（属性名称的首字母大写）+查询条件(首字母大写)</p>
<p><img src="https://i.loli.net/2019/12/30/PMv5oOeBGY7zhy8.png" alt="1577708111_1_.png"></p>
<p>创建接口UsersDao.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.data.repository.Repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.pojo.Users;</span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * Repository接口讲解</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 1huangzewei</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//第一个参数要操作的实体类型，第二个参数为主键的数据类型</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UsersDao</span> <span class="keyword">extends</span> <span class="title">Repository</span>&lt;<span class="title">Users</span>,<span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function">List&lt;Users&gt; <span class="title">findByUsernamesIs</span><span class="params">(String string)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">List&lt;Users&gt; <span class="title">findByUsernamesLike</span><span class="params">(String string)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function">List&lt;Users&gt; <span class="title">findByUsernamesAndUserageGreaterThanEqual</span><span class="params">(String name,Integer age)</span></span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建测试类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.dao.UsersDao;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.pojo.Users;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * Repository接口测试</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 1huangzewei</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</span><br><span class="line"><span class="meta">@ContextConfiguration</span>(<span class="string">"classpath:applicationContext.xml"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RepositoryTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UsersDao usersDao;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 需求，使用用户名作为查询条件</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">/***</span></span><br><span class="line"><span class="comment">		 * 判断相等的条件，有三种表示方式</span></span><br><span class="line"><span class="comment">		 * 1、什么都不写，默认就是做相等判断</span></span><br><span class="line"><span class="comment">		 * 2. Is</span></span><br><span class="line"><span class="comment">		 * 3. Equal</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		List&lt;Users&gt; list = <span class="keyword">this</span>.usersDao.findByUsernamesIs(<span class="string">"李四"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> (Users users : list) &#123;</span><br><span class="line">			System.out.println(users);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 需求：根据用户姓名做like查询</span></span><br><span class="line"><span class="comment">	 * Like：条件关键字</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		List&lt;Users&gt; list = <span class="keyword">this</span>.usersDao.findByUsernamesLike(<span class="string">"王"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> (Users users : list) &#123;</span><br><span class="line">			System.out.println(users);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 需求：查询名称为王五并且他的年龄大于等于22</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span></span>&#123;</span><br><span class="line">		List&lt;Users&gt; list = <span class="keyword">this</span>.usersDao.findByUsernamesAndUserageGreaterThanEqual(<span class="string">"王五"</span>,<span class="number">22</span>);</span><br><span class="line">		<span class="keyword">for</span> (Users users : list) &#123;</span><br><span class="line">			System.out.println(list);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>基于@Query注解的查询</strong></p>
<p>通过JPQL查询</p>
<ul>
<li>JPQL:通过Hibernate的HQL演变过来。它和HQL语法极其相似 </li>
</ul>
<p>通过SQL语句查询</p>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/12/02/专插本c语言/">专插本c语言</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-12-02T04:30:19.000Z" itemprop="datePublished">2019-12-02</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/专插本c语言/">专插本c语言</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="最简单的C语言程序"><a href="#最简单的C语言程序" class="headerlink" title="最简单的C语言程序"></a>最简单的C语言程序</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"世界，你好\n"</span>);	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>main</code>是主函数的函数名，表示这是一个主函数。</li>
<li>每一个C源程序都必须有且只能有一个主函数（main函数）。</li>
<li>函数调用语句<code>printf()</code>函数的功能是把要输出的内容送到显示器去显示。</li>
<li><code>printf()</code>函数是一个由系统定义的标准函数，可以在程序中直接调用。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">double</span> x,s;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input number:\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%lf"</span>,&amp;x);</span><br><span class="line">	s=<span class="built_in">sin</span>(x);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"sin of %lf is %lf\n"</span>,x,s); </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>include</code>称为文件包含命令</li>
<li>扩展名为<code>.h</code>的文件称为头文件</li>
<li>定义两个实数变量，以被后面程序使用显示提示信息。</li>
<li>从键盘中获得一个实数x</li>
<li>求x的正弦，并把它赋值给s</li>
<li>显示程序运算结果</li>
<li>main函数结束。</li>
</ul>
<ul>
<li>例题</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>; <span class="comment">//函数说明 </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;     <span class="comment">//主函数 </span></span><br><span class="line">	<span class="keyword">int</span> x,y,z;  <span class="comment">//变量说明 </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>; <span class="comment">//函数说明</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input two numbers:\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y); <span class="comment">// 输入x,y值</span></span><br><span class="line">	z=max(x,y); <span class="comment">//调用max函数 </span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"max num = %d"</span>,z); <span class="comment">//输出 </span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123; <span class="comment">//定义max函数</span></span><br><span class="line"> </span><br><span class="line">	<span class="keyword">if</span>(a&gt;b)<span class="keyword">return</span> a; <span class="comment">//把结果返回主调函数 </span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> b;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="数据类型、运算符和表达式"><a href="#数据类型、运算符和表达式" class="headerlink" title="数据类型、运算符和表达式"></a>数据类型、运算符和表达式</h2><h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><ul>
<li>基本类型：整型、字符型、实型（浮点型：（单精度，双精度）），枚举类型。</li>
<li>指针类型</li>
<li>构造类型：数组类型，结构体类型，共用体类型。</li>
<li>空类型</li>
</ul>
<ol>
<li><p>基本数据类型：基本数据类型最主要的特点是。其值不可以再分解为其他类型。也就是说，基本数据类型就是自我说明的。</p>
</li>
<li><p>构造数据类型：构造数据类型是根据已定义的一个或多个数据类型用构造方法来定义的。也就是说，一个构造类型的值可以分解成若干个“成员”或“元素”。每个“成员”都是一个基本数据类型或又是一个构造类型。在c语言中，构造类型有以下几种。</p>
<blockquote>
<ul>
<li>数组类型</li>
<li>结构体类型</li>
<li>共用体（联合）类型</li>
</ul>
</blockquote>
</li>
<li><p>指针类型：指针是一种特殊的，同时又是具有重要作用数据类型。其值用来表示某个变量在内存存储器中的地址。虽然指针变量的取值类似于整形量，但，这两个类型完全不同的量，因此不能混为一谈。</p>
</li>
<li><p>空类型：在调用函数值时，通常应向调用者返回一个函数值。这个返回的函数值是具有一定的数据类型的，应在函数定义及函数说明中给以说明，例如在例题中给出的max函数定义中，函数头为：<code>int max(int a,int b);</code>其中int类型说明符表达该函数的返回值整形量。但是，也有一类函数，调用后并不需要向调用者返回函数值，这种函数可以定义为“空类型”。其类型说明符为<code>void</code>。</p>
</li>
</ol>
<hr>
<h3 id="常量和变量"><a href="#常量和变量" class="headerlink" title="常量和变量"></a>常量和变量</h3><ul>
<li>对于基本数据类型，按照其值是否可改变又分为常量和变量两种。</li>
<li>在程序运行中，其值不发生改变的量称为常量，其值是可以改变的量称为变量。</li>
<li>它们可以与数据类型结合起来分类。例如：可以分为整型常量，整型变量，浮点常量，浮点变量，字符常量，字符变量，枚举常量，枚举变量。在程序中，常量可以不经说明而直接引用的，而变量则必须先定义后使用。</li>
<li>整形量包括整型常量和整型变量。</li>
</ul>
<hr>
<ul>
<li>在程序执行过程中，其值不可以发生改变的量称之为常量。</li>
<li>符号常量：用标识符表示一个常量。在C语言中，可以用一个标识符来表示一个常量，称之为符号常量。</li>
<li>符号常量在使用之前必须先定义，其一般形式为：<code>#define 符号量 常量</code></li>
<li>其中<code>#define</code>是一条预处理命令（预处理命令都以“#”开头），称为宏定义命令，其功能是把该标识符定义为其后的常量值。一经定义，以后再程序中所有出现该标识符的地方均带之以常量值。</li>
<li>习惯上符号常量的标识符用大写字母，变量标识符用小写字母，以示区分。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PRICE 30;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num,total;</span><br><span class="line">	num=<span class="number">10</span>;</span><br><span class="line">	total=num*PRICE;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"total=%d\n"</span>,total);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>用标识符表示一个常量，称为符号常量。</li>
<li>符号常量与变量不同的是，它的值在程序运行作用域内不会发生改变，也不能在被赋值。</li>
<li>使用符号常量的好处<ul>
<li>含义清楚；</li>
<li>能做到“一改全改”；</li>
</ul>
</li>
</ul>
<ul>
<li>变量：其值可以改变的量称为变量。一个变量应该有一个名字，在内存中占据一定的存储单元。变量定义必须放在变量使用之前。一般放在函数体的口头部分。要区分变量名和变量值两个概念。</li>
</ul>
<hr>
<h3 id="整型数据"><a href="#整型数据" class="headerlink" title="整型数据"></a>整型数据</h3><ul>
<li><p>整型常量的表示方式（<code>在程序中是根据前缀来区分各种进制数的。</code>）</p>
<blockquote>
<ul>
<li>整型常量就是整常数。在C语言中，使用的整常量有八进制、十六进制和十进制三种。</li>
<li>十进制正常数：十进制正常数没有前缀。其数码为0~9。（以下是合法的十进制常数：237,-568,65535,1627）。</li>
<li>八进制整常数：八进制正常数必须以0开头，即以0作为八进制数的前缀。数码取值为0~7。八进制数通常是无符号数。（以下是合法的八进制数：015（十进制数13），0101（十进制数65），0177777(十进制数65535)）</li>
<li>十六进制整常数：十六进制整常数的前缀为<code>0X或0x</code>。其数码取值为0<del>9，A</del>F或a~f。以下是合法的十六进制整常数（0X2A（十进制数42），0XA0（十进制数160），0XFFFF（十进制数为65535））</li>
<li>整型常数的后缀：在16位字长的机器上，其本整型的长度也为16位，因此表示的数的范围也是有限的。十进制的无符号整常数的范围的0<del>65535，有符号为-32768</del>+32767。八进制的无符号的数的表示范围为0<del>0177777.十六进制的无符号的数的表示范围0x0</del>0xffff或0x0~0XFFFF。如果使用的数超过了上述范围，就必须使用长整型数来表示。长整型数是用后缀“L”或“l”来表示的。</li>
</ul>
</blockquote>
</li>
<li><p>整型变量</p>
<blockquote>
<ul>
<li><code>int k=3</code>;</li>
<li>整型变量在内存中是以二进制的方式存储。</li>
</ul>
</blockquote>
</li>
<li><p>补充：内存中的二进制存储(常识：一个字节BYTE=8位bit)</p>
</li>
<li><p>数值是以补码表示的</p>
<blockquote>
<ul>
<li>正数的补码与原码相同；</li>
<li>负数的补码：将该数的绝对值的二进制形式按位取反再加1。</li>
</ul>
</blockquote>
</li>
<li><p>整型变量的分类（注意:这里占多少字节与系统何编辑器规定有关！可以在编辑器中查看）</p>
<blockquote>
<ul>
<li>基本型：类型说明符为int，在内存中占4个字节。</li>
<li>短整量：类型说明符为short或 short int。所占节点和取值范围与基本类型相同。</li>
<li>长整型：类型说明符为long或 long int。在内存中占4个字节。</li>
<li>无符号型：类型说明符为：unsigned。</li>
</ul>
</blockquote>
</li>
<li><p>整型变量的定义</p>
<blockquote>
<ul>
<li>形式：<code>类型说明符 变量名标识符，变量名标识符...;</code></li>
<li>例如：<code>int a,b,c;(a,b,c为整型变量)</code>、<code>long x,y;(x,y为长整型变量)</code>、<code>unsigned p,q;（p,q为无符号整型变量）</code></li>
<li>在书写变量定义时，应注意如下几点：<blockquote>
<ul>
<li>允许在一个类型说明符后，定义多个相同类型的变量。各变量名之间用“,”隔开。类型说明符与变量名之间至少用一个空格隔开。</li>
<li>最后一个变量名之后必须以“;”结尾。</li>
<li>变量定义必须放在变量使用之前。一般放在函数体的开头部分。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,c,d;</span><br><span class="line">	<span class="keyword">unsigned</span> u;</span><br><span class="line">	a=<span class="number">12</span>;</span><br><span class="line">	b=<span class="number">-24</span>;</span><br><span class="line">	u=<span class="number">10</span>;</span><br><span class="line">	c=a+u;d=b+u;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"a+u=%d，b+u=%d\n"</span>,c,d);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>整型数据的溢出</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">//整型数据的溢出 </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">short</span> <span class="keyword">int</span> a,b;</span><br><span class="line">	a=<span class="number">32767</span>;</span><br><span class="line">	b=a+<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,a,b);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//不同数据类型之间的运算</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> x,y;</span><br><span class="line">	<span class="keyword">int</span> a,b,c,d;</span><br><span class="line">	x=<span class="number">5</span>;</span><br><span class="line">	y=<span class="number">6</span>;</span><br><span class="line">	a=<span class="number">7</span>;</span><br><span class="line">	b=<span class="number">8</span>;</span><br><span class="line">	c=x+a;</span><br><span class="line">	d=y+b;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"c=x+a=%d,d=y+b=%d\n"</span>,c,d);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="实型数据"><a href="#实型数据" class="headerlink" title="实型数据"></a>实型数据</h3><ul>
<li><p>实型常量的表示方法</p>
</li>
<li><p>实型也称为浮点型。实型常量也称为实数或者浮点数。在c语言中，实数只采用十进制。它有二中形式：十进制小数形式，指数形式。</p>
</li>
<li><p>十进制数形式：由数码0~9和小数点组成</p>
<blockquote>
<ul>
<li>例如0.02,5.0,5.789,0.13,5.0,300.,-267.8230等均为合法的实数。注意：必须有小说点.</li>
</ul>
</blockquote>
</li>
<li><p>指数形式：由十进制数，加阶码标志<code>e</code>和<code>E</code>以及阶码（只能是整数，可以带符号）组成。</p>
<blockquote>
<ul>
<li>aEm (a为十进制数，n为十进制整数)</li>
</ul>
</blockquote>
</li>
<li><p>标准C允许浮点数使用后缀。后缀为“F”或者“f”即表示该数为浮点数。如356f和356.是等价的。</p>
</li>
<li><p>实型数据在内存中的存放形式</p>
<blockquote>
<ul>
<li>实型数据一般占4个字节（32位）内存空间。按指数形式存储。实数3.14159在内存中的存放形式如下：</li>
</ul>
</blockquote>
</li>
</ul>
<table>
<thead>
<tr>
<th>符号</th>
<th>小数部分</th>
<th>指数部分</th>
</tr>
</thead>
<tbody><tr>
<td>+</td>
<td>.314159</td>
<td>1</td>
</tr>
</tbody></table>
<blockquote>
<ul>
<li>小数部分占的位（bit）愈多，数的有效数字就愈多，精度俞高</li>
<li>指数部分占的位数愈多，则能表示的数值范围愈大。 </li>
</ul>
</blockquote>
<ul>
<li><p>实型变量的分类</p>
<blockquote>
<ul>
<li>单精度（float）和双精度（double），长双精度（long double）三类。</li>
<li>单精度值显示7位有效数字。数值范围：3.4E-38~3.4E+38</li>
<li>双精度显示16位有效数字。数字范围：1.7E-308~1.7E+308</li>
</ul>
</blockquote>
</li>
<li><p>实型数据的舍入误差</p>
<blockquote>
<ul>
<li>由于实型变量是由有限的存储单元组成的，因此能提供的有效数字总是有限的。</li>
</ul>
</blockquote>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">float</span> a,b;</span><br><span class="line">	a=<span class="number">123456.789e5</span>;</span><br><span class="line">	b=a+<span class="number">20</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%lf\n"</span>,a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%lf\n"</span>,b);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习：<blockquote>
<ul>
<li>1.0/3*3等于多少？</li>
<li>3/2呢？</li>
<li>1/3*3呢？</li>
</ul>
</blockquote>
</li>
<li>编程（1）（2）（3）</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%f\n"</span>,<span class="number">1.0</span>/<span class="number">3</span>*<span class="number">3</span>); <span class="comment">//3.00000</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%f\n"</span>,<span class="number">1</span>/<span class="number">3</span>*<span class="number">3</span>); <span class="comment">//0.0000</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%f\n"</span>,<span class="number">3</span>/<span class="number">2</span>);<span class="comment">//0.00000</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="字符型数据"><a href="#字符型数据" class="headerlink" title="字符型数据"></a>字符型数据</h3><ul>
<li>字符型数据包括字符常量和字符变量</li>
<li>字符常量<blockquote>
<ul>
<li>字符常量是用单引号括起来的一个字符。</li>
<li>例如’a’,’b’,’=’,’+’,’?’都是合法的字符常量。</li>
<li>在C语言中，字符常量有以下特点:<blockquote>
<ul>
<li>字符常量只能用单引号括起来，不能用双引号或其他括号。</li>
<li>字符常量只能是单个字符，不能是字符串。</li>
<li>字符可以是字符集中任意字符。但是数字被定义为字符型之后就不能参与数值运算。如’5’和5是不同的。’5’是字符常量，不能参与运算。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>字符变量<blockquote>
<ul>
<li>字符变量：字符变量用来存储字符常量，即单个字符。</li>
<li>字符变量的类型说明符是char。字符变量类型定义格式和书写规则都与整形变量相同。例如 char a,b;</li>
<li>转义字符：转义字符是一种特殊的字符常量。转义字符是以反射线“\”开头，后跟一个或多个字符。转义字符具有特定的含义，不同于字符原有的意义，古称“转义”字符。例如：在前面各例题printf函数的格式中用到“\n”就是一个转义字符，其意义就是“回车换行”。转义字符主要用来表示那些用一般字符不便于表示的控制代码。</li>
</ul>
</blockquote>
</li>
<li>字符型数据常用的转义字符及其含义</li>
</ul>
<table>
<thead>
<tr>
<th>转义字符</th>
<th>转义字符的意义</th>
<th>ASCII代码</th>
</tr>
</thead>
<tbody><tr>
<td>\n</td>
<td>回车换行</td>
<td>10</td>
</tr>
<tr>
<td>\t</td>
<td>横向调到下一制表位置</td>
<td>9</td>
</tr>
<tr>
<td>\b</td>
<td>退格</td>
<td>8</td>
</tr>
<tr>
<td>\r</td>
<td>回车</td>
<td>13</td>
</tr>
<tr>
<td>\f</td>
<td>走纸换页</td>
<td>12</td>
</tr>
<tr>
<td>|    反斜线符””</td>
<td>92</td>
<td></td>
</tr>
<tr>
<td>&#39;</td>
<td>单引号符</td>
<td>39</td>
</tr>
<tr>
<td>&quot;</td>
<td>双引号</td>
<td>34</td>
</tr>
<tr>
<td>\a</td>
<td>鸣铃</td>
<td>7</td>
</tr>
<tr>
<td>\ddd</td>
<td>1~3位八进制数所代表的字符</td>
<td></td>
</tr>
<tr>
<td>\xhh</td>
<td>1~2位十六进制数所代表的字符</td>
<td></td>
</tr>
</tbody></table>
<ul>
<li>练习</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,c;</span><br><span class="line">	a=<span class="number">5</span>;b=<span class="number">6</span>;c=<span class="number">7</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">" b c\ted\rf\n"</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"hijk\tL\bM\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>字符数据在内存中的存储形式及使用方法</p>
<blockquote>
<ul>
<li>每个字符变量被分配一个字节的内存空间，因此只能存放一个字符。字符值是以<code>ASCII</code>码的形式存放在变量的内存单元之中的。</li>
<li>如x的十进制<code>ASCII</code>码值是120，y的十进制数<code>ASCII</code>码是121。对字符变量a,b赋值’x’，’7’值： a=’x’;b=’7’;</li>
<li>实际上是在a,b两个单元内存中存放120和55的二进制代码</li>
<li>‘A’的ASCII值：65；’a’的ASCII值：97；’0’的ASCII值48；</li>
</ul>
</blockquote>
</li>
<li><p>练习：向字符变量赋以整数</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//-128~127</span></span><br><span class="line"><span class="comment">//197</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123; <span class="comment">//字符变量  ASCII值</span></span><br><span class="line">	SetConsoleOutputCP(<span class="number">437</span>);</span><br><span class="line">	<span class="keyword">char</span> a,b;</span><br><span class="line">	a=<span class="number">197</span>;</span><br><span class="line">	b=<span class="number">198</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="keyword">sizeof</span>(<span class="keyword">char</span>));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c,%c\n"</span>,a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,a,b); </span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2：小写字符换大写字母</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a,b;</span><br><span class="line">	a=<span class="string">'a'</span>;</span><br><span class="line">	b=<span class="string">'b'</span>;</span><br><span class="line">	a=a<span class="number">-32</span>;</span><br><span class="line">	b=b<span class="number">-32</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"a=%c,b=%c\na=%d,b=%d"</span>,a,b,a,b);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习3：比较char a=33与int b=33;</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a;<span class="keyword">int</span> b;</span><br><span class="line">	a=<span class="number">33</span>;</span><br><span class="line">	b=<span class="number">33</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"a=%d,b=%d"</span>,a,b);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="字符串常量"><a href="#字符串常量" class="headerlink" title="字符串常量"></a>字符串常量</h3><ul>
<li>字符串常量是由一对双引号括起来的字符序列。例如：”CHINA”、”C Program”等都是合法的字符串。</li>
<li>字符串常量和字符常量是不同的量。他们之间的主要区别如下：(补充：char占八位而已！)<blockquote>
<ul>
<li>字符常量由单引号括起来，字符串常量由双引号括起来的。</li>
<li>字符常量只能是单个字符，字符串常量则可以包含一个或多个字符。</li>
<li>可以把一个字符常量赋值给字符串常量，但不能把一个字符串常量赋值给一个字符常量。例如：<code>可以char a=&#39;a&#39; 不能char a=&quot;a&quot;</code></li>
<li>字符常量占一个字节的内存空间。字符串常量占的内存字节数等于字符串中字节数加1。增加的一个字节中存放字符<code>\0</code>(ASCII为0)。这是字符串结束的标志。</li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="各类数值型数据之间的混合运算"><a href="#各类数值型数据之间的混合运算" class="headerlink" title="各类数值型数据之间的混合运算"></a>各类数值型数据之间的混合运算</h3><ul>
<li><p>变量的数据类型是可以转换的。转换的方式有两种，一种是自动转换，一种是强制转换。自动转换发生在不同数据类型的量混合运算时，有编译系统自动完成。自动转换遵循以下规则：</p>
<blockquote>
<ul>
<li>若参与运算的类型不同，则先转换成同一类型，然后进行运算。</li>
<li>转换按数据长度增加的方向进行，以保证精度不降低。如int型和long型运算时，先把int量转换成long型后再进行计算。</li>
<li>所有的浮点运算都是以双精度进行的，即使仅含有float单精度量运算的表达式，也要转换成double型，再做运算。</li>
<li>char型和short型参与运算时，必须转换成int型。</li>
<li>在赋值运算时，赋值号两边量的数据类型不同时，赋值号右边量的类型将转换成左边量的类型。如果右边量的数据类型长度比左边长时，将丢失一部分数据，这样会降低精度，丢失的部分按四舍五入的方式向前舍入。</li>
<li>类型自动转换规格  <code>double&lt;---long&lt;----unsigned&lt;---int &lt;----short char</code></li>
</ul>
</blockquote>
</li>
<li><p>练习1</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">float</span> PI=<span class="number">3.14159</span>;</span><br><span class="line">	<span class="keyword">double</span> s;<span class="keyword">int</span> r=<span class="number">5</span>;</span><br><span class="line">	s=r*r*PI;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"s=%lf\n"</span>,s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2 实现四舍五入</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">float</span> a=<span class="number">4.49</span>;</span><br><span class="line">	<span class="keyword">int</span> c= (<span class="keyword">int</span>)(a+<span class="number">0.5</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>强制类型转换</p>
<blockquote>
<ul>
<li>强制类型转换是通过类型转换运算来实现的。</li>
<li>其一般形式类：<code>（类型说明符）(表达式)</code>：其功能是把表达式的运算结果强制转换成类型说明符所表示的类型。</li>
<li>例如 <code>(float) a</code>：把a转换为实型；<code>(int)(x+y)</code>：把x+y结果转换为整型.</li>
<li>在使用强制转换时应注意以下问题： <blockquote>
<ol>
<li>类型说明符和表达式都必须加括号（单个变量可以不加括号）。</li>
<li>无论是强制转换或是自动转换，都是为了本次的运算的需要而对变量的数据长度进行的临时性转换，而不改变数据说明时对该变量的定义的类型。 </li>
</ol>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li><p>练习1</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">float</span> f=<span class="number">5.75</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"(int)f=%d,f=%f"</span>,(<span class="keyword">int</span>)f,f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="算术运算符和算数表达式"><a href="#算术运算符和算数表达式" class="headerlink" title="算术运算符和算数表达式"></a>算术运算符和算数表达式</h3><ul>
<li>加法运算符”+”：加法运算符为双目运算符，即应有两个量参与加法运算。如a+b,a+8等。具有结合性。</li>
<li>减法运算符”-“：减法运算符为双目运算符。但“-”也可以做负值运算符，此时是单目运算符。如-x，-5等具有左结合性。</li>
<li>乘法运算符”*”：双目运算，具有左结合性。</li>
<li>除法运算符”/“：双目运算具有左结合性。参与运算量均为整型时，结果也是整型，舍去小数。如果运算中有一个是实型，则结果为double型。</li>
<li>求余数”%”：双目运算符，具有左结合性。</li>
<li>练习1</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%f"</span>,<span class="number">3.0</span>/<span class="number">4</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n\n%d,%d\n"</span>,<span class="number">20</span>/<span class="number">7</span>,<span class="number">-20</span>/<span class="number">7</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%f,%f\n"</span>,<span class="number">20.0</span>/<span class="number">7</span>,<span class="number">-20.0</span>/<span class="number">7</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习3</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="number">100</span>%<span class="number">3</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>运算符的优先级：C语言中，运算符的运算优先级共分为15级。1级最高，15级最低。在表达式中，优先级较高的优先于优先级较低的进行运算。而在一个运算量两侧的运算符优先级相同时，则按运算符的结合性所规定的结合方向处理。</li>
<li>运算符的结合性:C语言中各运算符的结合性分为两种，即左结合性（自左至右）和右结合性（自右至左）。</li>
</ul>
<h2 id><a href="#" class="headerlink" title></a><img src="https://i.loli.net/2019/12/03/ORnwkt2uKjQYSls.png" alt="1575355235_1_.png"></h2><h3 id="自增、自减运算符"><a href="#自增、自减运算符" class="headerlink" title="自增、自减运算符"></a>自增、自减运算符</h3><ul>
<li><p>自增1，自增1运算符：自增1运算符记为<code>&quot;++&quot;</code>，其功能是使变量的值自增1；</p>
</li>
<li><p>自减1，自减1运算符：自减1运算符记为<code>&quot;--&quot;</code>，其功能是使变量的值自减1；</p>
</li>
<li><p>自增1，自减1运算符均为单目运算符，都具有结合性。可以有一下几种形式：</p>
<blockquote>
<ul>
<li>++i：i自增1后再参与其他运算。</li>
<li>–i：i自减1后再参与其他运算。</li>
<li>i++：i参与运算后，在自增1.</li>
<li>i–：i参与运算后，在自减1.</li>
</ul>
</blockquote>
</li>
<li><p>i++，i–要仔细分析。</p>
</li>
<li><p>练习1</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">8</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,++i);<span class="comment">//9</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,--i);<span class="comment">//8</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i++);<span class="comment">//8</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i--);<span class="comment">//9</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,-i++);<span class="comment">//-8</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,-i--);<span class="comment">//-9</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i);<span class="comment">//8</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">5</span>,j=<span class="number">5</span>,p,q;</span><br><span class="line">	p=(i++)+(i++)+(i++);</span><br><span class="line">	q=(++j)+(++j)+(++j);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%d,%d,%d"</span>,p,q,i,j); </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="赋值运算符与赋值表达式"><a href="#赋值运算符与赋值表达式" class="headerlink" title="赋值运算符与赋值表达式"></a>赋值运算符与赋值表达式</h3><ul>
<li><p>简单赋值运算符和表达式：简单赋值运算符记为”=”。由”=”连接的式子称为赋值表达式。其一般形式为：变量=表达式</p>
</li>
<li><p>例如： x=a+b; w=sin(a)+sin(b)；</p>
</li>
<li><p>赋值运算符的功能是计算表达式的值再赋值左边的变量。</p>
</li>
<li><p>赋值运算符具有右结合性。</p>
</li>
<li><p>类型转换</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	SetConsoleOutputCP(<span class="number">437</span>);</span><br><span class="line">	<span class="keyword">int</span> a,b=<span class="number">232</span>;</span><br><span class="line">	<span class="keyword">float</span> x,y=<span class="number">8.88</span>;</span><br><span class="line">	<span class="keyword">char</span> c1=<span class="string">'k'</span>,c2;</span><br><span class="line">	a=y;<span class="comment">//8</span></span><br><span class="line">	x=b;<span class="comment">//232.0000</span></span><br><span class="line">	a=c1;<span class="comment">//107</span></span><br><span class="line">	c2=b;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%f,%d,%c"</span>,a,x,a,c2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="复合的赋值运算符"><a href="#复合的赋值运算符" class="headerlink" title="复合的赋值运算符"></a>复合的赋值运算符</h3><ul>
<li>在赋值符<code>=</code>之前加上其他二目运算符即可构成复合赋值符。如+=、-=</li>
<li>复合赋值符能提高编译效率并产生质量较高的目标代码。</li>
</ul>
<hr>
<h3 id="逗号运算符和逗号表达式"><a href="#逗号运算符和逗号表达式" class="headerlink" title="逗号运算符和逗号表达式"></a>逗号运算符和逗号表达式</h3><ul>
<li>在C语言中逗号”,”也是一种运算符，称为逗号运算符。其功能是把两个表达式连接起来组成一个表达式，称为逗号表达式。</li>
<li>其一般形式为：<code>表达式1，表达式2</code></li>
<li>其求值过程是分别求两个表达式的值，并以表达式2的值作为整个逗号表达式的值。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a=<span class="number">2</span>,b=<span class="number">4</span>,c=<span class="number">6</span>,x,y;</span><br><span class="line">	y=((x=a+b),(b+c));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"y=%d,x=%d"</span>,y,x);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>对于逗号表达式还要说明两点<blockquote>
<ul>
<li>逗号表达式一般形式中的表达式1和表达式2也可以又是逗号表达式。如<code>(表达式1,(表达式3,表达式2))</code>形成了嵌套情形。因此可以把逗号表达式扩展为以下形式：<code>y=(表达式1,表达式2);</code>，整个逗号表达式的值等于等于表达式n的值。</li>
<li>程序中使用逗号表达式，通常是要分别求逗号表达式内各表达式的值，并不一定要求整个逗号表达式的值。</li>
</ul>
</blockquote>
</li>
</ul>
<h2 id="顺序程序设计"><a href="#顺序程序设计" class="headerlink" title="顺序程序设计"></a>顺序程序设计</h2><ul>
<li><p>从程序的流程来看，程序可以分为三种基本结构：顺序结构、分支结构、循环结构。</p>
<h2 id="C基本语句介绍"><a href="#C基本语句介绍" class="headerlink" title="C基本语句介绍"></a>C基本语句介绍</h2></li>
<li><p>C程序的执行部分是由语句组成的。程序的功能也是由执行语句实现的。</p>
</li>
<li><p>C语句可以分为以下5类：</p>
<ul>
<li>表达式语句</li>
<li>函数调用语句</li>
<li>控制语句</li>
<li>复合语句</li>
<li>空语句</li>
</ul>
</li>
<li><p>表达式语句：表达式语句有表达式+分号组成； <code>x=2;</code></p>
</li>
<li><p>函数调用语句：由函数名和实际参数，加上”;”组成；其一般形式：函数名(实际参数表);<code>printf(&quot;hello world&quot;);</code></p>
</li>
<li><p>复合语句:<code>{x=y+x;x=2;y=2;}</code></p>
</li>
<li><p>控制语句:循环语句(while、do..while,for)</p>
</li>
<li><p>空语句：<code>while(1){...}</code></p>
</li>
<li><p>赋值语句：赋值表达式+分号组成</p>
</li>
<li><p>数据输入输出的概念以及C语言中的实现</p>
<blockquote>
<ul>
<li>所谓输入输出是以计算机为主体而言的。</li>
<li>本章所介绍的是向标准输出设备显示器输出数据的语句。</li>
<li>在C语言中，所有的数据输入/输出都是由库函数完成的。因此都是函数语句。</li>
<li>在使用C语言函数库时，要用到预编译命令<code>#include</code>，将有关“头文件”包含到源文件中。使用标准输入输出库函数时需要用到”stdio.h”文件，因此源文件开头应有以下预编译命令：<code>#include &quot;stdio.h&quot;或#include &lt;stdio.h&gt;</code>，stdio是标准input或output意思。</li>
<li>考虑到printf和scanf函数使用频繁，系统允许在使用这两个函数时不加<code>#include&lt;stdio.h&gt;或#include &quot;stdio.h&quot;</code></li>
</ul>
</blockquote>
<h3 id="putchar函数-字符输出函数"><a href="#putchar函数-字符输出函数" class="headerlink" title="putchar函数(字符输出函数)"></a>putchar函数(字符输出函数)</h3></li>
<li><p>putchar是字符输出函数，其功能是在显示器上输出单个字符。</p>
</li>
<li><p>其一般形式为 putchar(字符变量)</p>
</li>
<li><p>例如：putchar(‘a’);puthchar(x);</p>
</li>
<li><p>对于控制字符则执行控制功能，不在屏幕上显示。 </p>
</li>
<li><p>使用本函数之前必须要用文件包含命令<code>#include &quot;stdio.h&quot;或#include &lt;stdio.h&gt;</code></p>
</li>
<li><p>练习1：输出单个字符</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a=<span class="string">'B'</span>,b=<span class="string">'o'</span>,c=<span class="string">'k'</span>;</span><br><span class="line">	<span class="built_in">putchar</span>(a);<span class="built_in">putchar</span>(b);<span class="built_in">putchar</span>(b);<span class="built_in">putchar</span>(c);<span class="built_in">putchar</span>(<span class="string">'\t'</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(a);<span class="built_in">putchar</span>(b);</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">'\n'</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(b);<span class="built_in">putchar</span>(c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="getChar函数-键盘输入函数"><a href="#getChar函数-键盘输入函数" class="headerlink" title="getChar函数(键盘输入函数)"></a>getChar函数(键盘输入函数)</h3><ul>
<li>getchar函数的功能是从键盘上输入一个字符。</li>
<li>其一般形式是：getchar();</li>
<li>通常把输入的字符赋予一个字符变量，构成赋值语句。如<code>char c;c=getchar();</code>;</li>
<li>练习1：从键盘输入一个字符并输出。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> c;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input a character\n"</span>);</span><br><span class="line">	c=getchar();</span><br><span class="line">	<span class="built_in">putchar</span>(c);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="printf函数（输出格式函数）"><a href="#printf函数（输出格式函数）" class="headerlink" title="printf函数（输出格式函数）"></a>printf函数（输出格式函数）</h3><ul>
<li>printf函数称为格式输出函数，其关键字最末一个字母f即可“格式（format）之意”。其功能是按照用户指定的格式，把指定的数据显示到显示器屏幕上。</li>
<li>printf函数调用的一般形式<blockquote>
<ul>
<li>printf函数一个标准库函数，它的函数原型在头文件”stdio.h”。但作为一个特例，允许使用printf函数而不需要导入”stdio.h”文件</li>
<li>一般形式为：printf(“格式控制字符串”,输出表列);</li>
<li>格式字符串：%d表示按十进制整型输出。%ld按十进制长整型输出。%c表示按字符型输出。</li>
<li>非格式字符串按原样输出。</li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/12/03/LsflcXKponN9geW.png" alt="1575378060_1_.png"></p>
<ul>
<li>练习</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a=<span class="number">88</span>,b=<span class="number">89</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c,%c\n"</span>,a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"a=%d,b=%d\n"</span>,a,b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a=<span class="number">15</span>;</span><br><span class="line">	<span class="keyword">float</span> b=<span class="number">123.1234567</span>;</span><br><span class="line">	<span class="keyword">double</span> c=<span class="number">12345678.1234567</span>;</span><br><span class="line">	<span class="keyword">char</span> d=<span class="string">'p'</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"a=%d,%5d,%o,%x\n"</span>,a,a,a,a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"b=%f,%lf,%5.4lf,%e\n"</span>,b,b,b,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"c=%lf,%f,%8.4lf\n"</span>,c,c,c);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"d=%c,%8c\n"</span>,d,d);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="scanf函数（格式输入函数）"><a href="#scanf函数（格式输入函数）" class="headerlink" title="scanf函数（格式输入函数）"></a>scanf函数（格式输入函数）</h3><ul>
<li>scanf函数称为格式输入函数，即按用户指定的格式从键盘上把数据输入到指定的变量中。</li>
<li>练习1 输入三角形的三边长，求三角形面积。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">float</span> a,b,c,s,area;<span class="comment">//a,b,c为三边长，s为周长，area为面积</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%f,%f,%f"</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line">	s=<span class="number">1.0</span>/<span class="number">2</span>*(a+b+c);</span><br><span class="line">	area=<span class="built_in">sqrt</span>(s*(s-a)*(s-b)*(s-c)); </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"a=%7.2f,b=%7.2f,c=%7.2f,s=%7.2f\n"</span>,a,b,c,s);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"area=%7.2f\n"</span>,area);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2：求一元二次方程的根</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">float</span> a,b,c,disc,x1,x2,p,q;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input number a,b,c!\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"a=%f,b=%f,c=%f"</span>,&amp;a,&amp;b,&amp;c); </span><br><span class="line">	disc=b*b<span class="number">-4</span>*a*c;</span><br><span class="line">	p=-b/(<span class="number">2</span>*a);</span><br><span class="line">	q=<span class="built_in">sqrt</span>(disc)/(<span class="number">2</span>*a);</span><br><span class="line">	x1=p+q;</span><br><span class="line">	x2=p-q;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nx1=%5.2f,x2=%5.2f"</span>,x1,x2);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="分支结构程序"><a href="#分支结构程序" class="headerlink" title="分支结构程序"></a>分支结构程序</h2><h3 id="关系运算符和表达式"><a href="#关系运算符和表达式" class="headerlink" title="关系运算符和表达式"></a>关系运算符和表达式</h3><ul>
<li>关系运算符：在程序中经常需要比较两个两的大小关系，以决定程序下一步的工作。比较两个两的运算符称为关系运算符。</li>
<li><code>C</code>语言运算符的优先级<blockquote>
<ul>
<li><code>()</code>（小括号）、<code>[]</code>（数组下标）、<code>.</code>（结构成员）、<code>-&gt;</code>（指针型结构成员）</li>
<li><code>!</code>（逻辑非）、<code>.</code>（位取反）、<code>-</code>（负号）、<code>++</code>（加1）、<code>--</code>（减1）、<code>&amp;</code>（变量地址）</li>
<li><code>*</code>（指针所指内容）、<code>type</code>（函数说明）、<code>sizeof</code>（长度计算）</li>
<li><code>*</code>（乘）、<code>/</code>（除）、<code>%</code>（取模）</li>
<li><code>+</code>（加）、<code>-</code>（减）</li>
<li><code>&lt;&lt;</code>（左移）、<code>&gt;&gt;</code>（右移）</li>
<li><code>&lt;</code>（小于）、<code>&gt;</code>（大于）、<code>&lt;=</code>（小于等于）、<code>&gt;=</code>（大于等于）</li>
<li><code>==</code>（等于）、<code>!=</code>（不等于）</li>
<li><code>&amp;</code>（位与）</li>
<li>…</li>
</ul>
</blockquote>
</li>
<li>优先级从下到上逐渐变高。</li>
<li>在C语言中有以下关系运算符</li>
</ul>
<table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>&lt;</td>
<td>小于</td>
</tr>
<tr>
<td>&lt;=</td>
<td>小于或等于</td>
</tr>
<tr>
<td>&gt;</td>
<td>大于</td>
</tr>
<tr>
<td>&gt;=</td>
<td>大于或等于</td>
</tr>
<tr>
<td>==</td>
<td>等于</td>
</tr>
<tr>
<td>!=</td>
<td>不等于</td>
</tr>
</tbody></table>
<ul>
<li><p>关系运算符都是双目运算符，结合性均为左结合。关系运算符的优先级低于算数运算符的优先级，高于赋值运算符。</p>
</li>
<li><p>在六个关系运算符中，前四个<code>&lt;</code>、<code>&lt;=</code>、<code>&gt;</code>、<code>&gt;=</code>的优先级相同，高于<code>==</code>和<code>!=</code>，<code>==</code>和<code>!=</code>优先级相同。</p>
</li>
<li><p>关系运算符的一般形式为：表达式 关系运算符 表达式</p>
</li>
<li><p>例如： a+b&gt;c-d; x.3/2;都是合法的关系运算符表达式。</p>
</li>
<li><p>关系运算符也可以出现嵌套的情况；例如 x&gt;(y&gt;z)；a!=(m==n)等都是合法的关系运算符表达式.</p>
</li>
<li><p>关系表达式的值是真还是假，用“1”和“0”表示。</p>
</li>
<li><p>如5&gt;3的值为真是1；（a=1）&gt; （a=3）的值为假，是0；</p>
</li>
<li><p>练习1</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> c=<span class="string">'k'</span>;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">1</span>,j=<span class="number">2</span>,k=<span class="number">3</span>;</span><br><span class="line">	<span class="keyword">float</span> x=<span class="number">3e+5</span>,y=<span class="number">0.85</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,<span class="string">'a'</span>+<span class="number">5</span>&lt;c,-i<span class="number">-2</span>*j &gt;= k+<span class="number">1</span>);<span class="comment">//1 0</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,<span class="number">1</span>&lt;j&lt;<span class="number">5</span>,x<span class="number">-5.25</span>&lt;=x+y);<span class="comment">//1  1</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%d"</span>,i+j+k==<span class="number">-2</span>*j,k==j==i+<span class="number">5</span>);<span class="comment">// 0 0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="逻辑运算符和表达式"><a href="#逻辑运算符和表达式" class="headerlink" title="逻辑运算符和表达式"></a>逻辑运算符和表达式</h3><ul>
<li><p>C语言提供了三种逻辑运算符：<code>&amp;&amp;</code>：与运算符；<code>||</code>：或运算符；<code>!</code>非运算符。</p>
</li>
<li><p>与运算符<code>&amp;&amp;</code>和或运算符<code>||</code>均为双目运算符，具有左结合性。非运算符<code>!</code>为单目运算符，具有右结合性。</p>
</li>
<li><p>逻辑运算符和其他运算符的的优先级关系如下：</p>
<blockquote>
<ul>
<li><code>!</code>—-&gt;<code>&amp;&amp;</code> —-&gt; <code>||</code></li>
</ul>
</blockquote>
</li>
<li><p>与运算符：同时为真即真，有假即假</p>
</li>
<li><p>或运算符：有真即真，全假为假</p>
</li>
<li><p>非运算符：与原来的相反。</p>
</li>
<li><p>逻辑表达式</p>
<blockquote>
<ul>
<li>一般形式： 表达式 逻辑运算符 表达式</li>
<li>其中的表达式可以又是逻辑表达式 ，从而组成了嵌套的情形。</li>
<li>例如（a&amp;&amp;v）&amp;&amp;c 具有左结合性。 </li>
</ul>
</blockquote>
</li>
<li><p>练习1：</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> c=<span class="string">'k'</span>;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">1</span>,j=<span class="number">2</span>,k=<span class="number">3</span>;</span><br><span class="line">	<span class="keyword">float</span> x=<span class="number">3e+5</span>,y=<span class="number">0.85</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,!x*!y,!!!x);<span class="comment">//0 0</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,x||i&amp;&amp;j<span class="number">-3</span>,i&lt;j&amp;&amp;x&lt;y);<span class="comment">//1 0</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,i==<span class="number">5</span>&amp;&amp;c&amp;&amp;(j=<span class="number">8</span>),x+y||x+j+k);<span class="comment">//0 1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h3><ul>
<li>用<code>if</code>语句可以构成分支结构。它根据给定的条件进行判断，以决定执行某个分支程序段。用C语言的if语句有三种基本形式。</li>
<li>第一种形式为基本形式：<blockquote>
<ul>
<li><code>if(表达式) 语句</code></li>
<li>其语义是：如果表达式的值为真，则执行其后的语句，否则不执行该语句。其过程为下图：</li>
</ul>
</blockquote>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">startID=&gt;start: 开始框</span><br><span class="line">inputoutputID=&gt;inputoutput: 输入输出框</span><br><span class="line">operationID=&gt;operation: 语句</span><br><span class="line">conditionID=&gt;condition: 表达式</span><br><span class="line">yes=&gt;operation: 语句</span><br><span class="line"></span><br><span class="line">endID=&gt;end: 结束框</span><br><span class="line"></span><br><span class="line">startID-&gt;inputoutputID</span><br><span class="line">inputoutputID-&gt;operationID</span><br><span class="line">operationID-&gt;conditionID</span><br><span class="line">conditionID(yes,bottom)-&gt;yes-&gt;endID</span><br><span class="line">conditionID(no)-&gt;endID</span><br></pre></td></tr></table></figure>

<ul>
<li>练习1：输入两个数，并输出最大的值</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,max;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\ninput two number:\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d"</span>,&amp;a,&amp;b);</span><br><span class="line">	max=a;</span><br><span class="line">	<span class="keyword">if</span>(max&lt;b)max=b;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"max=%d"</span>,max);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>第二种形式为基本形式：<blockquote>
<ul>
<li>第二种形式：if-else</li>
<li>if(表达式) 语句1;else 语句2;</li>
<li>其过程为下图：</li>
</ul>
</blockquote>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">startID=&gt;start: 开始框</span><br><span class="line">inputoutputID=&gt;inputoutput: 输入输出框</span><br><span class="line">operationID=&gt;operation: 语句</span><br><span class="line">conditionID=&gt;condition: 表达式</span><br><span class="line">true=&gt;operation: 语句1</span><br><span class="line">error=&gt;operation: 语句2</span><br><span class="line">endID=&gt;end: 结束框</span><br><span class="line"></span><br><span class="line">startID-&gt;inputoutputID-&gt;operationID-&gt;conditionID</span><br><span class="line">conditionID(yes)-&gt;true-&gt;endID</span><br><span class="line">conditionID(no,right)-&gt;error-&gt;endID</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2：输入两个数，并输出最大的值</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,max;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\ninput two number:\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d"</span>,&amp;a,&amp;b);</span><br><span class="line">	<span class="keyword">if</span>(a&gt;b)&#123;</span><br><span class="line">		max=a;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		max=b;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"max=%d"</span>,max);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>第三种形式为<code>if-else-if</code>形式<blockquote>
<ul>
<li>当出现多个分支时选择当前形式比较合适。</li>
<li>其一般形式： <code>if(表达式1) 语句1;else if(表达式2) 语句2;else 语句3;</code></li>
<li>流程图如下：</li>
</ul>
</blockquote>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">startID=&gt;start: 开始框</span><br><span class="line">inputoutputID=&gt;inputoutput: 输入输出框</span><br><span class="line">operationID=&gt;operation: 语句</span><br><span class="line">conditionID=&gt;condition: 表达式</span><br><span class="line">true1=&gt;operation: 语句1</span><br><span class="line">true2=&gt;operation: 语句2</span><br><span class="line">true3=&gt;operation: 语句3</span><br><span class="line">error=&gt;condition: 表达式</span><br><span class="line">error2=&gt;condition: 表达式</span><br><span class="line">endID=&gt;end: 结束框</span><br><span class="line"></span><br><span class="line">startID-&gt;inputoutputID-&gt;operationID-&gt;conditionID</span><br><span class="line">conditionID(yes)-&gt;true1-&gt;endID</span><br><span class="line">conditionID(no,right)-&gt;error</span><br><span class="line">error(yes)-&gt;true2-&gt;endID</span><br><span class="line">error(no,right)-&gt;error2</span><br><span class="line">error2(yes)-&gt;true3-&gt;endID</span><br></pre></td></tr></table></figure>

<ul>
<li>练习1</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> c;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input a character: "</span>);</span><br><span class="line">	c=getchar();</span><br><span class="line">	<span class="keyword">if</span>(c&lt;<span class="number">32</span>)<span class="built_in">printf</span>(<span class="string">"this is a control character\n"</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>)<span class="built_in">printf</span>(<span class="string">"this is a digit\n"</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(c&gt;=<span class="string">'A'</span>&amp;&amp;c&lt;=<span class="string">'Z'</span>)<span class="built_in">printf</span>(<span class="string">"this is a capital letter"</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(c&gt;=<span class="string">'a'</span>&amp;&amp;c&lt;=<span class="string">'z'</span>)<span class="built_in">printf</span>(<span class="string">"this is a small letter\n"</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"thi is an other character\n"</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>在使用if语句中还应该注意以下问题：</p>
<blockquote>
<ul>
<li>在三种形式的if语句中，在if关键字之后均为表达式。该表达式通常是逻辑表达式或关系表达式，但也可以是其他表达式，如赋值表达式等，甚至可以是一个变量。</li>
<li>例如： if(a=5)语句;  if(b) 语句; 都是允许的。</li>
<li>如果if后面有多个语句，需要用<code>{}</code>括起来。</li>
</ul>
</blockquote>
</li>
<li><p>补充例题1</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">* 输入一个分数score </span></span><br><span class="line"><span class="comment">* score&lt;60 输出D </span></span><br><span class="line"><span class="comment">* ...</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> score;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"please input a score:\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;score);</span><br><span class="line">	<span class="keyword">if</span>(score&lt;<span class="number">60</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"E"</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(score&lt;=<span class="number">75</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"D"</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(score&lt;=<span class="number">80</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"C"</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(score&lt;=<span class="number">90</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"B"</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(score&lt;=<span class="number">100</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"A"</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"输入有误"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>补充例题2</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 输入三个数，要求按小到大输出 </span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,c,t;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"please input three numbers:\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line">	<span class="keyword">if</span>(a&gt;b)&#123;</span><br><span class="line">		t=a;</span><br><span class="line">		a=b;</span><br><span class="line">		b=t;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(a&gt;c)&#123;</span><br><span class="line">		t=a;</span><br><span class="line">		a=c;</span><br><span class="line">		c=a;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(b&gt;c)&#123;</span><br><span class="line">		t=b;</span><br><span class="line">		b=c;</span><br><span class="line">		c=t;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"从小到大输出三个数：%d,%d,%d"</span>,a,b,c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>if语句的嵌套</p>
<blockquote>
<ul>
<li>当if语句中的执行语句又是if语句时，则构成了if语句的嵌套。</li>
<li>其一般形式为</li>
</ul>
</blockquote>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>)&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="number">2</span>) prntf(<span class="string">"2"</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"3"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="number">2</span>) prntf(<span class="string">"2"</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"3"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>在嵌套内的if语句可能又是if-else型，这将会出现多个if和多个else重叠的情况，这是需要特别注意if和else的配对问题。</li>
<li>else与它最近的if配对。</li>
<li>例题</li>
</ul>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"please input A,B："</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);</span><br><span class="line">	<span class="keyword">if</span>(a!=b)&#123;</span><br><span class="line">		<span class="keyword">if</span>(a&gt;b)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"A&gt;B\n"</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"A&lt;B\n"</span>);	</span><br><span class="line">		&#125; </span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"A=B\n"</span>);</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="条件运算符"><a href="#条件运算符" class="headerlink" title="条件运算符"></a>条件运算符</h3><ul>
<li><p>条件运算符为<code>?和:</code>，他是一个三目运算符，即有三个参与运算的量。</p>
</li>
<li><p>由条件运算符组成条件表达式的一般形式为：<code>表达式1?表达式2：:表达式3</code>；</p>
</li>
<li><p>其求值规则是：如果表达式的值为真，则执行表达式2的值，否知执行表达式3的值。</p>
</li>
<li><p>条件表达式通常运用于赋值语句之中。</p>
</li>
<li><p>使用条件运算符时，还应注意一下几点：</p>
<blockquote>
<ul>
<li>条件运算符的优先级低于关系运算符和算数运算符，但高于赋值运算符。</li>
<li>条件运算符?和:是一对运算符，不能拆开单独使用</li>
<li>条件运算符的结合方向是自右向左。</li>
</ul>
</blockquote>
</li>
<li><p>练习1</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> max,a,b;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n input two numbers： "</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d"</span>,&amp;a,&amp;b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"max=%d"</span>,a&gt;b?a:b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*输入一个字符，判断是否是大写字符，如果是，将大写字符转换成</span></span><br><span class="line"><span class="comment">* 小写字母；如果不是，不转换。然后输出 </span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> ch;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%c"</span>,&amp;ch);</span><br><span class="line">	ch=(ch&gt;=<span class="string">'A'</span> &amp;&amp; ch&lt;=<span class="string">'Z'</span>)?ch+<span class="number">32</span>:ch;</span><br><span class="line">	<span class="built_in">putchar</span>(ch); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Switch语句"><a href="#Switch语句" class="headerlink" title="Switch语句"></a>Switch语句</h3><ul>
<li>C语言还提供了另一种用于多分支选择的<code>switch</code>语句。其一般形式为</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(表达式)&#123;</span><br><span class="line">	<span class="keyword">case</span> 常量表达式<span class="number">1</span>: 语句<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">case</span> 常量表达式<span class="number">2</span>: 语句<span class="number">2</span>;</span><br><span class="line">	...</span><br><span class="line">	<span class="keyword">case</span> 常量表达式n: 语句n;</span><br><span class="line">	<span class="keyword">default</span> 语句n+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>其语义是：计算表达式的值。并逐个与其后面的常量表达式的值相比较，当表达式的值与某个常量表达式的值相等时，即执行其后的语句，然后不再进行判断，继续执行后面所有case语句。如表达式的值与所有case的值不相等时，则执行default后面的语句。</p>
</li>
<li><p>练习1 </p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input integer numbers: "</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a);</span><br><span class="line">	<span class="keyword">switch</span>(a)&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>:<span class="built_in">printf</span>(<span class="string">"Monday\n"</span>);</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:<span class="built_in">printf</span>(<span class="string">"Tuesay\n"</span>);</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:<span class="built_in">printf</span>(<span class="string">"Wednesday\n"</span>);</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:<span class="built_in">printf</span>(<span class="string">"Thursdau\n"</span>);</span><br><span class="line">		<span class="keyword">case</span> <span class="number">5</span>:<span class="built_in">printf</span>(<span class="string">"Friday\n"</span>);</span><br><span class="line">		<span class="keyword">case</span> <span class="number">6</span>:<span class="built_in">printf</span>(<span class="string">"Saturday\n"</span>);</span><br><span class="line">		<span class="keyword">case</span> <span class="number">7</span>:<span class="built_in">printf</span>(<span class="string">"Sunday\n"</span>);</span><br><span class="line">		<span class="keyword">default</span>: <span class="built_in">printf</span>(<span class="string">"error!\n"</span>); </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>存在一个问题，就是输入3之后，后面的语句也跟着输出。</li>
<li>练习2：对上述问题进行改进</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input integer numbers: "</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a);</span><br><span class="line">	<span class="keyword">switch</span>(a)&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>:<span class="built_in">printf</span>(<span class="string">"Monday\n"</span>);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:<span class="built_in">printf</span>(<span class="string">"Tuesay\n"</span>);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:<span class="built_in">printf</span>(<span class="string">"Wednesday\n"</span>);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:<span class="built_in">printf</span>(<span class="string">"Thursdau\n"</span>);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">5</span>:<span class="built_in">printf</span>(<span class="string">"Friday\n"</span>);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">6</span>:<span class="built_in">printf</span>(<span class="string">"Saturday\n"</span>);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">7</span>:<span class="built_in">printf</span>(<span class="string">"Sunday\n"</span>);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>: <span class="built_in">printf</span>(<span class="string">"error!\n"</span>); </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在使用<code>swicth</code>时还应该注意以下几点：<blockquote>
<ul>
<li>在case后的各常量表达式的值不能相同，否则会出现错误；</li>
<li>在case后，允许有多个语句，可以不同<code>{}</code>括起来；</li>
<li>各case和default子句的先后顺序可以变动，而不会影响程序结果；</li>
<li>defaule语句可以省略不同； </li>
</ul>
</blockquote>
</li>
<li>练习1</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//输入三个整数，输出最大数和最小数 </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,c,min,max;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input three numbers: "</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line">	<span class="keyword">if</span>(a&gt;b)&#123;</span><br><span class="line">		max=a;</span><br><span class="line">		min=b;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		max=b;</span><br><span class="line">		min=a;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(max&lt;c)&#123;</span><br><span class="line">		max=c;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(min&gt;c)&#123;</span><br><span class="line">			min=c;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"max=%d,min=%d\n"</span>,max,min);</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">//模拟计算器</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">float</span> a,b;</span><br><span class="line">	<span class="keyword">char</span> c;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input expression:a+(+,-,*,/)b\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%f%c%f"</span>,&amp;a,&amp;c,&amp;b);</span><br><span class="line">	<span class="keyword">switch</span>(c)&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'+'</span>:<span class="built_in">printf</span>(<span class="string">"%f%c%f=%f\n"</span>,a,c,b,a+b);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'-'</span>:<span class="built_in">printf</span>(<span class="string">"%f%c%f=%f\n"</span>,a,c,b,a-b);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'*'</span>:<span class="built_in">printf</span>(<span class="string">"%f%c%f=%f\n"</span>,a,c,b,a*b);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'/'</span>:<span class="built_in">printf</span>(<span class="string">"%f%c%f=%f\n"</span>,a,c,b,a/b);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>: <span class="built_in">printf</span>(<span class="string">"input error\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习3</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">//输入一个年份，判断是平年还是闰年</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> year;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input year: \n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;year);</span><br><span class="line">	<span class="keyword">if</span>(year%<span class="number">4</span>==<span class="number">0</span> &amp;&amp; year%<span class="number">100</span>!=<span class="number">0</span> || year%<span class="number">400</span>==<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"闰年"</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"平年"</span>); </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习4：公司对运输公司计算运费</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123; </span><br><span class="line">	<span class="keyword">int</span> s,c;<span class="comment">//s-&gt;距离 ;c 表达式常量 </span></span><br><span class="line">	<span class="keyword">double</span> d,p,w,f;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input s:\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%lf,%lf"</span>,&amp;s,&amp;p,&amp;w);</span><br><span class="line">	<span class="keyword">if</span>(s&gt;=<span class="number">3000</span>)&#123;</span><br><span class="line">		c=<span class="number">12</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		c=s/<span class="number">250</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,c);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">switch</span>(c)&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">0</span>:d=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>:d=<span class="number">2</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:d=<span class="number">5</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="number">7</span>:d=<span class="number">8</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="number">11</span>:d=<span class="number">10</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">12</span>:d=<span class="number">15</span>;<span class="keyword">break</span>;	</span><br><span class="line">	&#125; </span><br><span class="line">	f=p*w*s*(<span class="number">1</span>-d/<span class="number">100</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%15.4lf"</span>,f);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习5 :一个整数，它加上一百后是一个完全平方数，再加上168后又是一个整数，请问该数字是什么</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSize 100000</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">int</span> i,x,y;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">-100</span>;i&lt;MAXSize;i++)&#123;</span><br><span class="line">		x=<span class="built_in">sqrt</span>(i+<span class="number">100</span>);</span><br><span class="line">		y=<span class="built_in">sqrt</span>(i+<span class="number">268</span>);	</span><br><span class="line">		<span class="keyword">if</span>((x*x==i+<span class="number">100</span>) &amp;&amp;(y*y==i+<span class="number">268</span>))&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%ld\t"</span>,i);</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习6：输入某年某月某日，判断是第几天<blockquote>
<p>解法1</p>
</blockquote>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> year,month,day;<span class="comment">//年月日</span></span><br><span class="line">	<span class="keyword">int</span> sum=<span class="number">0</span>,i,j;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"请分别输入年，月，日：\n"</span>); </span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d,%d"</span>,&amp;year,&amp;month,&amp;day); </span><br><span class="line">	<span class="keyword">if</span>(month==<span class="number">1</span>)&#123;</span><br><span class="line">		sum=sum+day;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;month;j++)&#123;</span><br><span class="line">			<span class="keyword">switch</span>(j)&#123;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">12</span>:i=<span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">11</span>:i=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">					<span class="keyword">if</span>((year%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;year%<span class="number">100</span>!=<span class="number">0</span>)||(year%<span class="number">400</span>==<span class="number">0</span>))&#123;</span><br><span class="line">						i=<span class="number">-1</span>;</span><br><span class="line">					&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">						i=<span class="number">-2</span>;</span><br><span class="line">					&#125; </span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">default</span>: <span class="built_in">printf</span>(<span class="string">"input error"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			sum = sum + <span class="number">30</span>+i;</span><br><span class="line">		&#125;</span><br><span class="line">		sum =sum+day;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d年%d月%d日是本年第%d天"</span>,year,month,day,sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>解法2</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> year,month,day;<span class="comment">//年月日</span></span><br><span class="line">	<span class="keyword">int</span> sum=<span class="number">0</span>,i,j;</span><br><span class="line">	<span class="keyword">int</span> data[<span class="number">12</span>]=&#123;<span class="number">31</span>,<span class="number">28</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>&#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"请分别输入年，月，日：\n"</span>); </span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d,%d"</span>,&amp;year,&amp;month,&amp;day); </span><br><span class="line">	<span class="keyword">if</span>((year%<span class="number">4</span>==<span class="number">0</span> &amp;&amp; year%<span class="number">100</span>!=<span class="number">0</span>)|| (year%<span class="number">400</span>==<span class="number">0</span>))&#123;</span><br><span class="line">		data[<span class="number">1</span>]=data[i]+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;month;i++)&#123;</span><br><span class="line">		sum += data[i];</span><br><span class="line">	&#125;</span><br><span class="line">	sum+=day;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d年%d月%d日是本年第%d天"</span>,year,month,day,sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="循环控制结构程序"><a href="#循环控制结构程序" class="headerlink" title="循环控制结构程序"></a>循环控制结构程序</h2><ul>
<li><p>什么事循环？</p>
</li>
<li><p>为什么要使用循环？</p>
<blockquote>
<p>循环结构是程序中一种很重要的结构。其特点是：在给定条件成立时，反复执行某程序段，直到条件不成为止。给定的条件称为循环条件，反复执行的程序段称为循环体。C语言中提供了多种循环语句，可以组成各种不同形式的循环结构。</p>
</blockquote>
</li>
<li><p>用goto语句和if语句构成循环体。</p>
</li>
<li><p>用while语句</p>
</li>
<li><p>用do-while语句</p>
</li>
<li><p>用fo语句</p>
<h3 id="goto语句以及goto语句构成循环"><a href="#goto语句以及goto语句构成循环" class="headerlink" title="goto语句以及goto语句构成循环"></a>goto语句以及goto语句构成循环</h3></li>
<li><p>goto语句是一种无条件转移语句，与<code>BASIC</code>中的<code>goto</code>语句相似。</p>
</li>
<li><p>goto语句的使用格式为：</p>
<blockquote>
<p>goto 语句标号;</p>
</blockquote>
</li>
<li><p>其中标号是一个有效的标识符，这个标号符加上一个“:”一起出现在函数内某处，执行goto语句后，程序将跳转到该标号处并执行其后的语句，另外标号必须与goto语句同处于一个函数中，但可以不再同一个循环层中。通常goto语句与if语句连用，当满足某一个条件时，程序将跳转到该标号处运行。</p>
</li>
<li><p>但是注意：goto语句通常不用，主要是因为它将使程序层次不清，但在多层嵌套退出时，用goto语句则比较合理。</p>
</li>
<li><p>练习1 用goto和if语句构成循环体，计算1+2+…100的值</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">//计算1+2+...+100 </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,sum=<span class="number">0</span>;</span><br><span class="line">	i=<span class="number">1</span>;</span><br><span class="line">	loop:<span class="keyword">if</span>(i&lt;=<span class="number">100</span>)&#123;</span><br><span class="line">		sum=sum+i;</span><br><span class="line">		i++;</span><br><span class="line">		<span class="keyword">goto</span> loop;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="while语句"><a href="#while语句" class="headerlink" title="while语句"></a>while语句</h3><ul>
<li>while语句的一般形式为：<blockquote>
<p><code>while(表达式) 语句;</code></p>
</blockquote>
</li>
<li>其中表达式是循环条件，语句是循环体。</li>
<li>while语句的语义是：计算表达式的值，当值为真（非0）时，执行循环体语句。其执行过程如下图所示：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">st=&gt;start: Start</span><br><span class="line">op=&gt;operation: Your Operation</span><br><span class="line">cond=&gt;condition: 表达式</span><br><span class="line">e=&gt;end</span><br><span class="line"></span><br><span class="line">st-&gt;cond</span><br><span class="line">cond(yes,bottom)-&gt;op-&gt;e</span><br><span class="line">cond(no)-&gt;e</span><br></pre></td></tr></table></figure>

<ul>
<li>注意：如果表达式的值一开始就是0，则语句一次也不会被执行。</li>
<li>练习1 计算1+2+3+…100的值</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sum=<span class="number">0</span>,i=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(i&lt;=<span class="number">100</span>)&#123;</span><br><span class="line">		sum+=i;</span><br><span class="line">		i++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2：传说中的死循环</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sum=<span class="number">0</span>,i=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(i&lt;=<span class="number">100</span>)<span class="comment">//&#123;</span></span><br><span class="line">		sum+=i;</span><br><span class="line">		i++;</span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习3 统计从键盘输入一行字符的个数</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input a string:\n"</span>);</span><br><span class="line">	<span class="keyword">while</span>(getchar()!=<span class="string">'\n'</span>)&#123;</span><br><span class="line">		n++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>使用while表达式应注意如下几点：<blockquote>
<ul>
<li>while语句中的表达式一般是关系表达式或逻辑表达式，只要表达式的值为真即可继续循环。案例如下：</li>
</ul>
</blockquote>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n,a=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\ninput n: "</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">	<span class="keyword">while</span>(n--)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,a++*<span class="number">2</span>);</span><br><span class="line">		<span class="comment">// n = 2 /0/1</span></span><br><span class="line">		<span class="comment">//n=1 /2/2</span></span><br><span class="line">		<span class="comment">//n=0</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>循环体如果包括有一个以上的语句，则必须用<code>{}</code>括起来，组成复合语句。</li>
</ul>
</blockquote>
<h3 id="do-while语句"><a href="#do-while语句" class="headerlink" title="do-while语句"></a>do-while语句</h3><ul>
<li>do-while语句的一般形式：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span></span><br><span class="line">	语句</span><br><span class="line"><span class="keyword">while</span>(表达式);</span><br></pre></td></tr></table></figure>

<ul>
<li>这个循环与whiile循环的不同在于：它先执行循环中的语句，然后再进行判断表达式的值是否为真，如果为真则继续执行循环，如果为假，则终止循环。因此，do-while循环至少要执行一次循环语句。</li>
<li>do-while的执行流程如下</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">st=&gt;start: start</span><br><span class="line">op=&gt;operation: 循环体语句</span><br><span class="line">cond=&gt;condition: 表达式</span><br><span class="line">e=&gt;end</span><br><span class="line"></span><br><span class="line">st-&gt;op-&gt;cond</span><br><span class="line">cond(yes)-&gt;op</span><br><span class="line">cond(no,bottom)-&gt;e</span><br></pre></td></tr></table></figure>

<ul>
<li>练习： 计算1到100之间之和;</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">1</span>,sum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">do</span>&#123;</span><br><span class="line">		sum+=i;</span><br><span class="line">		i++;</span><br><span class="line">	&#125;<span class="keyword">while</span>(i&lt;=<span class="number">100</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="for语句"><a href="#for语句" class="headerlink" title="for语句"></a>for语句</h3><ul>
<li>在C语言中，for语句使用最灵活，它完全可以取代while语句。</li>
<li>其一般形式：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(b表达式<span class="number">1</span>;表达式<span class="number">2</span>;表达式<span class="number">3</span>)&#123;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>它的执行过程如下：<blockquote>
<ul>
<li>先求解表达式1；</li>
<li>再求解表达式2，若其值为真（非0），则执行<code>for</code>语句中指定的内嵌语句，然后再执行表达式3，如果表达式3能够满足表达式2的，则继续执行循环体，直到条件不满足结束循环为止。如果不满足结束循环。</li>
</ul>
</blockquote>
</li>
<li>for语句最简单的应用形式也是最简单的理解形式如下：<blockquote>
<ul>
<li><code>for(循环变量赋初值;循环条件;循环变量增量) 语句;</code></li>
</ul>
</blockquote>
</li>
<li>循环变量赋初值总是一个赋值语句，他用来给循环控制变量赋初值；循环条件是一个关系表达式，它决定什么时候跳出循环体；循环增量。定义循环控制变量每次循环后按什么方式变化。这三个部分之间用<code>;</code>分开。</li>
<li>练习1 计算1-100之间的和</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,sum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">100</span>;i++)&#123;</span><br><span class="line">		sum+=i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>表达式1，表达式2，表达式均可以省略</li>
<li>练习2</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> ch;</span><br><span class="line">	<span class="keyword">for</span>(;(ch=getchar())!=<span class="string">'\n'</span>;)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%c\n"</span>,ch);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="循环的嵌套"><a href="#循环的嵌套" class="headerlink" title="循环的嵌套"></a>循环的嵌套</h3><ul>
<li>练习1</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,k,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">2</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">2</span>;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;<span class="number">2</span>;k++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%d %d %d\n"</span>,i,j,k);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">/**********</span></span><br><span class="line"><span class="comment">输出如下图案： </span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">***</span></span><br><span class="line"><span class="comment">****</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">**********/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,n;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input n: \n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=i;j++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"*"</span>);</span><br><span class="line">		&#125; </span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="四种循环的比较"><a href="#四种循环的比较" class="headerlink" title="四种循环的比较"></a>四种循环的比较</h3><ul>
<li><p>四种循环中都可以用来处理同一问题，一般情况下它们可以相互替换。但一般不提倡用goto型循环。</p>
</li>
<li><p>在while循环和do-while循环中，只在while后面的括号内指定循环条件，因此为了使循环正常结束，应在循环体中包含使循环趋于结束的语句。（如i++，或i=i+1等）。</p>
</li>
<li><p>for循环可以在表达式3中包含使循环体趋于结束的操作，甚至可以将循环体中的操作全部放到表达式3中，因此for语句的功能更强，凡是能用while循环完成的，用for循环都能实现。</p>
</li>
<li><p>用while语句和do-while循环时，循环变量初始化的操作应该在while和do-while语句之前完成而for语句可以在表达式1中实现循环变量的初始化。</p>
</li>
<li><p>while循环、do-while循环和for循环，可以使用break跳出循环，用continue语句结束本次循环。而用goto语句和if语句构成的循环，不能用Break和continue语句进行控制。</p>
</li>
<li><p>练习：有1,2,3,4四个数字，能组成多少个互不相同且无重复的三位数；</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,k;</span><br><span class="line">	<span class="keyword">int</span> sum;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">4</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=<span class="number">4</span>;j++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(k=<span class="number">1</span>;k&lt;=<span class="number">4</span>;k++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(i!=j&amp;&amp;i!=k&amp;&amp;j!=k)&#123;</span><br><span class="line">					sum=i*<span class="number">100</span>+j*<span class="number">10</span>+k;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,sum);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="break和continue语句"><a href="#break和continue语句" class="headerlink" title="break和continue语句"></a>break和continue语句</h3><ul>
<li>break语句可以用来从循环体内跳出循环体，即提前结束循环，接着执行下面的语句。</li>
<li>一般形式为：<code>break;</code></li>
<li>break语句不能用于循环语句和switch语句之外的任何其他语句中。</li>
<li>注意：<blockquote>
<ul>
<li>break语句对if-else的条件语句不起作用。</li>
<li>在多层循环中，一个break语句只向外跳一层。</li>
</ul>
</blockquote>
</li>
<li>练习1</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> r;</span><br><span class="line">	<span class="keyword">float</span> pi=<span class="number">3.14159</span>,area;</span><br><span class="line">	<span class="keyword">for</span>(r=<span class="number">1</span>;r&lt;<span class="number">10</span>;r++)&#123;</span><br><span class="line">		area=r*r*pi;</span><br><span class="line">		<span class="keyword">if</span>(area&gt;<span class="number">100</span>)&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"r=%d,area=%f\n"</span>,r,area);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"conio.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ch;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">while</span>(ch=getch())&#123; <span class="comment">//ch：从控制台读取一个字符，但不显示在屏幕上。</span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ch);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习3</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"conio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">0</span>;<span class="keyword">char</span> c;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		c=<span class="string">'\0'</span>;</span><br><span class="line">		<span class="keyword">while</span>(c!=<span class="number">13</span>&amp;&amp;c!=<span class="number">27</span>)&#123;</span><br><span class="line">			c=getch();</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%c\n"</span>,c);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(c==<span class="number">27</span>)&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		i++;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"The No. is %d"</span>,i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"The end"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>continue语句<blockquote>
<ul>
<li>作为结束本次循环，即跳过循环体中下面尚未执行的语句，接着进行下一次是否执行循环的判断。</li>
<li>一般形式：<code>continue;</code></li>
</ul>
</blockquote>
</li>
<li>continue语句与break语句的区别：<blockquote>
<ul>
<li>continue是结束当前循环，进行下一步是否循环的判断。</li>
<li>break则是直接结束当前循环。</li>
</ul>
</blockquote>
</li>
<li>练习4</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"conio.h"</span></span></span><br><span class="line"><span class="comment">/*********************************************************</span></span><br><span class="line"><span class="comment">案例实现：当按下键盘就输出该值，如果按esc则跳出则结束输入，</span></span><br><span class="line"><span class="comment">如果按下enter健则不显示...................................</span></span><br><span class="line"><span class="comment">**********************************************************/</span> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> ch;</span><br><span class="line">	<span class="keyword">for</span>(;;)&#123;</span><br><span class="line">		ch=getch();</span><br><span class="line">		<span class="keyword">if</span>(ch==<span class="number">27</span>)&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(ch==<span class="number">13</span>)&#123;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		putch(ch);<span class="comment">//输出按下的键盘值 </span></span><br><span class="line">	&#125;</span><br><span class="line">	getch();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习5 把100-200之间不能被3整除的数全部输出</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"conio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">100</span>;</span><br><span class="line">	<span class="keyword">for</span>(i;i&lt;=<span class="number">200</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(i%<span class="number">3</span>==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="循环的相关练习"><a href="#循环的相关练习" class="headerlink" title="循环的相关练习"></a>循环的相关练习</h3><ul>
<li>练习1 求π的近似值</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//求解方式1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"math.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> s=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">float</span> n=<span class="number">1.0</span>,t=<span class="number">1</span>,pi=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">fabs</span>(t)&gt;<span class="number">1e-6</span>)&#123;</span><br><span class="line">		pi=pi+t;</span><br><span class="line">		n=n+<span class="number">2</span>;</span><br><span class="line">		s=-s;</span><br><span class="line">		t=<span class="number">1.0</span>*s/n;</span><br><span class="line">	&#125;</span><br><span class="line">	pi=pi*<span class="number">4</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%f"</span>,pi);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//求解方式2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="comment">//求π的近似值</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">float</span> sum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;<span class="number">1.0</span>/(<span class="number">2</span>*i<span class="number">-1</span>)&gt;<span class="number">1e-6</span>;i++)&#123;</span><br><span class="line">	</span><br><span class="line">		<span class="keyword">if</span>(i%<span class="number">2</span>!=<span class="number">0</span>)&#123;</span><br><span class="line">			sum=sum+<span class="number">1.0</span>/(<span class="number">2</span>*i<span class="number">-1</span>);</span><br><span class="line">	</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			sum=sum<span class="number">-1.0</span>/(<span class="number">2</span>*i<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%f"</span>,sum*<span class="number">4</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2 </li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//解法1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">int</span> f1,f2;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	f1=<span class="number">1</span>;f2=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=<span class="number">20</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%12ld%12ld"</span>,f1,f2);</span><br><span class="line">		<span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		f1=f1+f2;</span><br><span class="line">		f2=f1+f2;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//解法2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Fn</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n==<span class="number">1</span>||n==<span class="number">2</span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> Fn(n<span class="number">-1</span>)+Fn(n<span class="number">-2</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">40</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d\t"</span>,Fn(i));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>练习3<br>//解法1</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">/************************************************</span></span><br><span class="line"><span class="comment">       输入一个数字m，判断m是否为素数</span></span><br><span class="line"><span class="comment">************************************************/</span> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> m,i,j=<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input m="</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;m;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(m%i==<span class="number">0</span>)&#123;</span><br><span class="line">			j=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(j)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d是一个素数\n"</span>,m);</span><br><span class="line">	&#125; <span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d不是一个素数\n"</span>,m);</span><br><span class="line">	&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//解法2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> m,i,k;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line">	k=<span class="built_in">sqrt</span>(m);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;=k;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(m%i==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">if</span>(i&gt;k)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d是一个素数\n"</span>,m);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d不是一个素数\n"</span>,m);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>练习4 输出1-100之间的素数</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(j=<span class="number">2</span>;j&lt;=<span class="number">100</span>;j++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;<span class="built_in">sqrt</span>(j);i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(j%i==<span class="number">0</span>)&#123;</span><br><span class="line">				<span class="keyword">break</span>; </span><br><span class="line">			&#125; </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(i&gt;<span class="built_in">sqrt</span>(j))&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,j);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>练习5 译密码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">char</span> ch;</span><br><span class="line">	<span class="keyword">char</span> chs;</span><br><span class="line">	<span class="keyword">while</span>((ch=getchar())!=<span class="string">'\0'</span>)&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(ch&gt;=<span class="string">'a'</span> &amp;&amp; ch&lt;=<span class="string">'z'</span> || ch&gt;=<span class="string">'A'</span> &amp;&amp; ch&lt;=<span class="string">'Z'</span> )&#123;</span><br><span class="line">			<span class="keyword">switch</span>(ch)&#123;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'x'</span>: chs=<span class="string">'a'</span>;<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'y'</span>: chs=<span class="string">'b'</span>;<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'z'</span>: chs=<span class="string">'c'</span>;<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'X'</span>: chs=<span class="string">'A'</span>;<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'Y'</span>: chs=<span class="string">'B'</span>;<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'Z'</span>: chs=<span class="string">'C'</span>;<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">default</span>:chs=ch+<span class="number">4</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			chs=ch;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%c"</span>,chs);</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>练习6</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="meta-keyword">define</span> N 7</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    *  </span></span><br><span class="line"><span class="comment">   ***</span></span><br><span class="line"><span class="comment">  *****</span></span><br><span class="line"><span class="comment"> *******</span></span><br><span class="line"><span class="comment">  *****</span></span><br><span class="line"><span class="comment">   ***   </span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=N/<span class="number">2</span>+<span class="number">1</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=<span class="number">4</span>-i;j++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=(<span class="number">2</span>*i<span class="number">-1</span>);j++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"*"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">3</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=i;j++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=N-(<span class="number">2</span>*i);j++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"*"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><ul>
<li>有如下几组数据，它们分别该如何存储呢？<blockquote>
<ul>
<li>学生的学习成绩;</li>
<li>银行的账单</li>
<li>一行文字</li>
</ul>
</blockquote>
</li>
<li>这些数据的特点是：<blockquote>
<ul>
<li>具有相同的数据类型</li>
<li>使用过程中需要保留原始数据。</li>
</ul>
</blockquote>
</li>
<li>C语言中为这些数据，提供了一种构造数据类型，数组。 </li>
<li>在程序设计中，为了方便处理，把具有相同类型的若干变量按有序的形式组织起来。这些按序排列的同类数据元素的集合称为数组。</li>
<li>在C语言中，数组是属于构造数据类型。</li>
<li>数组：具有相同类型的数据组成的序列，是有序集合。</li>
<li>数组中的每一个数据称为：数组元素、下标变量。</li>
<li>数组元素：由其所在的位置序号（数组元素的下标）来区分。</li>
<li>用数组名与下标可以用统一的方式来处理数组中的所有元素，从而方便的实现处理一批具有相同性质数据的问题。</li>
<li>注意：数组元素有序不是指元素大小有序。<h3 id="一维数组的定义和引用"><a href="#一维数组的定义和引用" class="headerlink" title="一维数组的定义和引用"></a>一维数组的定义和引用</h3></li>
<li>在C语言中使用数组必须先进行定义。</li>
<li>一维数组的定义方式： <code>类型说明符 数组名[常量表达式]</code></li>
<li>例如：int a[10];</li>
<li>它表示定义了一个整形数组，数组名为a，此数组有10个元素，10个元素都是整型变量。</li>
<li>需要注意的是：<blockquote>
<ul>
<li>类型说明符是任意一种基本数据类型或者构造数组类型。对于同一个数组，其所有元素的数据类型都是相同的。</li>
<li>数组名是用户定义的数组标识符。书写规则应符合标识符的书写规则。</li>
<li>方括号中的常量表达式表示数据元素的个数，也称为数组长度。</li>
<li>允许在通一个类型说明中，说明多个数组和多个变量。例如：<code>int a,b,c,k[200],j[10];</code></li>
<li>a[10]，表示数组a有10个元素，注意下标是从0开始，这10个元素是<code>a[0],a[1]...a[9]</code>。按上面定义，不存在数据元素<code>a[10]</code>；</li>
<li>c语言中不允许对数组的大小做动态定义，即数组的大小不依赖于程序运行过程中变量的值。例如下面定义数组是不允许的 </li>
</ul>
</blockquote>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">int</span> a[n];</span><br></pre></td></tr></table></figure>

<ul>
<li><p>一维数组在内存中的存放</p>
</li>
<li><p>一维数组的引用：</p>
<blockquote>
<ul>
<li>数组元素是组成数组的基本单位。数据元素也是一种基本变量，其标识方法为数组名后跟一个下标。下标表示了元素在数组中的顺序号。</li>
<li>数组元素的一般形式为：<code>数组名[下标]</code>（下标可以是整型常量或整型表达式）</li>
<li>例如：a[0] = a[5]+a[7]+a[2*3]、a[i+j]、a[i++]都是合法的数组元素。</li>
</ul>
</blockquote>
</li>
<li><p>一维数组元素的引用的一些注意的事项：</p>
<blockquote>
<ul>
<li>数组元素通常也称为下标变量。必须先定义数组，才能使用下标变量。在C语言中只能逐个使用下标变量，而不能一次性使用整个数组。</li>
<li>定义数组时用到的<code>数组名[常量表达式]</code>和用用数组元素时使用到的<code>数组名[常量表达式]</code>有区别。</li>
</ul>
</blockquote>
</li>
<li><p>一维数组的初始化</p>
<blockquote>
<ul>
<li>给数组赋值的方法除了赋值语句之外，还可以采用初始化赋值和动态赋值的方法。</li>
<li>数组初始化赋值是指在数组定义时给数组元素赋予初值。</li>
<li>数组初始化是在编译阶段进行的。这样将减少运行时间，提高效率。</li>
<li>注意：之前用赋值语句或输入语句也可给数组元素指定初值，是在运行时完成的。</li>
<li>初始化赋值的一般形式为： <code>类型说明符 数组名[常量表达式]={值,值...,值}</code>; </li>
</ul>
</blockquote>
</li>
<li><p>练习1</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,a[<span class="number">5</span>]=&#123;<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;,b[<span class="number">5</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n array a is:"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)<span class="built_in">printf</span>(<span class="string">"%6d"</span>,a[i]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n array b is:"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)<span class="built_in">printf</span>(<span class="string">"%6d"</span>,b[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2 输入10个数，并把最大的数输出</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,max,a[<span class="number">10</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input 10 numbers:\n"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	max=a[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(max&lt;a[i]) max=a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"max=%d"</span>,max);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习3： 利用数组来处理、求解<code>Fibonacci数列</code>;把前20个项的值存放在数组中</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">20</span>],i;</span><br><span class="line">	a[<span class="number">0</span>]=a[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;<span class="number">20</span>;i++)&#123;</span><br><span class="line">		a[i]=a[i<span class="number">-1</span>]+a[i<span class="number">-2</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">20</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习4：冒泡排序</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">10</span>]=&#123;<span class="number">12</span>,<span class="number">26</span>,<span class="number">32</span>,<span class="number">25</span>,<span class="number">11</span>,<span class="number">56</span>,<span class="number">96</span>,<span class="number">48</span>,<span class="number">36</span>,<span class="number">66</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> i,j,t;</span><br><span class="line">	<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">9</span>;j++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">9</span>-j;i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i]&gt;a[i+<span class="number">1</span>])&#123;</span><br><span class="line">				t=a[i];</span><br><span class="line">				a[i]=a[i+<span class="number">1</span>];</span><br><span class="line">				a[i+<span class="number">1</span>]=t;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="二维数组的定义和引用"><a href="#二维数组的定义和引用" class="headerlink" title="二维数组的定义和引用"></a>二维数组的定义和引用</h3><ul>
<li>二维数组的定义<blockquote>
<ul>
<li>二维数组定义的一般形式为：<code>类型说明符 数组名[常量表达式][常量表达式];</code></li>
<li>例如：定义a为3×4的数组，b为5×10的数组如下：<code>float a[3][4],a[5][10]</code></li>
<li>我们可以将二维数组看成是一种特殊的一维数组：它的元素又是一个一维数组。</li>
<li>二维数组在概念上二维的，但是，实际的硬盘存储器却是连续编址的，也就是说存储器单元是按一维线性排列的。</li>
<li>如何在一维存储器中存放二维数组，可有两种方式：一种是按行排。另一种是按列排列。</li>
</ul>
</blockquote>
</li>
<li>二维数组的引用和初始化<blockquote>
<ul>
<li>数据类型 <code>数组名[常量表达式1][常量表达式2] ={初始化数据}</code>;</li>
</ul>
</blockquote>
</li>
<li>我们有4种方法对二维数组初始化：<blockquote>
<ul>
<li>直接分行给二维数组赋初值</li>
<li>可以将所有数据写在一个花括号内，按数组排列的顺序对各元素赋初值</li>
<li>可以对部分元素赋初值</li>
<li>可以对各行中的某一元素赋初值。</li>
<li><code>a[][]</code>：第一维长度可以省略，第二维长度不可以省略。</li>
</ul>
</blockquote>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span>(0) </span></span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">3</span>][<span class="number">4</span>]=&#123;&#123;<span class="number">1</span>&#125;,&#123;<span class="number">5</span>&#125;,&#123;<span class="number">9</span>&#125;&#125;;<span class="comment">//这样初始化的是每一行的第一个元素 </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">3</span>][<span class="number">4</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习1 计算平均分</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,sum=<span class="number">0</span>,average,v[<span class="number">3</span>];</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">5</span>][<span class="number">3</span>]=&#123;&#123;<span class="number">80</span>,<span class="number">75</span>,<span class="number">92</span>&#125;,&#123;<span class="number">61</span>,<span class="number">65</span>,<span class="number">71</span>&#125;,&#123;<span class="number">59</span>,<span class="number">63</span>,<span class="number">70</span>&#125;,&#123;<span class="number">85</span>,<span class="number">87</span>,<span class="number">90</span>&#125;,&#123;<span class="number">76</span>,<span class="number">77</span>,<span class="number">85</span>&#125;&#125;;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123; <span class="comment">//表示科目</span></span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">5</span>;j++) <span class="comment">// 表示成绩 </span></span><br><span class="line">		&#123;	</span><br><span class="line">			sum = sum + a[j][i];</span><br><span class="line">		&#125;</span><br><span class="line">		v[i]=sum/<span class="number">5</span>;</span><br><span class="line">		sum=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	average = (v[<span class="number">0</span>]+v[<span class="number">1</span>]+v[<span class="number">2</span>])/<span class="number">3</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"math:%d\nc language:%d\ndFoxpro:%d\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>],v[<span class="number">2</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"total:%d\n"</span>,average);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习2：将数组的行和列对换</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">2</span>][<span class="number">3</span>] = &#123;&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;,&#123;<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>&#125;&#125;;</span><br><span class="line">	<span class="keyword">int</span> b[<span class="number">3</span>][<span class="number">2</span>];</span><br><span class="line">	<span class="keyword">int</span> i,j;       </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"output array a:\n"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">2</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">3</span>;j++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\t"</span>,a[i][j]);</span><br><span class="line">			b[j][i]=a[i][j];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"output array b:\n"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">2</span>;j++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\t"</span>,b[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习3：输入一个二维数组，并输出其中最大的一个数，并把该数的行和列输出。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">	<span class="keyword">int</span> i,j,column,row,max;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input number:\n"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">3</span>;j++)&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	max=a[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">3</span>;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(max&lt;a[i][j])&#123;</span><br><span class="line">				 max=a[i][j];</span><br><span class="line">				 column=j;</span><br><span class="line">				 row=i;</span><br><span class="line">			&#125;	</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"column=%d,row=%d,max=%d"</span>,column,row,max);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习4：输入3*3数组，只输出指定位置的数组</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input number:\n"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">3</span>;j++)&#123;</span><br><span class="line">		<span class="comment">//	printf("a[%d][%d]=",i,j);</span></span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">3</span>;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(j==<span class="number">1</span> || i==<span class="number">1</span>)&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%-6d"</span>,a[i][j]);	</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%-6c"</span>,<span class="string">' '</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="二分法"><a href="#二分法" class="headerlink" title="二分法"></a>二分法</h3><ul>
<li>利用数组进行数据查找 – 二分法</li>
<li>适用情况：在一批有序数据中查找某数。</li>
<li>原理：选定某个数，先与数组的中间数进行比较，如果大于中间数，去掉包括中间之前的数字，在剩下的数据中再次以同样的方法进行查找，直到找到该数为止。如果小于中间数，去掉包括中间数之后的所有的数字，在剩下的数据中再次以同样的方式进行查找，直到找到为止。如果该数与中间数相同，则找到该数。</li>
<li>练习1：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 10</span></span><br><span class="line"><span class="comment">/***************************************************************</span></span><br><span class="line"><span class="comment">      	假设在数值a中的数据是按小到大排序排列的 </span></span><br><span class="line"><span class="comment">	       -12 0 6 16 23 56 80 100 110 115</span></span><br><span class="line"><span class="comment">   从键盘上输入一个数，判断该数是否在数组中 ，若在，输出序号 </span></span><br><span class="line"><span class="comment">***************************************************************/</span> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> a[N]=&#123;<span class="number">-12</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">16</span>,<span class="number">23</span>,<span class="number">56</span>,<span class="number">80</span>,<span class="number">100</span>,<span class="number">110</span>,<span class="number">115</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> low,high,mid;<span class="comment">//low-&gt;最小数；high-&gt;最大数；mid-&gt;中间数； </span></span><br><span class="line">	<span class="keyword">int</span> n,found;<span class="comment">//n-&gt;要查找的数</span></span><br><span class="line">	low=<span class="number">0</span>;</span><br><span class="line">	high=N<span class="number">-1</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"input n="</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">	<span class="keyword">while</span>(low&lt;=high)&#123;</span><br><span class="line">		mid=(low+high)/<span class="number">2</span>;</span><br><span class="line">		<span class="keyword">if</span>(n == a[mid])&#123;</span><br><span class="line">			found=<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(n&gt;a[mid])&#123;</span><br><span class="line">			low=mid+<span class="number">1</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			high=mid<span class="number">-1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	 <span class="keyword">if</span>(found==<span class="number">1</span>)&#123;</span><br><span class="line">	 	<span class="built_in">printf</span>(<span class="string">"The index of %d is %d"</span>,n,mid);</span><br><span class="line">	 &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	 	<span class="built_in">printf</span>(<span class="string">"There is not %d"</span>,n);</span><br><span class="line">	 &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>改进版</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 10</span></span><br><span class="line"><span class="comment">/***************************************************************</span></span><br><span class="line"><span class="comment">      	假设在数值a中的数据是按小到大排序排列的 </span></span><br><span class="line"><span class="comment">	       -12 0 6 16 23 56 80 100 110 115</span></span><br><span class="line"><span class="comment">   从键盘上输入一个数，判断该数是否在数组中 ，若在，输出序号 </span></span><br><span class="line"><span class="comment">***************************************************************/</span> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//一个程序在编译运行的时候，普通变量是存放在栈区。 </span></span><br><span class="line">	<span class="comment">//这个static会使得变量存放在data</span></span><br><span class="line">	<span class="comment">//我们整个内存主要分为四大区：CODE、DATA、STACK、HEAP </span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> a[N]=&#123;<span class="number">-12</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">16</span>,<span class="number">23</span>,<span class="number">56</span>,<span class="number">80</span>,<span class="number">100</span>,<span class="number">110</span>,<span class="number">115</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> low,high,mid;<span class="comment">//low-&gt;最小数；high-&gt;最大数；mid-&gt;中间数； </span></span><br><span class="line">	<span class="keyword">int</span> n,found;<span class="comment">//n-&gt;要查找的数</span></span><br><span class="line">	low=<span class="number">0</span>;</span><br><span class="line">	high=N<span class="number">-1</span>;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">if</span>(0)</span></span><br><span class="line">	<span class="keyword">do</span>&#123;</span><br><span class="line">		<span class="comment">//printf("input n=");</span></span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">	&#125;<span class="keyword">while</span>(n&lt;a[<span class="number">0</span>] || n&gt;a[N<span class="number">-1</span>]);</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n)!=<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"非法输入!\n"</span>);</span><br><span class="line">		getchar();<span class="comment">//把缓存区的内容消耗掉</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(low&lt;=high)&#123;</span><br><span class="line">		mid=(low+high)/<span class="number">2</span>;</span><br><span class="line">		<span class="keyword">if</span>(n == a[mid])&#123;</span><br><span class="line">			found=<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(n&gt;a[mid])&#123;</span><br><span class="line">			low=mid+<span class="number">1</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			high=mid<span class="number">-1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	 <span class="keyword">if</span>(found==<span class="number">1</span>)&#123;</span><br><span class="line">	 	<span class="built_in">printf</span>(<span class="string">"The index of %d is %d"</span>,n,mid);</span><br><span class="line">	 &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	 	<span class="built_in">printf</span>(<span class="string">"There is not %d"</span>,n);</span><br><span class="line">	 &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="衍生：多维数组的定义"><a href="#衍生：多维数组的定义" class="headerlink" title="衍生：多维数组的定义"></a>衍生：多维数组的定义</h3><ul>
<li>有了二维数组的基础，那么多维数组是如何定义的。 </li>
<li>定义三维数组：<code>float a[1][1][1];</code></li>
<li>多维数组元素在内存中的排列顺序，第一维的下标变化最慢，最右边的下标变化最快。</li>
</ul>
<hr>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><ul>
<li>一个较大程序可以分成若干个程序模块，每一个模块用来实现一个特定的功能。这个模块称之为函数。</li>
<li>在高级语言中用子程序实现模块的功能。子程序有函数来完成。</li>
<li>一个C程序可以由一个主函数和若干个其他的函数构成。</li>
<li>函数的调用关系</li>
</ul>
<p><img src="https://i.loli.net/2019/12/09/3Rhos1TxGywN7HB.png" alt="1575895174_1_.png"></p>
<ul>
<li>由主函数调用其他函数，其他函数也可以相互调用。同一个函数可以被一个或多个函数调用任意多次。</li>
<li>例子：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">printstar</span><span class="params">()</span></span>;<span class="comment">//声明函数 </span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print_message</span><span class="params">()</span></span>;<span class="comment">//声明函数 </span></span><br><span class="line">	</span><br><span class="line">	printstar();<span class="comment">//调用函数</span></span><br><span class="line">	print_message();<span class="comment">//调用函数</span></span><br><span class="line">	printstar();<span class="comment">//调用函数</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printstar</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"******************************\n"</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_message</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"hello world!!!\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数定义的一般形式："><a href="#函数定义的一般形式：" class="headerlink" title="函数定义的一般形式："></a>函数定义的一般形式：</h3><ul>
<li>定义无参函数的一般形式为：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">类型说明符 函数名()&#123;</span><br><span class="line">	声明部分</span><br><span class="line">	语句部分</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>类型说明符，指定函数的返回值，即调用函数后所带回的值。</p>
<ul>
<li>定义有参函数的一般形式：</li>
</ul>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">类型说明符 函数名(形式参数列表)&#123;</span><br><span class="line">	声明部分</span><br><span class="line">	语句部分</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>定义空函数的一般形式为</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">类型标识符 函数名()&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>函数默认的返回值类型为<code>int</code>；</p>
</blockquote>
<h3 id="形式参数和实际参数"><a href="#形式参数和实际参数" class="headerlink" title="形式参数和实际参数"></a>形式参数和实际参数</h3><ul>
<li><p>形式参数：在定义函数时括号内带有的参数；</p>
</li>
<li><p>实际参数：在主函数或或其他函数调用该函数时传递的参数。</p>
</li>
<li><p>在大多数情况下，主调函数和背调函数之间有数据传递关系。</p>
</li>
<li><p>return后面的括弧中的值作为函数带回的值（称为函数返回值）。</p>
</li>
<li><p>在不同的函数之间传递数据，可以使用的方法:</p>
<blockquote>
<ul>
<li>参数：通过形式参数和实际参数。</li>
<li>返回值：用return语句返回计算结果。</li>
<li>全局变量：外部变量。</li>
</ul>
</blockquote>
</li>
<li><p>案例实现：</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,c;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d"</span>,&amp;a,&amp;b);</span><br><span class="line">	c=max(a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,c);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> d;</span><br><span class="line">	d = x&gt;y?x:y;</span><br><span class="line">	<span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数的返回值"><a href="#函数的返回值" class="headerlink" title="函数的返回值"></a>函数的返回值</h3><ul>
<li>通常，希望通过函数调用时使主调函数能得到一个确定的值，这就是函数的返回值。</li>
<li>函数的返回值是通过函数中的return语句获得的。</li>
<li>return后面的值可以是一个表达式。</li>
<li>在C语言中，凡不加类型说明的函数，自动按整型处理。</li>
<li>练习1</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">float</span> <span class="title">max</span><span class="params">(<span class="keyword">float</span> x,<span class="keyword">float</span> y)</span></span>;</span><br><span class="line">	<span class="keyword">float</span> a,b,c;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%f,%f"</span>,&amp;a,&amp;b);</span><br><span class="line">	c=max(a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"max is %f\n"</span>,c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">float</span> <span class="title">max</span><span class="params">(<span class="keyword">float</span> x,<span class="keyword">float</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">float</span> z;</span><br><span class="line">	z=x&gt;y?x:y;</span><br><span class="line">	<span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数的调用"><a href="#函数的调用" class="headerlink" title="函数的调用"></a>函数的调用</h3><ul>
<li>函数调用的一般形式：<code>函数名(实参表列);</code></li>
<li>函数的调用方法<blockquote>
<ul>
<li>cdecl</li>
<li>stdcall</li>
<li>_fastcall </li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="函数的嵌套调用"><a href="#函数的嵌套调用" class="headerlink" title="函数的嵌套调用"></a>函数的嵌套调用</h3><p>嵌套的定义就是在定义一个函数时，其函数体内又包含另一个函数的完整定义。</p>
<p>在C语言中，不能嵌套定义函数，但可以嵌套调用函数，也就是说，在调用一个函数的过程中，又调用另一个函数。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">a</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">b</span><span class="params">()</span></span>;</span><br><span class="line">main()&#123;</span><br><span class="line">	a();</span><br><span class="line">&#125;</span><br><span class="line">a()&#123;</span><br><span class="line">	b();</span><br><span class="line">&#125;</span><br><span class="line">b()&#123;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面函数的执行流程如下图所示：</p>
<p><img src="https://i.loli.net/2020/01/09/P1LFqJM652DXrwb.png" alt="嵌套执行流程.jpg"></p>
<p>例题：计算 S = 2²! + 3²! （在高等数学中4阶层的意思是：4!=4<em>3</em>2）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">rank</span><span class="params">(<span class="keyword">long</span> i)</span></span>;<span class="comment">//计算阶层</span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">square</span><span class="params">(<span class="keyword">long</span> j)</span></span>;<span class="comment">//计算平方 </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> k;</span><br><span class="line">	k=rank(<span class="number">2</span>)+rank(<span class="number">3</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"s=%ld"</span>,k);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">rank</span><span class="params">(<span class="keyword">long</span> i)</span></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> s=<span class="number">1</span>,a,b;</span><br><span class="line">	a=square(i);</span><br><span class="line">	<span class="keyword">for</span>(b=<span class="number">1</span>;b&lt;=a;b++)&#123;</span><br><span class="line">		s = s * b;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">square</span><span class="params">(<span class="keyword">long</span> j)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> j*j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数的递归调用"><a href="#函数的递归调用" class="headerlink" title="函数的递归调用"></a>函数的递归调用</h3><p>在调用一个函数的过程中又出现直接的或间接的调用该函数的本身，称为函数的递归调用。C语言的特点之一就在允许函数的递归调用。</p>
<p>例如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> y,z;</span><br><span class="line">	z=f(y);</span><br><span class="line">	<span class="keyword">return</span> (<span class="number">2</span>*z);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意：递归必须要有一个推出的条件！</p>
<p>例题：用递归的方法求n!</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">rank</span><span class="params">(<span class="keyword">int</span> i)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"3!=%ld"</span>,rank(<span class="number">3</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">rank</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> temp_result;</span><br><span class="line">	<span class="keyword">if</span>(i&lt;<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">" i&lt;0 ,input error\n"</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>( i==<span class="number">1</span> || i==<span class="number">0</span>)&#123; <span class="comment">//推出递归条件 </span></span><br><span class="line">		temp_result=<span class="number">1</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123; <span class="comment">//循环体 </span></span><br><span class="line">		temp_result = i * rank(i<span class="number">-1</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// i==3 temp_result=3*rank(2); rank(3)</span></span><br><span class="line">		<span class="comment">// i==2 temp_result=2*rank(1); = rank(2)=2;</span></span><br><span class="line">		<span class="comment">// i==1 temp_result=1; = rank(1)</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%ld\n"</span>,temp_result);</span><br><span class="line">	<span class="keyword">return</span> temp_result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>例题：汉诺塔</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">//汉诺塔的递归程序</span></span><br><span class="line"><span class="comment">//n 代表多少个盘子，one,two,three代表多少个座  </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hanoi</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">char</span> one,<span class="keyword">char</span> two,<span class="keyword">char</span> three)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"n=%d,one=%c,two=%c,three=%c\n"</span>,n,one,two,three);</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">char</span> x,<span class="keyword">char</span> y)</span></span>;<span class="comment">// 对move函数的声明 </span></span><br><span class="line">	<span class="keyword">if</span>(n==<span class="number">1</span>)&#123;</span><br><span class="line">		move(one,three);</span><br><span class="line">		</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		hanoi(n<span class="number">-1</span>,one,three,two);</span><br><span class="line">		</span><br><span class="line">		move(one,three);</span><br><span class="line">		hanoi(n<span class="number">-1</span>,two,one,three);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">char</span> x,<span class="keyword">char</span> y)</span></span>&#123; <span class="comment">//定义函数 </span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c---&gt;%c\n"</span>,x,y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	hanoi(<span class="number">3</span>,<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">void Hanoi(int n,char A,char B,char C)&#123;</span></span><br><span class="line"><span class="comment">	if(n&gt;0)&#123;</span></span><br><span class="line"><span class="comment">		Hanoi(n-1,A,C,B);</span></span><br><span class="line"><span class="comment">		printf("%c ----&gt; %c\n",A,C);</span></span><br><span class="line"><span class="comment">		Hanoi(n-1,B,A,C); </span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">&#125; </span></span><br><span class="line"><span class="comment">int main()&#123;</span></span><br><span class="line"><span class="comment">	char x='A',y='B',z='C';</span></span><br><span class="line"><span class="comment">	Hanoi(4,x,y,z);</span></span><br><span class="line"><span class="comment">	return 0;</span></span><br><span class="line"><span class="comment">&#125; */</span></span><br></pre></td></tr></table></figure>

<h3 id="数组作为函数参数"><a href="#数组作为函数参数" class="headerlink" title="数组作为函数参数"></a>数组作为函数参数</h3><p>数组可以作为函数的参数使用，进行数据传送。数组用作函数参数有两种形式。</p>
<p>一种是把数组元素（下标变量）作为实参使用；</p>
<p>另一种是把数组名作为函数的形参和实参使用。</p>
<p><strong>数组元素</strong></p>
<p>数组元素就是下表变量，它与普通变量并无区别。因此它作为函数实参使用与普通变量是完全相同的，在发生函数调用时，把作为实参的数组元素的值传送给形参，实现单向的值传送。</p>
<p>例题训练：判别一个整数数组中个元素的值，若大于0，则输出该值，若小于0则输出0的值。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(<span class="keyword">int</span> j)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">10</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">-1</span>,<span class="number">-2</span>,<span class="number">-3</span>,<span class="number">-4</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		test(a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(j&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,j);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"0 "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>数组名</strong></p>
<p>用数组名作为函数参数与用数组元素作为实参有几点不同：</p>
<ol>
<li>数组元素作为参数传递时属于值传递，而用数组名作为函数参数传递时，则属于址传递。</li>
</ol>
<p>例子：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(<span class="keyword">int</span> b[<span class="number">10</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">10</span>]=&#123;<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">16</span>,<span class="number">18</span>,<span class="number">20</span>&#125;;</span><br><span class="line">	test(a);</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">'\n'</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(<span class="keyword">int</span> b[<span class="number">10</span>])</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,b[i]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>例子：有一个一维数组score，内存放10个学生成绩，求平均成绩（写一个average函数求平均成绩）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">average</span><span class="params">(<span class="keyword">double</span> a[<span class="number">10</span>])</span></span>&#123;</span><br><span class="line">	<span class="keyword">double</span> s=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		s += a[i]; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> s/<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">double</span> avg;</span><br><span class="line">	<span class="keyword">double</span> b[<span class="number">10</span>]=&#123;<span class="number">1.0</span>,<span class="number">2.0</span>,<span class="number">3.0</span>,<span class="number">4.0</span>,<span class="number">5.0</span>,<span class="number">6.0</span>,<span class="number">7.0</span>,<span class="number">8.0</span>,<span class="number">9.0</span>,<span class="number">10.0</span>&#125;;</span><br><span class="line">	avg=average(b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"avg=%lf"</span>,avg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="局部变量和全局变量"><a href="#局部变量和全局变量" class="headerlink" title="局部变量和全局变量"></a>局部变量和全局变量</h3><p><strong>局部变量</strong></p>
<p>在一个函数内部定义的变量是内部变量，他只在函数范围内有效，也就是说只有在本函数内才能使用他们，在此函数以外是不能使用这些变量的。这称为“局部变量”。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">float</span> <span class="title">f1</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123; <span class="comment">//函数f1</span></span><br><span class="line">	<span class="keyword">int</span> b,c; <span class="comment">//a,b,c有效</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">f2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123; <span class="comment">// 函数f2</span></span><br><span class="line">	<span class="keyword">int</span> i,j;<span class="comment">//x,y,i,j有效</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span>&#123; <span class="comment">//主函数</span></span><br><span class="line">	<span class="keyword">int</span> m,n; <span class="comment">//m,n有效</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>说明：</p>
<ol>
<li>主函数中定义的变量只能在主函数中有效。</li>
<li>不同函数体内可以定义相同名称的局部变量，各局部变量之间互不干扰。</li>
<li>形式参数也是局部比那辆。例如上面f1函数中的形式参数a，也只在f1函数中有效。</li>
<li>复合语句中定义的变量称为局部变量，该变量只能在该复合语句中使用。</li>
</ol>
<p><strong>全局变量</strong></p>
<p>在函数内定义的变量是局部变量，而在函数之外定义的变量成为外部变量，外部变量是全局变量（也称为全程变量）。</p>
<p>全局变量可以为本文件中其他函数所共用。它的有效范围为从定义变量的位置开始到本源文件结束。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> p=<span class="number">1</span>,q=<span class="number">5</span>; <span class="comment">//外部变量</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f1</span><span class="params">(<span class="keyword">int</span> o)</span></span>&#123; <span class="comment">//o为局部变量</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">char</span> m=<span class="number">1</span>,n=<span class="number">1</span>;<span class="comment">//外部变量 在此位置以下函数都可以使用该变量</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f2</span><span class="params">(<span class="keyword">char</span> e )</span></span>&#123;<span class="comment">//e为局部变量</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实战演练：</p>
<p>题目1：输入正方体的长，宽，高。求体积以及三个面x<em>y,x</em>z,y*z的面积</p>
<p>源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> s1,s2,s3;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">vs</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> v;</span><br><span class="line">	v=a*b*c;</span><br><span class="line">	s1=a*b;</span><br><span class="line">	s2=a*c;</span><br><span class="line">	s3=b*c;</span><br><span class="line">	<span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> l,w,h;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"请输入长方体的长宽高：\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d,%d"</span>,&amp;l,&amp;w,&amp;h);</span><br><span class="line">	<span class="keyword">int</span> v=vs(l,w,h);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\ns1=%d,s2=%d,s3=%d,v=%d\n"</span>,s1,s2,s3,v);	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目2:有一个一维数组，内存放10个学生成绩，写一个函数，求出平均值、最高分和最低分。</p>
<p>程序源码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> max,min;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">average</span><span class="params">(<span class="keyword">int</span> a[])</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,sum=<span class="number">0</span>;</span><br><span class="line">	min=a[<span class="number">0</span>],max=a[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>( min &gt; a[i])&#123;</span><br><span class="line">			min = a[i];<span class="comment">//求最小值 </span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>( max &lt; a[i])&#123;</span><br><span class="line">			max = a[i];<span class="comment">//求最大值 </span></span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		sum += a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum*<span class="number">1.0</span>/<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">10</span>]=&#123;<span class="number">96</span>,<span class="number">54</span>,<span class="number">85</span>,<span class="number">68</span>,<span class="number">77</span>,<span class="number">86</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">56</span>,<span class="number">85</span>&#125;;</span><br><span class="line">	<span class="keyword">double</span> avg;</span><br><span class="line">	avg=average(a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"min=%d,max=%d,avg=%lf"</span>,min,max,avg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="变量的存储类型"><a href="#变量的存储类型" class="headerlink" title="变量的存储类型"></a>变量的存储类型</h3><p><strong>动态存储方式</strong></p>
<p>动态存储方式是在程序运行期间根据需要进行动态的分配存储空间的方式。</p>
<p><strong>静态存储方式</strong></p>
<p>静态存储方式是指在程序运行开始时由系统分配固定的存储空间的方式。</p>
<p><strong>用户存储空间可以分为三部分</strong></p>
<ol>
<li>程序区</li>
<li>静态存储区</li>
<li>动态存储区</li>
</ol>
<p>在C语言中每一个变量和函数有两个属性：数据类型和数据的存储类别。<br>对数据型（如整形，字符型等）。存储类型是指在内存中存储的方式。<br>存储类型分为两大类：静态存储类和动态存储类。</p>
<p>具体包括四种：自动的(auto)、静态的(static)、寄存器的（register）、外部的（extern）。根据变量的存储类型，可以知道变量的作用域和生存期。</p>
<p><strong>auto变量</strong></p>
<p>函数中的局部变量，如不专门声明为static存储类别，都是动态的分配存储空间的栈，数据存储在动态存储区中。</p>
<p>函数中的形参和函数中定义的变量（包括在复合语句中定义的变量），都是此类，在调用该函数时系统会给他们分配存储空间，在函数调用结束时会自动释放这些存储空间。</p>
<p>因此这类局部变量称为自动变量。自动变量用关键字auto做存储类别的声明。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;<span class="comment">//定义f函数,a为形参 </span></span><br><span class="line">	<span class="keyword">auto</span> <span class="keyword">int</span> b,c=<span class="number">2</span>;<span class="comment">//定义b,c为自动变量 </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关键字auto可以省略，auto不写则隐含定义为“自动存储类别”，属于动态存储方式。</p>
<p><strong>用static声明局部变量</strong></p>
<p>有时希望函数中的局部变量的值在函数调用结束后不消失而保留原值，即其占用的存储单元不释放，在下一次该函数调用时，该变量已有值，就是上一次函数调用结束时的值。</p>
<p>这时就应该指定该局部变量为“静态局部变量”，用关键字static进行声明。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;</span><br><span class="line">	<span class="keyword">auto</span> <span class="keyword">int</span> b=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> c=<span class="number">3</span>;</span><br><span class="line">	</span><br><span class="line">	b=b+<span class="number">1</span>;<span class="comment">// b == 1 , 1 , 1</span></span><br><span class="line">	c=c+<span class="number">1</span>;<span class="comment">// c == 4 , 5 , 6</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> a+b+c; <span class="comment">//7,8,9</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a=<span class="number">2</span>,i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,f(a));</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>说明：</p>
<ol>
<li>静态局部变量属于静态存储类别，在静态存储区内分配存储单元。在程序整个运行期间都不释放。</li>
<li>对静态局部变量是在编译时赋初值的。</li>
<li>如在定义局部变量不赋初值时，静态局部变量会自动赋为0（对数值而言）或空字符串（对字符串而言）。</li>
<li>虽然静态局部变量在函数调用结束后仍然存在，但是其他函数是不能引用它的。</li>
</ol>
<p>实战演练：</p>
<p>题目1：输出1到5的阶乘值：</p>
<p>程序源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fac</span><span class="params">(<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> f = <span class="number">1</span>;</span><br><span class="line">	f = f * k;</span><br><span class="line">	<span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">5</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d! = %d\n"</span>,i,fac(i));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>register变量</strong></p>
<p>一般情况下，变量（包括静态存储方式和动态存储方式）的值是存放在内存中。</p>
<p>如果频繁使用到某个变量，这时可以考虑使用register存储类别，使用register存储类别，可以将变量存放到寄存器中，这样做可以提高执行效率。（原因：对寄存器的存取速度远高于对内存的存取速度。）</p>
<p>实战演练：</p>
<p>题目1：输出1到n的阶乘值：</p>
<p>程序源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fac</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	 <span class="comment">//注意：整个版本不使用static，所以把阶层的过程放在fac()函数中</span></span><br><span class="line">	 <span class="keyword">register</span> <span class="keyword">int</span> i,f=<span class="number">1</span>;</span><br><span class="line">	 <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	 	f = f * i;</span><br><span class="line">	 &#125; </span><br><span class="line">	 <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">15</span>;i++)&#123;</span><br><span class="line">	 <span class="built_in">printf</span>(<span class="string">"%d!=%d\n"</span>,i,fac(i));</span><br><span class="line">	&#125; </span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>extern变量</strong></p>
<p>外部变量即全局变量，它的作用域是从变量的定义处开始，到本程序文件的末尾。</p>
<p>在此作用域内，编译时将外部变量分配在静态存储区。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> z;</span><br><span class="line">	z=x&gt;y?x:y;</span><br><span class="line">	<span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">extern</span> A,B;<span class="comment">//声明全局变量</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,max(A,B)); </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> A = <span class="number">13</span> , B = <span class="number">-8</span>;</span><br></pre></td></tr></table></figure>

<h3 id="在多文件的程序中声明外部变量"><a href="#在多文件的程序中声明外部变量" class="headerlink" title="在多文件的程序中声明外部变量"></a>在多文件的程序中声明外部变量</h3><p>题目：将一个程序拆成多个文件</p>
<p>程序源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> A;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">power</span><span class="params">(<span class="keyword">int</span> n)</span></span>;<span class="comment">//函数声明</span></span><br><span class="line">	<span class="keyword">int</span> b=<span class="number">3</span>,c,d,m;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"enter the number a and its power m:\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d"</span>,&amp;A,&amp;m);</span><br><span class="line">	</span><br><span class="line">	c=A*b;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d * %d = %d\n"</span>,A,b,c);</span><br><span class="line">	</span><br><span class="line">	d=power(m);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d ^ %d = %d\n"</span>,A,m,d); </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//file1.c</span></span><br><span class="line"><span class="keyword">extern</span> A;<span class="comment">//声明A为一个已定义的外部变量 </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">power</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,y=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		y = y*A;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>用static声明外部变量</strong></p>
<p>用static修饰的外部变量只能被本文件使用，在其他文件中是无法引用的。</p>
<h3 id="小结："><a href="#小结：" class="headerlink" title="小结："></a>小结：</h3><p><strong>局部变量和全局变量</strong></p>
<p>局部变量：自动变量，静态局部变量，寄存器变量</p>
<p>全局变量：静态外部变量，只能在本文件中使用。外部变量：用<code>extern</code>修饰的变量。</p>
<p><strong>静态存储和动态存储</strong></p>
<p>静态存储：在整个程序运行过程中都存在。<br>动态存储：在整个函数调用完成之外存在。</p>
<p>动态存储：自动变量，形式参数，寄存器变量<br>静态存储：静态外部变量，静态局部变量，外部变量。</p>
<p><strong>static对局部变量和全局变量的作用</strong></p>
<p>对局部变量来说，它是局部变量由动态存储方式转变静态存储方式。而对全部变量来说，它使变量局部化（局部于本文件），但仍为静态存储方式.</p>
<p><strong>外部函数和内部函数</strong></p>
<p>内部函数：只能在本文件中使用。<code>staic 类型说明符 函数名(形式参数)</code><br>外部函数：可以在外部文件中使用。<code>extern 类型说明符 函数名(形式参数)</code></p>
<p>实战演练：</p>
<p>题目：根据删除字符串中指定的某个字符。</p>
<p>程序源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建一个C工程 project.dev</span></span><br><span class="line"><span class="comment">//创建四个文件</span></span><br><span class="line"><span class="comment">//file03.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"string.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_string</span><span class="params">(<span class="keyword">char</span> str[])</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%s\n"</span>,str);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//file02.c</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete_string</span><span class="params">(<span class="keyword">char</span> str[],<span class="keyword">char</span> ch)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=j=<span class="number">0</span>;str[i]!=<span class="string">'\0'</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>( str[i] != ch)&#123;</span><br><span class="line">			str[j++] = str[i];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	str[j] = <span class="string">'\0'</span>;</span><br><span class="line">	</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//file01.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"string.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">enter_string</span><span class="params">(<span class="keyword">char</span> str[<span class="number">80</span>])</span></span>&#123;</span><br><span class="line">	gets(str);<span class="comment">//输入一个字符串 </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//main.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//定义外部函数</span></span><br><span class="line">	<span class="function"><span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">enter_string</span><span class="params">(<span class="keyword">char</span> str[])</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">delete_string</span><span class="params">(<span class="keyword">char</span> str[],<span class="keyword">char</span> ch)</span></span>; </span><br><span class="line">	<span class="function"><span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">print_string</span><span class="params">(<span class="keyword">char</span> str[])</span></span>;</span><br><span class="line">	<span class="keyword">char</span> c;</span><br><span class="line">	<span class="keyword">char</span> str[<span class="number">80</span>];</span><br><span class="line">	</span><br><span class="line">	enter_string(str);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%c"</span>,&amp;c);</span><br><span class="line">	delete_string(str,c);</span><br><span class="line">	print_string(str);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h2><p>指针是C语言中的一个重要的概念,也是C语言中的一个重要特色.</p>
<p>正确灵活地运用指针,可以有效地表示复杂的数据结构;能动态分配内存;能方便的使用字符串;有效而方便地使用数组.</p>
<p>掌握指针的应用,可以使程序简洁 紧凑 高效.</p>
<p>内存区的每一个字节都有一个编号,这就是”地址”.如果在程序中定义了一个变量,在对程序进行编译时,系统就会为这个变量分配内存单元.</p>
<p>在C语言中,指针是一种特殊的变量,他是存放地址的.</p>
<p>两个操作符:<code>*</code>和<code>&amp;</code></p>
<p><code>*</code>:取值操作符<br><code>&amp;</code>:取址操作符</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">2000</span>;</span><br><span class="line">	<span class="keyword">int</span> *pointer;</span><br><span class="line">	pointer = &amp;i;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,*pointer);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="指针与指针变量"><a href="#指针与指针变量" class="headerlink" title="指针与指针变量"></a>指针与指针变量</h3><p>知道了一个变量的地址,就可以通过这个地址来访问这个变量,因此,又把变量的地址称为该变量的”指针”.</p>
<p>C语言中可以定义一类特殊的变量,这些变量专门用来存放变量的地址,称为指针变量.</p>
<p>注意:指针变量的值(即指针变量中存放的值)是地址(即指针).</p>
<p>练习:通过指针变量访问整型变量</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b;</span><br><span class="line">	<span class="keyword">int</span> *pointer_1,*pointer_2;</span><br><span class="line">	a=<span class="number">100</span>;b=<span class="number">10</span>;</span><br><span class="line">	pointer_1 = &amp;a;</span><br><span class="line">	pointer_2 = &amp;b;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,*pointer_1,*pointer_2);</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码分析:</p>
<p><img src="https://i.loli.net/2020/01/12/vuMqgYND4ZHmp7J.png" alt="1578819611_1_.jpg"></p>
<h3 id="对-amp-和-运算符再做说明"><a href="#对-amp-和-运算符再做说明" class="headerlink" title="对&amp;和*运算符再做说明"></a>对<code>&amp;</code>和<code>*</code>运算符再做说明</h3><p> 如果已执行了语句: <code>pointer_1 = &amp;a</code>;</p>
<p>&amp; *pointer_1的含义是什么???</p>
<p>“&amp;”和”*”两个运算符的优先级别相同,但自右向左方向结合,因此先进行*pointer运算,他就是变量a,再执行&amp;运算.</p>
<p>因此,&amp; * pointer_1 = &amp;a相同,即变量a的地址.</p>
<p>题目1:输入a和b两个整数,按先大后小的顺序输出a和b</p>
<p>程序源码分析:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> *p,*q,*r,a,b;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d"</span>,&amp;a,&amp;b);</span><br><span class="line">	p=&amp;a;q=&amp;b;</span><br><span class="line">	<span class="keyword">if</span>(a&lt;b)&#123;</span><br><span class="line">		r=p;</span><br><span class="line">		p=q;</span><br><span class="line">		q=r;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"a=%d,b=%d\n"</span>,a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"*p=%d,*q=%d\n"</span>,*p,*q);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目2:输入a和b两个整数,按先大后小的顺序输出a和b,用函数功能实现</p>
<p>程序源码分析:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> *p,<span class="keyword">int</span> *q)</span></span>;</span><br><span class="line">	<span class="keyword">int</span> *a,*b;</span><br><span class="line">	<span class="keyword">int</span> d,e;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d"</span>,&amp;d,&amp;e);</span><br><span class="line">	a=&amp;d;b=&amp;e;</span><br><span class="line">	<span class="keyword">if</span>(d &lt; e)&#123;</span><br><span class="line">		swap(a,b);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d &gt; %d"</span>,*a,*b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> *p,<span class="keyword">int</span> *q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> t;</span><br><span class="line">	t=*p;</span><br><span class="line">	*p=*q;</span><br><span class="line">	*q=t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目3:输入a,b,c三个整数,要求从大到小输出</p>
<p>程序源码分析:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">exchange</span><span class="params">(<span class="keyword">int</span> *p1,<span class="keyword">int</span> *p2,<span class="keyword">int</span> *p3)</span></span>;<span class="comment">//确保a&gt;b&gt;c</span></span><br><span class="line">	<span class="keyword">int</span> a,b,c,*q1,*q2,*q3;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d,%d"</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line">	q1=&amp;a;q2=&amp;b,q3=&amp;c;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"开始排序...\n"</span>);</span><br><span class="line">	exchange(q1,q2,q3);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"排序结束，输出结果...\n"</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d &gt; %d &gt; %d"</span>,*q1,*q2,*q3);</span><br><span class="line">	 </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exchange</span><span class="params">(<span class="keyword">int</span> *p1,<span class="keyword">int</span> *p2,<span class="keyword">int</span> *p3)</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> *t1,<span class="keyword">int</span> *t2)</span></span>; <span class="comment">//进行两个数交换 </span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"exchange函数进行中...\n"</span>);</span><br><span class="line">	<span class="keyword">if</span>(*p1 &lt; *p2)&#123;</span><br><span class="line">		swap(p1,p2);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(*p1 &lt; *p3)&#123;</span><br><span class="line">		swap(p1,p3);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(*p2 &lt; *p3)&#123;</span><br><span class="line">		swap(p2,p3);</span><br><span class="line">	&#125;	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"exchange函数执行完毕...\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> *t1,<span class="keyword">int</span> *t2)</span></span>&#123;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> i=<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"交换进行中%d...\n"</span>,i);</span><br><span class="line">	<span class="keyword">int</span> t;</span><br><span class="line">	t=*t1;</span><br><span class="line">	*t1=*t2;</span><br><span class="line">	*t2=t;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"交换结束%d...\n"</span>,i);</span><br><span class="line">	i++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="数组与指针"><a href="#数组与指针" class="headerlink" title="数组与指针"></a>数组与指针</h3><p>一个变量有地址，一个数组包含若干元素，每个数组元素都在内存中占用存储单元，他们都有相应的地址。</p>
<p>指针变量既可以指向变量，当然也可以指向数组元素。（把某一元素的地址放到指针变量中）</p>
<p>所谓数组元素的指针就是数组元素的地址。</p>
<p>定义一个指向数组元素的指针变量的方法，与前面介绍的指向变量的指针变量相同。</p>
<p>例如：<br><code>int a[10];</code>定义a为包含10整型数据的数组。<br><code>int *p</code>：定义p为指向整型变量的指针变量。<br>应当注意：如果数组为int型，则指针变量的基本类型亦应为int型。</p>
<p>引用一个数组元素，可以用：<br>（1）下标法：如<code>a[i]</code>形式；<br>（2）指针法：如<em>(a+i)或</em>(p+i)；<br>其中的a是数组名，p是指向数组元素的指针变量，其初值为p=a;<br>注意：数组名即为数组第一个元素的地址。</p>
<p>实战演习：</p>
<p>题目：输出数组中的全部元素：</p>
<p>分析：假设有一个a数组，整型，有10个元素。要输出各元素的值有三种方法：</p>
<p>程序源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print_array_by_xiabiao</span><span class="params">(<span class="keyword">int</span> <span class="built_in">array</span>[],<span class="keyword">int</span> n)</span></span>;<span class="comment">//下标法输出数组元素 </span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print_array_by_point1</span><span class="params">(<span class="keyword">int</span> <span class="built_in">array</span>[],<span class="keyword">int</span> n)</span></span>;<span class="comment">//指针法输出数组元素  *(a+i)</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print_array_by_point2</span><span class="params">(<span class="keyword">int</span> <span class="built_in">array</span>[],<span class="keyword">int</span> n)</span></span>;<span class="comment">//指针法输出数组元素  *(p+i)</span></span><br><span class="line">	<span class="keyword">int</span> b[<span class="number">10</span>]=&#123;<span class="number">15</span>,<span class="number">36</span>,<span class="number">98</span>,<span class="number">75</span>,<span class="number">63</span>,<span class="number">14</span>,<span class="number">89</span>,<span class="number">42</span>,<span class="number">10</span>,<span class="number">9</span>&#125;;</span><br><span class="line">	print_array_by_xiabiao(b,<span class="number">10</span>);</span><br><span class="line">	print_array_by_point1(b,<span class="number">10</span>);</span><br><span class="line">	print_array_by_point2(b,<span class="number">10</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_array_by_xiabiao</span><span class="params">(<span class="keyword">int</span> <span class="built_in">array</span>[],<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">".........下标法输出数组个元素.........\n"</span>);</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,<span class="built_in">array</span>[i]);</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_array_by_point1</span><span class="params">(<span class="keyword">int</span> <span class="built_in">array</span>[],<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">".........指针法输出数组个元素 *(a+i).........\n"</span>);</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,*(<span class="built_in">array</span>+i));</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_array_by_point2</span><span class="params">(<span class="keyword">int</span> <span class="built_in">array</span>[],<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">".........指针法输出数组个元素 *(p+i).........\n"</span>);</span><br><span class="line">	<span class="keyword">int</span> i,*p;</span><br><span class="line">	<span class="keyword">for</span>(p=<span class="built_in">array</span>,i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,*(p+i));</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目：实现将一个数组逆转</p>
<p>程序源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> *x,<span class="keyword">int</span> n)</span></span>&#123;<span class="comment">/*形参x为指针变量*/</span></span><br><span class="line">	<span class="keyword">int</span> *p,*q,temp,*i,*j,m;</span><br><span class="line">	m = (n<span class="number">-1</span>)/<span class="number">2</span>;</span><br><span class="line">	i=x;<span class="comment">//i指向数组的第一个元素 </span></span><br><span class="line">	j=x+n<span class="number">-1</span>;<span class="comment">//j指向数组的最后一个元素 </span></span><br><span class="line">	p=x+m;</span><br><span class="line">	<span class="keyword">for</span>(;i&lt;=p;i++,j--)&#123;</span><br><span class="line">		temp=*i;</span><br><span class="line">		*i=*j;</span><br><span class="line">		*j=temp;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">10</span>],i,*p;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"output a array:\n"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	reverse(a,<span class="number">10</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"output a reverse array:\n"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目：从10个数找出最大值和最小值</p>
<p>程序源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="comment">//第二个版本</span></span><br><span class="line"><span class="keyword">int</span> max,min;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">max_min_value</span><span class="params">(<span class="keyword">int</span> *p,<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> *q;</span><br><span class="line">	min=*p;</span><br><span class="line">	max=*p;</span><br><span class="line">	<span class="keyword">for</span>(q=(p+<span class="number">1</span>);q&lt;(p+n);q++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(min&gt;*q) &#123;</span><br><span class="line">			min= *q;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(max&lt;*q)&#123;</span><br><span class="line">			max=*q;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">10</span>],i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]); </span><br><span class="line">	&#125; </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"output a array:\n"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	max_min_value(a,<span class="number">10</span>); </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"max=%d,min=%d"</span>,max,min);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//第一个版本 </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="keyword">int</span> max,min;<span class="comment">//定义最大值和最小值 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">max_min_value</span><span class="params">(<span class="keyword">int</span> <span class="built_in">array</span>[],<span class="keyword">int</span> n)</span></span>&#123;<span class="comment">//找到最大值和最小值 </span></span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	min = <span class="built_in">array</span>[<span class="number">0</span>];</span><br><span class="line">	max = <span class="built_in">array</span>[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(max&lt;<span class="built_in">array</span>[i])&#123;</span><br><span class="line">			max=<span class="built_in">array</span>[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(min &gt; <span class="built_in">array</span>[i])&#123;</span><br><span class="line">			min=<span class="built_in">array</span>[i];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">10</span>],i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]); </span><br><span class="line">	&#125; </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"output a array:\n"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d "</span>,a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	max_min_value(a,<span class="number">10</span>); </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"max=%d,min=%d"</span>,max,min);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>归纳起来，如果有一个实参数组，想在函数中改变此数组中的元素的值，实参与形参的对应关系有以下4种情况：</p>
<ol>
<li>形参和实参都用数组名；</li>
<li>实参用数组名，形参用数组名；</li>
<li>实参形参都用指针变量；</li>
<li>实参为指针变量，形参为数组名称；</li>
</ol>
<h3 id="多维数组与指针"><a href="#多维数组与指针" class="headerlink" title="多维数组与指针"></a>多维数组与指针</h3><p>用指针变量可以指向一维数组种的元素，也可以指向多维数组种元素。</p>
<p>源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">2</span>][<span class="number">3</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>&#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"a:%d\n"</span>,a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"*a:%d\n"</span>,*a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"a[0]:%d\n"</span>,a[<span class="number">0</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"&amp;a[0]:%d\n"</span>,&amp;a[<span class="number">0</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"&amp;a[0][0]:%d\n"</span>,&amp;a[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"*(a+1)+1：%d\n"</span>,*(a+<span class="number">1</span>)+<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"*(*(a+1)+1)：%d"</span>,*(*(a+<span class="number">1</span>)+<span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>指向多维数组元素的指针变量</strong></p>
<p>把二维数组a分解为一维数组<code>a[0]</code>、<code>a[1]</code>、<code>a[2]</code>、<code>a[3]</code>之后，设p为指向二维数组的指针变量。可定义为：<code>int (*p)[4];</code></p>
<p>它表示p是一个指针变量，它指向包含4个元素的一维数组。若指向第一个一维数组<code>a[0]</code>,其值等于<code>a</code>,<code>a[0]</code>或<code>a[0][0]</code>等.</p>
<p><code>*(p+i)+j</code>：它表示二位数组i行j列的元素的地址，而<code>*(*(p+i)+j)</code>则是该地址的值；</p>
<p>二维数组指针变量说明的一般形式：<code>类型说明符 (*指针变量吗名)[长度]</code></p>
<p>实战练习：</p>
<p>题目：用指针变量输出二维数组的值</p>
<p>程序源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">3</span>][<span class="number">4</span>]=&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> (*p)[<span class="number">4</span>],i,j;</span><br><span class="line">	p=a;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%2d "</span>,*(*(p+i)+j));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目2：通过输入指定行数和列数打印出二维数组对应行对应列元素的值</p>
<p>程序源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a[<span class="number">3</span>][<span class="number">4</span>]=&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> (*p)[<span class="number">4</span>],i,j,k,l;</span><br><span class="line">	p=a;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"i="</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;i);</span><br><span class="line">	<span class="keyword">while</span>(i&lt;<span class="number">0</span> || i&gt;<span class="number">2</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"i="</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"j="</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;j);</span><br><span class="line">	<span class="keyword">while</span>(j&lt;<span class="number">0</span> || j&gt;<span class="number">3</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"j="</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;j);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;<span class="number">3</span>;k++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(l=<span class="number">0</span>;l&lt;<span class="number">4</span>;l++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%2d "</span>,*(*(p+k)+l));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"a[%d][%d]=%2d\n"</span>,i,j,*(*(p+i)+j)); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="字符串和指针"><a href="#字符串和指针" class="headerlink" title="字符串和指针"></a>字符串和指针</h3><p>用字符数组存放一个字符串，然后输出该字符串</p>
<p>题目练习：定义一个字符数组，对它初始化，然后输出该字符串</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> <span class="built_in">array</span>[]=<span class="string">"I Love Java Program"</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%s\n"</span>,<span class="built_in">array</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用指针变量的形式定义一个字符串，并输出该字符串</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> *<span class="built_in">array</span>=<span class="string">"I Love Java Program"</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%s\n"</span>,<span class="built_in">array</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对字符串中字符的存取，可以用下标方法，也可以用指针方法！</p>
<p>下标法:</p>
<p>题目：实现字符串的复制</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[]=<span class="string">"i love the China very much"</span>,b[<span class="number">40</span>],i,j;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;a[i]!=<span class="string">'\0'</span>;i++)&#123;</span><br><span class="line">		b[j++] = a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	b[j]=<span class="string">'\0'</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"the a string is:%s\n"</span>,a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"the b string is:"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;b[i]!=<span class="string">'\0'</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%c"</span>,b[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>指针法:</p>
<p>题目：实现字符串的复制</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[]=<span class="string">"i love the China very very much"</span>,b[<span class="number">40</span>],*q,*p;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	p=a;q=b;</span><br><span class="line">	<span class="keyword">for</span>(;*p!=<span class="string">'\0'</span>;p++,q++)&#123;</span><br><span class="line">		*q=*p;</span><br><span class="line">	&#125;</span><br><span class="line">	*q=<span class="string">'\0'</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"the string a is:%s\n"</span>,a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"the string b is:"</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;b[i]!=<span class="string">'\0'</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%c"</span>,*(b+i));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用函数调用实现字符串的复制</p>
<p>用字符数组作为参数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">copy_string</span><span class="params">(<span class="keyword">char</span> from[],<span class="keyword">char</span> to[])</span></span>;</span><br><span class="line">	<span class="keyword">char</span> a[]=<span class="string">"i am a teacher."</span>,b[]=<span class="string">"you are a student."</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"string a:%s\nstring b:%s\n"</span>,a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"copy string a to string b:\n"</span>);</span><br><span class="line">	copy_string(a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nstring a:%s\nstring b:%s\n"</span>,a,b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">copy_string</span><span class="params">(<span class="keyword">char</span> from[],<span class="keyword">char</span> to[])</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i;from[i]!=<span class="string">'\0'</span>;i++)&#123;</span><br><span class="line">		to[i]=from[i];</span><br><span class="line">	&#125;</span><br><span class="line">	to[i]=<span class="string">'\0'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>形参用字符指针变量</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">copy_string</span><span class="params">(<span class="keyword">char</span> from[],<span class="keyword">char</span> to[])</span></span>;</span><br><span class="line">	<span class="keyword">char</span> *a=<span class="string">"i am a student."</span>;</span><br><span class="line">	<span class="keyword">char</span> *b=<span class="string">"you are a teacher."</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"string a is:%s\n"</span>,a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"string b is:%s\n"</span>,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"copy string a to string b:"</span>);</span><br><span class="line">	copy_string(a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\nstring a:%s\nstring b:%s\n"</span>,a,b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">copy_string</span><span class="params">(<span class="keyword">char</span> from[],<span class="keyword">char</span> to[])</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;from[i]!=<span class="string">'\0'</span>;i++)&#123;</span><br><span class="line">		to[j++]=from[i];</span><br><span class="line">	&#125;</span><br><span class="line">	to[j]=<span class="string">'\0'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//程序执行出错</span></span><br></pre></td></tr></table></figure>

<p>上面程序出错的原因之一：用指针变量定义的字符串在vs6c++中是存放在常量存储区中，而常量存储区中的值只能读不能写，所以想要覆盖则会出错。</p>
<p>关于<code>a[]</code>和<code>*a</code>的区别</p>
<p>优化：对copy_string函数还可作简化</p>
<p>。。。</p>
<p><strong>对使用字符数组和字符指针变量的讨论</strong></p>
<p>虽然用字符数组和字符指针变量都能实现字符串的存储和运算，但是它们二者之间是由区别的，不应混为一谈…</p>
<p>主要概括起来有以下几点：</p>
<ol>
<li>字符数组若由干个元素组成，每个元素中放一字符，而字符指针变量中存放的是地址（字符串第一个字符的地址），绝不是将字符串存放到字符指针变量中。</li>
<li>赋值方式。对字符数组只能对各个元素赋值。而字符指针变量，可以采用如下方式赋值<code>char *p;p=&quot;I Love China very much!&quot;;</code></li>
<li>初始化的含义；</li>
<li>存储单元的内容</li>
<li>指针变量的值可以改变</li>
</ol>
<h3 id="指向函数的指针"><a href="#指向函数的指针" class="headerlink" title="指向函数的指针"></a>指向函数的指针</h3><p>用函数指针变量调用函数</p>
<p>一个函数在编译时被分配一个入口地址。这个函数入口地址就称为函数的指针。</p>
<p>程序源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span>(1) </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>;</span><br><span class="line">	<span class="keyword">int</span> (*p)(<span class="keyword">int</span> x,<span class="keyword">int</span> y);</span><br><span class="line">	p=max;</span><br><span class="line">	<span class="keyword">int</span> a,b,c;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"please enter e and f:"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d"</span>,&amp;a,&amp;b);</span><br><span class="line">	c=(*p)(a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"a=%d\nb=%d\nmax=%d\n"</span>,a,b,c);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span>(0)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>;<span class="comment">//求最大值</span></span><br><span class="line">	<span class="keyword">int</span> a,b,c;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"please enter a and b:"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d"</span>,&amp;a,&amp;b);</span><br><span class="line">	c=max(a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"a=%d\nb=%d\nmax=%d\n"</span>,a,b,c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> z;</span><br><span class="line">	<span class="keyword">if</span>(x&gt;y)&#123;</span><br><span class="line">		z=x;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		z=y;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>函数指针变量最常用的用途之一是把指针作为参数传递到其他函数。</p>
<p>指向函数的指针可以作为参数，以实现函数地址的传递，这样就能够在被调用的函数中使用实参函数。</p>
<p>实战演练：</p>
<p>题目：设计一个函数procress，在调用它的时候，每次实现不同的功能。（有点类似多态）</p>
<p>程序源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">//实现多态 1.+2.-3.*4./</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span>(1)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//实现一个小型计算器 </span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> (*p)(<span class="keyword">int</span> x,<span class="keyword">int</span> y))</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>;<span class="comment">//声明函数 </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>;<span class="comment">//声明函数 </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">cheng</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>;<span class="comment">//声明函数 </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">chu</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>;<span class="comment">//声明函数 </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>;<span class="comment">//声明函数 </span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>;<span class="comment">//声明函数 </span></span><br><span class="line">	<span class="keyword">int</span> a,b;</span><br><span class="line">	<span class="keyword">char</span> c;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"请输入a,c,b的值,c为m则为最大值,n则为最小值,以 9 . 9 为结束标志\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d %c %d"</span>,&amp;a,&amp;c,&amp;b);</span><br><span class="line">	<span class="keyword">while</span>(c != <span class="string">'.'</span>)&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">switch</span>(c)&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'+'</span>:process(a,b,add);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'-'</span>:process(a,b,sub);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'/'</span>:process(a,b,chu);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'*'</span>:process(a,b,cheng);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'m'</span>:process(a,b,max);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'n'</span>:process(a,b,min);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:<span class="built_in">printf</span>(<span class="string">"input error!\n"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"请输入a,c,b的值,c为m则为最大值,n则为最小值,以 9 . 9 为结束标志\n"</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d %c %d"</span>,&amp;a,&amp;c,&amp;b);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> (*p)(<span class="keyword">int</span> x,<span class="keyword">int</span> y))</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> result;</span><br><span class="line">	result=(*p)(a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,result);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> z;</span><br><span class="line">	z=x+y;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"="</span>);</span><br><span class="line">	<span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> z;</span><br><span class="line">	z=x-y;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"="</span>);</span><br><span class="line">	<span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cheng</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> z;</span><br><span class="line">	z=x*y;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"="</span>);</span><br><span class="line">	<span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">chu</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> z;</span><br><span class="line">	z=x/y;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"="</span>);</span><br><span class="line">	<span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> z;</span><br><span class="line">	<span class="keyword">if</span>(x&gt;y)&#123;</span><br><span class="line">		z=x;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		z=y;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"="</span>);</span><br><span class="line">	<span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> z;</span><br><span class="line">	<span class="keyword">if</span>(x&lt;y)&#123;</span><br><span class="line">		z=x;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		z=y;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"="</span>);</span><br><span class="line">	<span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<h3 id="返回指针值的函数"><a href="#返回指针值的函数" class="headerlink" title="返回指针值的函数"></a>返回指针值的函数</h3><p>一个函数可以带回一个整型值、字符值、实型值、也可以带回指针型的数据，即地址。其概念与以前相似，只是带回的值的类型是指针类型而已。</p>
<h2 id="练习题"><a href="#练习题" class="headerlink" title="练习题"></a>练习题</h2><p>题目1：有1,2,3,4四个数字，能组成多少个互不相同且无重复的三位数？都是多少？</p>
<p>程序分析：可填在百位、十位、个位的数字都是1，2，3，4.组成所有的排列后再去掉不满足的排列。</p>
<p>程序源码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,k;</span><br><span class="line">	<span class="keyword">int</span> sum;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">4</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=<span class="number">4</span>;j++)&#123;</span><br><span class="line">			<span class="keyword">for</span>(k=<span class="number">1</span>;k&lt;=<span class="number">4</span>;k++)&#123;</span><br><span class="line">				<span class="keyword">if</span>( i!=j &amp;&amp; i!=k &amp;&amp; j!=k)&#123;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">"%d%d%d\n"</span>,i,j,k);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目2：企业发放的奖金根据利润提成。利润（1）低于或等于10万元，奖金可提成10%；利润高于10万元，低于20万元时，低于10万元的部分按10%提成，高于10万元的部分，可提成7.5%；20万元到40万元时，高于20万元的部分，可提成5%；40万元到60万元时，高于40万元的部分，可提成3%;60万元到100万元时，高于60万元的部分，可提成1.5%；高于100万时，超过一百万的部分可按1%提成，从键盘输入当月利润I，求应发放奖金总数？</p>
<p>程序分析:请利用数轴来分界，定位。注意定义时需要把奖金定义成长整型。</p>
<p>程序源码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">int</span> i;<span class="comment">//当月0利润</span></span><br><span class="line">	<span class="keyword">int</span> bonus1,bonus2,bonus4,bonus6,bonus10,bonus;<span class="comment">//bonus奖金 </span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"请输入当月利润：\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%ld"</span>,&amp;i); </span><br><span class="line">	bonus1 = <span class="number">100000</span>*<span class="number">0.1</span>; <span class="comment">//&lt;=10万元 </span></span><br><span class="line">	bonus2 = bonus1 + <span class="number">200000</span> * <span class="number">0.75</span>; <span class="comment">// 10 ~ 20万元</span></span><br><span class="line">	bonus4 = bonus2 + <span class="number">200000</span> * <span class="number">0.5</span>; <span class="comment">// 20 ~ 40万元</span></span><br><span class="line">	bonus6 = bonus4 + <span class="number">200000</span> * <span class="number">0.3</span>; <span class="comment">// 40 ~ 60万元</span></span><br><span class="line">	bonus10 = bonus4 + <span class="number">400000</span> * <span class="number">0.15</span>; <span class="comment">// 60~100万元 </span></span><br><span class="line">	<span class="keyword">if</span>( i  &lt;= <span class="number">100000</span>)&#123;</span><br><span class="line">		bonus=i*<span class="number">0.1</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(i &lt;= <span class="number">200000</span>)&#123;</span><br><span class="line">		bonus = bonus1 + (i<span class="number">-100000</span>) * <span class="number">0.75</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(i &lt;= <span class="number">400000</span>)&#123;</span><br><span class="line">		bonus = bonus2 + (i<span class="number">-200000</span>) * <span class="number">0.5</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(i &lt;= <span class="number">600000</span>)&#123;</span><br><span class="line">		bonus = bonus4 + (i<span class="number">-400000</span>) * <span class="number">0.3</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(i&lt;<span class="number">10000000</span>)&#123;</span><br><span class="line">		bonus = bonus6 + (i<span class="number">-600000</span>) * <span class="number">0.15</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		bonus = bonus10 + (i<span class="number">-1000000</span>) * <span class="number">0.01</span>; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"当月利润I为：%d,应发放奖金为：%d"</span>,i,bonus);</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目3：一个整数，它加上100后是一个完全平方数，再加上168又是一个完全平方数，请问该数是多少？</p>
<p>程序分析：在10万以内判断，先将该数加上100后再开方，再将该数加上168后再开方，如果开方后的结果满足如下条件，即使结构。</p>
<p>程序源码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"math.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">long</span> i;</span><br><span class="line">	<span class="keyword">long</span> x,y;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">100000</span>;i++)&#123;</span><br><span class="line">		x=<span class="built_in">sqrt</span>(i+<span class="number">100</span>);</span><br><span class="line">		y=<span class="built_in">sqrt</span>(i+<span class="number">268</span>);</span><br><span class="line">		<span class="keyword">if</span>(x*x == i+<span class="number">100</span> &amp;&amp; y*y == i+<span class="number">268</span>)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%ld\n"</span>,i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目4：输入某年某月某日，判断这一天是这一年的第几天？</p>
<p>程序分析：以3月5日为例，应该先把前两个月的加起来，然后再加上5即本年的第几天，特殊情况，闰年且输入月份大于3时许考虑多加一天。</p>
<p>程序源码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="comment">//判断是否为闰年</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isLeaf</span><span class="params">(<span class="keyword">int</span> year)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>((year%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;year%<span class="number">100</span>!=<span class="number">0</span>)||year%<span class="number">400</span>==<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> year,month,days,leap,i=<span class="number">0</span>,a=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> sum=<span class="number">0</span>;<span class="comment">//总天数</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;year); </span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;month);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;days);</span><br><span class="line">	<span class="keyword">for</span>(a;a&lt;month;a++)&#123;</span><br><span class="line">		<span class="keyword">if</span>( a==<span class="number">1</span> || a==<span class="number">3</span> || a==<span class="number">5</span> || a==<span class="number">7</span> || a==<span class="number">8</span> || a==<span class="number">10</span> || a==<span class="number">12</span>)&#123;</span><br><span class="line">			i=<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>( a==<span class="number">4</span> || a==<span class="number">6</span> || a==<span class="number">9</span> || a==<span class="number">11</span>)&#123;</span><br><span class="line">			i=<span class="number">0</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(a==<span class="number">2</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(isLeaf(year))&#123;</span><br><span class="line">				i=<span class="number">-1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				i=<span class="number">-2</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		sum += (<span class="number">30</span>+i); </span><br><span class="line">	&#125;</span><br><span class="line">	 </span><br><span class="line">	sum += days;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d年%d月%d日是%d年的第%d天"</span>,year,month,days,year,sum);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isLeap</span><span class="params">(<span class="keyword">int</span> year)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(year%<span class="number">4</span>==<span class="number">0</span>&amp;&amp;year%<span class="number">100</span>!=<span class="number">0</span> || year%<span class="number">400</span>==<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> year,month,day,i,m=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> sum=<span class="number">0</span>;<span class="comment">//总天数 </span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"请输入年月日：格式为某某年/某某月/某某日\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d/%d/%d"</span>,&amp;year,&amp;month,&amp;day);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;month;i++)&#123;</span><br><span class="line">		<span class="keyword">switch</span>(i)&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">12</span>: m=<span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">11</span>:m=<span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">				<span class="keyword">if</span>(isLeap(year))&#123;</span><br><span class="line">					m=<span class="number">-1</span>;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					m=<span class="number">-2</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:<span class="built_in">printf</span>(<span class="string">"input month error\n"</span>);<span class="keyword">return</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">		sum += (<span class="number">30</span>+m);</span><br><span class="line">	&#125;</span><br><span class="line">	sum +=day;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d年%d月%d日是%d年的第%d天"</span>,year,month,day,year,sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目5：输入三个整数x,y,z，请把这三个数从小到大输出。</p>
<p>程序分析：我们想办法把最小的数放到x上，先将x，y进行比较，如果<code>x&gt;y</code>，则将x和y值进行交换，这样能使x最小。</p>
<p>程序源码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span> </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> x,y,z;</span><br><span class="line">	<span class="keyword">int</span> temp;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"请输入三个数：\n"</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d,%d,%d"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"未排序前三位数：%d--&gt;%d--&gt;%d"</span>,x,y,z);</span><br><span class="line">	<span class="keyword">if</span>(x&gt;y)&#123;</span><br><span class="line">		temp = x;</span><br><span class="line">		x = y;</span><br><span class="line">		y = temp;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(x&gt;z)&#123;</span><br><span class="line">		temp = x;</span><br><span class="line">		x=z;</span><br><span class="line">		z=temp;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(y&gt;z)&#123;</span><br><span class="line">		temp = y;</span><br><span class="line">		y=z;</span><br><span class="line">		z=temp;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n排序后三位数:%d--&gt;%d--&gt;%d\n"</span>,x,y,z);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目6：用*输出字母C的图案</p>
<p>程序分析：可以用’*’再纸上画出C，再分析输出。</p>
<p>源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"Hello C-world\n"</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"****\n"</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"*\n"</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"*\n"</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"****\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目7：输出特殊图案，请在c环境中运行，看一看，very beautiful!</p>
<p>程序分析：字符共有256个。不同字符，图形不一样。　</p>
<p>源码分析:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a=<span class="number">2</span>,b=<span class="number">4</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c%c%c%c%c\n"</span>,b,a,a,a,b);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c%c%c%c%c\n"</span>,a,b,a,b,a);	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c%c%c%c%c\n"</span>,a,a,b,a,a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c%c%c%c%c\n"</span>,a,b,a,b,a);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c%c%c%c%c\n"</span>,b,a,a,a,b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目8：输出9*9口诀。</p>
<p>程序分析：分行与列考虑，共9行9列，i控制行，j控制列。</p>
<p>程序源代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">9</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=i;j++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d ×%d = %d\t"</span>,j,i,j*i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目9：要求输出国际象棋棋盘。</p>
<p>程序分析：用i控制行，j来控制列，根据i+j的和的变化来控制输出黑方格，还是白方格。</p>
<p>程序源代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>((i+j)%<span class="number">2</span> ==<span class="number">0</span>)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%c%c"</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">			<span class="keyword">else</span> </span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line">		</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>); </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目10：打印楼梯，同时在楼梯上方打印两个笑脸。</p>
<p>程序分析：用i控制行，j来控制列，j根据i的变化来控制输出黑方格的个数。</p>
<p>程序源代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\1\1\n"</span>);<span class="comment">/*输出两个笑脸*/</span></span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;<span class="number">11</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=i;j++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%c%c"</span>,<span class="number">19</span>,<span class="number">19</span>);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目10：用递归实现全排列</p>
<p>程序分析：输入一个字符串，例如这里：输入ABC,首先第一位字符，先实现全排列，分别为A,B,C,D；然后余下两个再一次实现全排列，以此类推… </p>
<p>例如：(ABCD,n,len);//第一个参数为字符串，第二个参数为起始位置，第三个为字符串长度。<br>第一步：先交换实现全排列，即第一位可能为A或B或C或D<br>第二步：除去第一位字符后,剩下的字符继续全排列，即(Str,n+1,len)<br>第三步：还原为原来的位置</p>
<p>程序源码分析：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span></span></span><br><span class="line"><span class="comment">//去除重复</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isSame</span><span class="params">(<span class="keyword">char</span> str[],<span class="keyword">int</span> start,<span class="keyword">int</span> end)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=start;i&lt;end;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(str[i] == str[end])&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//函数交换</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">char</span> *p,<span class="keyword">char</span> *q)</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> temp;</span><br><span class="line">	temp=*p;</span><br><span class="line">	*p=*q;</span><br><span class="line">	*q=temp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//全排列</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Allarray</span><span class="params">(<span class="keyword">char</span> str[],<span class="keyword">int</span> n,<span class="keyword">int</span> len)</span></span>&#123;<span class="comment">//第一个参数字符串,第二个参数为第几个，第三个为字符串长度 </span></span><br><span class="line">	<span class="comment">//str,0,len</span></span><br><span class="line">	<span class="comment">//(AB,0,2)</span></span><br><span class="line">	<span class="keyword">if</span>(n==len)&#123;</span><br><span class="line">		<span class="keyword">static</span> <span class="keyword">int</span> s_i=<span class="number">1</span>; </span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"第%d中全排列为:\t%s\n"</span>,s_i++,str);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> i;</span><br><span class="line">		<span class="keyword">for</span>(i=n;i&lt;len;i++)&#123;</span><br><span class="line">			if0(isSame(str,n,i))&#123;</span><br><span class="line">				swap(&amp;str[n],&amp;str[i]);</span><br><span class="line">				Allarray(str,n+<span class="number">1</span>,len);</span><br><span class="line">				swap(&amp;str[n],&amp;str[i]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> str[<span class="number">80</span>];</span><br><span class="line">	<span class="keyword">int</span> len;<span class="comment">//长度 </span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"输入一个字符串：\n"</span>);</span><br><span class="line">	gets(str);</span><br><span class="line">	len=<span class="built_in">strlen</span>(str);</span><br><span class="line">	<span class="comment">//进行全排列</span></span><br><span class="line">	Allarray(str,<span class="number">0</span>,len); </span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="开发工具"><a href="#开发工具" class="headerlink" title="开发工具"></a>开发工具</h2><ul>
<li>这里使用的是dev-c++;</li>
<li>下载路径：<code>https://bloodshed-dev-c.en.softonic.com/download</code><h2 id="习题网址"><a href="#习题网址" class="headerlink" title="习题网址"></a>习题网址</h2></li>
<li><code>http://c.biancheng.net/view/531.html</code></li>
</ul>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/30/Lucene/">Lucene</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-30T04:52:24.000Z" itemprop="datePublished">2019-11-30</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/Lucene/">Lucene</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h1 id="Lucene-amp-Solr第一天"><a href="#Lucene-amp-Solr第一天" class="headerlink" title="Lucene&amp;Solr第一天"></a><code>Lucene</code>&amp;<code>Solr</code>第一天</h1><hr>
<h2 id="什么是全文检索"><a href="#什么是全文检索" class="headerlink" title="什么是全文检索"></a>什么是全文检索</h2><ul>
<li>数据分类<blockquote>
<ul>
<li>结果化数据：有固定的格式和有限长度，比如<code>Oracle</code>或<code>mysql</code>表中的数据。<blockquote>
<ul>
<li>使用SQL语句查询结构化数据，速度快。</li>
<li>如果数据量大时，可以在数据库中创建索引，但是此时创建的索引是不支持模糊查询，需要创建另外一套索引库。</li>
</ul>
</blockquote>
</li>
<li>非结构化数据：没有固定格式也没有有限长度。比如：磁盘上的文件，excel、word、pdf、txt、ppt等<blockquote>
<ul>
<li>查询非结构化数据：1、目测（顺序扫描法）、IO读取、3、全文检索</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>对数据源创建索引，在索引上搜索这个过程就是全文检索。（创建索引+查询）</li>
</ul>
<hr>
<h2 id="全文检索的应用场景"><a href="#全文检索的应用场景" class="headerlink" title="全文检索的应用场景"></a>全文检索的应用场景</h2><ul>
<li>搜索引擎：百度、搜狗、360 搜搜</li>
<li>站内搜索：淘宝、京东、微博、论坛</li>
</ul>
<hr>
<h2 id="怎么实现全文检索"><a href="#怎么实现全文检索" class="headerlink" title="怎么实现全文检索"></a>怎么实现全文检索</h2><ul>
<li>使用<code>lucene</code>实现</li>
</ul>
<hr>
<h2 id="Lucene简介"><a href="#Lucene简介" class="headerlink" title="Lucene简介"></a>Lucene简介</h2><ul>
<li>是<code>Apache</code>下的开源用来实现全文检索的工具包，API</li>
</ul>
<hr>
<h2 id="Lucene实现全文检索的流程"><a href="#Lucene实现全文检索的流程" class="headerlink" title="Lucene实现全文检索的流程"></a>Lucene实现全文检索的流程</h2><ol>
<li>创建索引<blockquote>
<ul>
<li>获取源文档<blockquote>
<ul>
<li>什么是源文档？场景1：搜索引擎：指的是互联网上的所有网页。场景2：站内搜索：磁盘上的文件或表中的数据。</li>
<li>获取源文档方式？场景1：搜索引擎：网络爬虫。场景2：站内搜索：IO流、sql查询</li>
</ul>
</blockquote>
</li>
<li>构建文档对象（Document）<blockquote>
<ul>
<li>一个<code>Document</code>对象中放的是：一个网页内容、或一个文件、或表中一条数据。</li>
</ul>
</blockquote>
</li>
<li>对内容分词（分析文档）<blockquote>
<ul>
<li>举例：一个文件包含信息：文件路径、文件名称、文件大小、文件内容。（document）</li>
<li>举例：一个网页包含信息：网络地址URL，网页内容、网页标题。(document)</li>
<li>举例：一条数据包含的信息：一条数据每个列的内容。（document）（有多少个列就有多少个域）</li>
<li>效果：<code>The Spring Framework provides a comprehensive programming and configuration model.</code>；</li>
<li>按空格大小分</li>
<li>处理大小写</li>
<li>停用词</li>
<li>标点符号</li>
<li>结果： spring、framework、provides、comprehensive、programming、configuration、model（每一个对应一个term）</li>
</ul>
</blockquote>
</li>
<li>创建索引（存储）<blockquote>
<ul>
<li>分词后的格式： name:spring name是自定义的域名城，spring是此域中的值；name:spring就是一个词汇item；一个文档中可以有多个域。不同的文档可以有不同的域。</li>
<li>创建索引是对语汇单元索引，通常词语找文档，这种索引结构叫做倒排索引结构。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>查询索引<blockquote>
<ul>
<li>用户查询接口：就是用户输入关键字的位置</li>
<li>创建查询</li>
<li>执行查询</li>
<li>渲染结果</li>
</ul>
</blockquote>
</li>
</ol>
<hr>
<h2 id="Lucene入门案例"><a href="#Lucene入门案例" class="headerlink" title="Lucene入门案例"></a>Lucene入门案例</h2><ul>
<li><p>所需要的<code>jar</code>包：</p>
<ul>
<li>核心的<code>jar</code>：<code>lucene-core-4.10.3.jar</code>、<code>lucene-analyzers-common-4.10.3.jar</code></li>
<li>IO所需要的包：commons-io.jar </li>
</ul>
</li>
<li><p>创建索引</p>
<ul>
<li>场景：给磁盘上的文件创建索引</li>
<li>步骤<ul>
<li>指定索引库位置 <code>Directory</code></li>
<li>创建写入索引位置<code>IndexWriter</code></li>
<li>获取源文档 <code>IO流</code></li>
<li>写入文档<code>indexWriter.addDocument(doc)；</code></li>
<li>关闭资源 <code>indexWriter.close();</code></li>
</ul>
</li>
<li>使用luke工具查看索引文件</li>
<li>luke安装地址：<code>https://github.com/DmitryKey/luke/releases</code><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.lucene;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.FileUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.Analyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.standard.StandardAnalyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.Document;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.Field;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.Field.Store;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.TextField;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.IndexWriter;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.IndexWriterConfig;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.store.FSDirectory;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.util.Version;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexWriterTest</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">	</span><br><span class="line">		<span class="comment">//1.指定索引库位置</span></span><br><span class="line">		FSDirectory directory = FSDirectory.open(<span class="keyword">new</span> File(<span class="string">"D:\\桌面\\Java\\lucene\\indexRepo"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//指定分词器</span></span><br><span class="line">		Analyzer analyzer=<span class="keyword">new</span> StandardAnalyzer();</span><br><span class="line">		</span><br><span class="line">		IndexWriterConfig config=<span class="keyword">new</span> IndexWriterConfig(Version.LATEST,analyzer);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//2.创建写入索引对象</span></span><br><span class="line">		IndexWriter indexWriter=<span class="keyword">new</span> IndexWriter(directory, config);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		3.获取源文档 </span></span><br><span class="line">		File srcFile = <span class="keyword">new</span> File(<span class="string">"D:\\txt"</span>);</span><br><span class="line">		File[] listFiles = srcFile.listFiles();</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		4. 把文档写入索引库</span></span><br><span class="line">		<span class="keyword">for</span> (File file : listFiles) &#123;</span><br><span class="line">			Document doc=<span class="keyword">new</span> Document();</span><br><span class="line">			<span class="comment">//文件路径、</span></span><br><span class="line">			String filePath = file.getPath();</span><br><span class="line">			Field pathField=<span class="keyword">new</span> TextField(<span class="string">"path"</span>, filePath, Store.YES) ;</span><br><span class="line">			doc.add(pathField);</span><br><span class="line">			<span class="comment">//文件名称、</span></span><br><span class="line">			String fileName = file.getName();</span><br><span class="line">			Field nameField=<span class="keyword">new</span> TextField(<span class="string">"name"</span>, fileName, Store.YES) ;</span><br><span class="line">			doc.add(nameField);</span><br><span class="line">			<span class="comment">//文件大小、</span></span><br><span class="line">			<span class="keyword">long</span> fileSize=FileUtils.sizeOf(file);</span><br><span class="line">			Field sizeField=<span class="keyword">new</span> TextField(<span class="string">"size"</span>, fileSize+<span class="string">""</span>, Store.YES) ;</span><br><span class="line">			doc.add(sizeField);</span><br><span class="line">			<span class="comment">//文件内容</span></span><br><span class="line">			String fileContent = FileUtils.readFileToString(file);</span><br><span class="line">			Field contentField=<span class="keyword">new</span> TextField(<span class="string">"content"</span>, fileContent+<span class="string">""</span>, Store.YES) ;</span><br><span class="line">			doc.add(contentField);</span><br><span class="line">			</span><br><span class="line">			indexWriter.addDocument(doc);</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//		5.关闭资源</span></span><br><span class="line">		indexWriter.close();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>查询索引</p>
<ul>
<li>指定索引库位置</li>
<li>创建读取索引对象</li>
<li>创建查询索引对象</li>
<li>执行索引</li>
<li>获取索引结果<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.lucene;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.document.Document;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.DirectoryReader;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.IndexReader;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.index.Term;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.search.IndexSearcher;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.search.Query;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.search.ScoreDoc;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.search.TermQuery;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.search.TopDocs;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.store.Directory;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.store.FSDirectory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexReaderTest</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//1. 指定索引库的位置</span></span><br><span class="line">		Directory directory = FSDirectory.open(<span class="keyword">new</span> File(<span class="string">"D:\\桌面\\Java\\lucene\\indexRepo"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//2.创建读取索引对象</span></span><br><span class="line">		IndexReader indexReader=DirectoryReader.open(directory);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//3. 创建查询索引对象</span></span><br><span class="line">		IndexSearcher indexSearcher = <span class="keyword">new</span> IndexSearcher(indexReader);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//4.执行查询方法 query:指定条件，result：查询数据量的限制</span></span><br><span class="line">		Term t=<span class="keyword">new</span> Term(<span class="string">"name"</span>,<span class="string">"spring"</span>);</span><br><span class="line">		Query query=<span class="keyword">new</span> TermQuery(t);</span><br><span class="line">		<span class="comment">//5.获取获取查询结果</span></span><br><span class="line">		TopDocs topDocs = indexSearcher.search(query, <span class="number">100</span>);</span><br><span class="line">		System.out.println(<span class="string">"总记录数："</span>+topDocs.totalHits);</span><br><span class="line">		ScoreDoc[] scoreDocs = topDocs.scoreDocs;</span><br><span class="line">		<span class="keyword">for</span> (ScoreDoc scoreDoc : scoreDocs) &#123;</span><br><span class="line">			<span class="keyword">int</span> docId = scoreDoc.doc;</span><br><span class="line">			Document doc = indexSearcher.doc(docId);</span><br><span class="line">			<span class="comment">//获取文档的内容</span></span><br><span class="line">			System.out.println(<span class="string">"文件名："</span>+doc.get(<span class="string">"name"</span>));</span><br><span class="line">			System.out.println(<span class="string">"文件大小："</span>+doc.get(<span class="string">"size"</span>));</span><br><span class="line">			System.out.println(<span class="string">"文件路径："</span>+doc.get(<span class="string">"path"</span>));</span><br><span class="line">			System.out.println(<span class="string">"文件内容："</span>+doc.get(<span class="string">"content"</span>));</span><br><span class="line">			System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//6.关闭资源</span></span><br><span class="line">		indexReader.close();</span><br><span class="line">				</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<hr>
<h2 id="分词器"><a href="#分词器" class="headerlink" title="分词器"></a>分词器</h2><ul>
<li><code>Analyzer</code>每个分词器的<code>tokenStream</code>方法<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.lucene;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.Analyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.TokenStream;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.cjk.CJKAnalyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.cn.smart.SmartChineseAnalyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.standard.StandardAnalyzer;</span><br><span class="line"><span class="keyword">import</span> org.apache.lucene.analysis.tokenattributes.CharTermAttribute;</span><br><span class="line"><span class="keyword">import</span> org.wltea.analyzer.lucene.IKAnalyzer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * StandardAnalyzer：按照空格分词（英文），中文是一个字一个字分隔（Analyzer analyzer=new StandardAnalyzer();）</span></span><br><span class="line"><span class="comment"> * CJKAnalyzer：Analyzer analyzer = new CJKAnalyzer();//中文两个字两个字</span></span><br><span class="line"><span class="comment"> * SmartChineseAnalyzer：中文还算可以，但是英文容易出现缺字母</span></span><br><span class="line"><span class="comment"> * IK-Analyzer：第三方分词器 IK-Analyzer 需要导入jar，需要加入两个配置文件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnalyzerTest</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">	</span><br><span class="line">		<span class="comment">//Analyzer analyzer=new StandardAnalyzer();</span></span><br><span class="line">		<span class="comment">//Analyzer analyzer = new CJKAnalyzer();//中文两个字两个字</span></span><br><span class="line">		<span class="comment">//Analyzer analyzer = new SmartChineseAnalyzer();</span></span><br><span class="line">		<span class="comment">//第三方分词器 IK-Analyzer 需要导入jar</span></span><br><span class="line">		Analyzer analyzer=<span class="keyword">new</span> IKAnalyzer();</span><br><span class="line">		TokenStream tokenStream = analyzer.tokenStream(<span class="keyword">null</span>, <span class="string">"apache场景1：搜索引擎：指的是互联网上的所有网页。场景2：站内搜索：磁盘上的文件或表中的数据。"</span>);</span><br><span class="line">		</span><br><span class="line">		CharTermAttribute charTermAttribute = tokenStream.addAttribute(CharTermAttribute.class);</span><br><span class="line">		</span><br><span class="line">		tokenStream.reset();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>(tokenStream.incrementToken()) &#123;</span><br><span class="line">			System.out.println(charTermAttribute);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="分词器的使用时机"><a href="#分词器的使用时机" class="headerlink" title="分词器的使用时机"></a>分词器的使用时机</h2><ul>
<li>需要查询就需要分词器</li>
<li>查询时也需要分词</li>
</ul>
<hr>
<h1 id="Lucene-amp-Solr第二天"><a href="#Lucene-amp-Solr第二天" class="headerlink" title="Lucene&amp;Solr第二天"></a><code>Lucene</code>&amp;<code>Solr</code>第二天</h1><h2 id="索引库的维护"><a href="#索引库的维护" class="headerlink" title="索引库的维护"></a>索引库的维护</h2><h2 id="Lucene的查询"><a href="#Lucene的查询" class="headerlink" title="Lucene的查询"></a>Lucene的查询</h2><h2 id="相关度排序"><a href="#相关度排序" class="headerlink" title="相关度排序"></a>相关度排序</h2><h2 id="什么是solr"><a href="#什么是solr" class="headerlink" title="什么是solr"></a>什么是<code>solr</code></h2><h2 id="solr的安装和配置"><a href="#solr的安装和配置" class="headerlink" title="solr的安装和配置"></a><code>solr</code>的安装和配置</h2><h2 id="Solr后台的使用"><a href="#Solr后台的使用" class="headerlink" title="Solr后台的使用"></a><code>Solr</code>后台的使用</h2><h2 id="使用solrj维护索引库"><a href="#使用solrj维护索引库" class="headerlink" title="使用solrj维护索引库"></a>使用<code>solrj</code>维护索引库</h2>
        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/29/Elasticsearch/">Elasticsearch</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-29T11:18:12.000Z" itemprop="datePublished">2019-11-29</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/Elasticsearch/">Elasticsearch</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        
        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/29/solr/">solr</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-29T11:17:57.000Z" itemprop="datePublished">2019-11-29</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/solr/">solr</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="Solr简介"><a href="#Solr简介" class="headerlink" title="Solr简介"></a><code>Solr</code>简介</h2><p>Lucene是API，类库，solr是基于Lucene开发的一个项目，solr是一个独立的搜索引擎服务</p>
<h2 id="安装配置-windows版"><a href="#安装配置-windows版" class="headerlink" title="安装配置(windows版)"></a>安装配置(windows版)</h2><p>安装solr-5.20</p>
<p><img src="https://i.loli.net/2019/12/21/wrCAz4xluXQHMSt.png" alt="1576932517_1_.png"></p>
<p><img src="https://i.loli.net/2019/12/21/8HfNr4Kb3zxp7Xw.png" alt="1576933811_1_.png"></p>
<ol>
<li>准备一个干净的tomcat</li>
<li>把solr/dist的war包拷贝到tomcat的webapp文件夹下</li>
<li>把war解压（直接启动tomcat）</li>
<li>配置solrHome（就是索引库的位置）<ol>
<li>把 <code>\solr-4.10.3\example\solr</code>下所有文件都拷贝到指定文件夹下</li>
<li>配置solr项目与solrHome的关系，修改solr项目下的web.xml的配置文件</li>
</ol>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">env-entry</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">env-entry-name</span>&gt;</span>solr/home<span class="tag">&lt;/<span class="name">env-entry-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">env-entry-value</span>&gt;</span>D:\桌面\Java\solr\solrHome<span class="tag">&lt;/<span class="name">env-entry-value</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">env-entry-type</span>&gt;</span>java.lang.String<span class="tag">&lt;/<span class="name">env-entry-type</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">env-entry</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>添加solr项目运行的扩展包，把<code>\solr-4.10.3\example\lib\ext</code>下的所有jar包放入到solr的lib包下</li>
<li>重新启动tomcat</li>
<li>访问solr:<code>localhost:8080/solr</code></li>
</ol>
<h2 id="Linux版本-（solr-7-7-2-tar-gz为例）"><a href="#Linux版本-（solr-7-7-2-tar-gz为例）" class="headerlink" title="Linux版本 （solr-7.7.2.tar.gz为例）"></a>Linux版本 （solr-7.7.2.tar.gz为例）</h2><p>安装前提条件：环境中jdk以及tomcat服务器，本人所使用的是<code>jdk-1.8.0_221</code>，<code>tomcat-8.5.23</code></p>
<ol>
<li>到官网下载<code>solr</code>工具：<code>http://lucene.apache.org/</code>；</li>
<li>将下载好的工具上传到Linux服务器上；</li>
<li>解压tar.gz，得到solr-7.7.2文件夹</li>
<li>创建<code>/usr/local/solr</code>,并将<code>/solr-7.7.2/server/</code>下的<code>solr/</code>文件夹复制到<code>/usr/local/solr</code>文件下，并且重命名为<code>solrhome</code>；</li>
<li>将<code>solr-7.7.2/server/solr-webapp/webapp/</code>复制到<code>tomcat/webapps/</code>目录下，并将其重新命名为<code>solr</code></li>
<li>将<code>solr-7.7.2/server/lib/ext</code>下的jar包和 <code>solr-7.7.2/server/lib/</code>下所有以“metrics”开头的 jar 包复制到<code>tomcat/webapps/solr/WEB-INF/lib</code>目录下。</li>
<li>修改web.xml配置文件，添加第一个文件代码，注释掉第二个文件代码</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">env-entry</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">env-entry-name</span>&gt;</span>solr/home<span class="tag">&lt;/<span class="name">env-entry-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">env-entry-value</span>&gt;</span>/usr/local/solr/solrhome<span class="tag">&lt;/<span class="name">env-entry-value</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">env-entry-type</span>&gt;</span>java.lang.String<span class="tag">&lt;/<span class="name">env-entry-type</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">env-entry</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Get rid of error message --&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> &lt;security-constraint&gt;</span></span><br><span class="line"><span class="comment">   &lt;web-resource-collection&gt;</span></span><br><span class="line"><span class="comment">     &lt;web-resource-name&gt;Disable TRACE&lt;/web-resource-name&gt;</span></span><br><span class="line"><span class="comment">     &lt;url-pattern&gt;/&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">     &lt;http-method&gt;TRACE&lt;/http-method&gt;</span></span><br><span class="line"><span class="comment">   &lt;/web-resource-collection&gt;</span></span><br><span class="line"><span class="comment">   &lt;auth-constraint/&gt;</span></span><br><span class="line"><span class="comment"> &lt;/security-constraint&gt;</span></span><br><span class="line"><span class="comment"> &lt;security-constraint&gt;</span></span><br><span class="line"><span class="comment">   &lt;web-resource-collection&gt;</span></span><br><span class="line"><span class="comment">     &lt;web-resource-name&gt;Enable everything but TRACE&lt;/web-resource-name&gt;</span></span><br><span class="line"><span class="comment">     &lt;url-pattern&gt;/&lt;/url-pattern&gt;</span></span><br><span class="line"><span class="comment">     &lt;http-method-omission&gt;TRACE&lt;/http-method-omission&gt;</span></span><br><span class="line"><span class="comment">   &lt;/web-resource-collection&gt;</span></span><br><span class="line"><span class="comment"> &lt;/security-constraint&gt;</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="8">
<li>启动tomcat服务器 tomcat/bin/startup.sh</li>
<li>在本地打开<code>http://localhost:8080/solr/index.html</code>,远程打开<code>http://服务器ip地址:8080/solr/index.html</code></li>
<li>配置成功后的UI界面</li>
</ol>
<p><img src="https://i.loli.net/2019/12/18/is5mSrtyd63P7xv.png" alt="1576672151_1_.png"></p>
<ul>
<li>本次下载参考<code>https://blog.csdn.net/frgod/article/details/78960917</code>;<h2 id="Solr-core类比成mysql的database"><a href="#Solr-core类比成mysql的database" class="headerlink" title="Solr core类比成mysql的database"></a>Solr core类比成mysql的database</h2></li>
</ul>
<p>添加solr Core步骤</p>
<ol>
<li>复制solrHome下的collection1文件夹</li>
<li>粘贴到solrHome下，修改名字collection2</li>
<li>修改collection2文件夹下的core.properties</li>
<li>重启tomcat服务器</li>
</ol>
<p>注意：solr1中的域名是先定义后使用</p>
<h2 id="索引的文档和域的概念"><a href="#索引的文档和域的概念" class="headerlink" title="索引的文档和域的概念"></a>索引的文档和域的概念</h2><ol>
<li>在<code>Lucene</code>中每一个文档的域都是通过代码来创建的。</li>
<li>在<code>Solr</code>中的域是通过配置为文件配置。</li>
</ol>
<p><img src="https://i.loli.net/2019/12/26/KWv5y2k6quXD9Pp.png" alt="1577355587_1_.png"></p>
<ol start="3">
<li><p>在<code>schema.xml</code>中定义了<code>field</code>和<code>fieldType</code></p>
</li>
<li><p><code>sortMassingLast</code>：设置成true没有该field的数据排在有该field的数据之后，而不管请求时的排序规则，默认设置成false.</p>
</li>
</ol>
<h2 id="Solr整合IKAnalyzer分词器"><a href="#Solr整合IKAnalyzer分词器" class="headerlink" title="Solr整合IKAnalyzer分词器"></a>Solr整合IKAnalyzer分词器</h2><p>模式配置<code>Schema.xml</code> </p>
<p><code>IkAnalyzer</code></p>
<ol>
<li><p>拷贝<code>IkAnalyzer</code>的文件到<code>tomcat</code>下的<code>solr</code>目录中</p>
</li>
<li><p>将<code>IKAnalyzer2012_V5.jar</code>拷贝到<code>tomcat</code>的<code>webapps/solr/WEB-INF/lib</code>下</p>
</li>
<li><p>在<code>tomcat</code>的<code>webapps/solr/WEB-INF/</code>下创建<code>classes</code>目录</p>
</li>
<li><p>将<code>IKAnalyzer.cfg.xml</code>、<code>ext_stopwords.dic</code>、<code>mvdict.dic</code> copy到Tomcat的<code>webapps/solr/WEB-INF/classes</code></p>
<p> 注意：<code>ext_stopwords.dic</code>、<code>mvdict.dic</code>必须保存成无<code>BOM</code>的<code>utf-8</code>类型</p>
</li>
<li><p>首先需要在<code>types</code>结点内定义一个<code>FieldType</code>子结点，包括<code>name</code>、<code>class</code>等属性，<code>name</code>就是这个<code>FieldType</code>的属性名称，<code>class</code>指向<code>org.apache.solr.analysis</code>包里面对应的<code>class</code>名称，用来定义这个类型的行为。在<code>FieldType</code>定义的时候做重要的就是定义这个类型的数据在建立索引和查询的时候要使用的分析器，包括分词和过滤</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"text_ik"</span> <span class="attr">class</span>=<span class="string">"solr.TextField"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">analyzer</span> <span class="attr">type</span>=<span class="string">"index"</span> <span class="attr">isMaxWordLength</span>=<span class="string">"false"</span> <span class="attr">class</span>=<span class="string">"org.wltea.analyzer.lucene.IKAnalyzer"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">analyzer</span> <span class="attr">type</span>=<span class="string">"query"</span> <span class="attr">isMaxWordLength</span>=<span class="string">"true"</span> <span class="attr">class</span>=<span class="string">"org.wltea.analyzer.lucene.IKAnalyzer"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">fieldType</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="使用solr控制台"><a href="#使用solr控制台" class="headerlink" title="使用solr控制台"></a>使用solr控制台</h2><ol>
<li><p>添加索引</p>
<ul>
<li>注意：solr中的域名是先定义后使用；添加文档时id不能少。</li>
</ul>
</li>
<li><p>删除索引</p>
<ul>
<li><code>&lt;delete&gt;&lt;id&gt;1&lt;/id&gt;&lt;/delete&gt;&lt;commit/&gt;</code>：根据id删除索引</li>
<li><code>&lt;delete&gt;&lt;query&gt;id:2&lt;/query&gt;&lt;/delete&gt;&lt;commit/&gt;</code>：根据lucene语法删除索引</li>
<li><code>&lt;delete&gt;&lt;query&gt;*:*&lt;/query&gt;&lt;/delete&gt;&lt;commit/&gt;</code>：根据lucene语法删除所有</li>
<li>注意：删除索引需要修改<code>document type</code>类型为<code>xml</code>格式。 </li>
</ul>
</li>
<li><p>修改索引：<br> 只要id相同就会被修改</p>
</li>
<li><p>查询索引</p>
<ul>
<li><code>AND</code>：相当于Java的<code>&amp;&amp;</code></li>
<li><code>OR</code>：相当于Java的<code>||</code></li>
</ul>
</li>
</ol>
<h2 id="java代码操作solr，solrJ"><a href="#java代码操作solr，solrJ" class="headerlink" title="java代码操作solr，solrJ"></a><code>java</code>代码操作<code>solr</code>，solrJ</h2><ol>
<li>创建Java Project项目</li>
<li>添加jar包<ul>
<li>solrJ核心包:<code>solr-4.10.3\dist\solr-solrj-4.10.3.jar</code></li>
<li>solrJ扩展包:<code>solr-4.10.3\dist\solrj-lib</code>下所有包</li>
<li>solr扩展包:<code>solr-4.10.3\example\lib\ext</code>下所有包</li>
</ul>
</li>
<li>代码实现</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrServer;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrServerException;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.impl.HttpSolrServer;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.SolrInputDocument;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SolrManager</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addIndex</span><span class="params">()</span> <span class="keyword">throws</span> SolrServerException, IOException </span>&#123;</span><br><span class="line"><span class="comment">//		1.获取solr服务器，用于连接solr项目</span></span><br><span class="line">		SolrServer solrServer = <span class="keyword">new</span> HttpSolrServer(<span class="string">"http://localhost:8080/solr/collection1"</span>);</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		2.执行SolrServer的添加方法</span></span><br><span class="line">		SolrInputDocument doc=<span class="keyword">new</span> SolrInputDocument();</span><br><span class="line">		doc.addField(<span class="string">"name"</span>, <span class="string">"solrJ添加name"</span>);</span><br><span class="line">		doc.addField(<span class="string">"content"</span>, <span class="string">"solrJ添加content"</span>);</span><br><span class="line">		doc.addField(<span class="string">"id"</span>, <span class="string">"4"</span>);</span><br><span class="line">		solrServer.add(doc);</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		3.执行提交</span></span><br><span class="line">		solrServer.commit();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrQuery;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrServer;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrServerException;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.impl.HttpSolrServer;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.response.QueryResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.SolrDocument;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.SolrDocumentList;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.SolrInputDocument;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.params.SolrParams;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.bean.Article;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * 使用SolrJ来调用Solr服务...</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 1huangzewei</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SolrJ</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 添加索引</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> SolrServerException</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addIndex</span><span class="params">()</span> <span class="keyword">throws</span> SolrServerException, IOException </span>&#123;</span><br><span class="line">		String urlString=<span class="string">"http://localhost:8080/solr/collection1"</span>;</span><br><span class="line">		SolrServer solr=<span class="keyword">new</span> HttpSolrServer(urlString);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//第一种添加方式</span></span><br><span class="line"><span class="comment">//		SolrInputDocument docs=new SolrInputDocument();</span></span><br><span class="line"><span class="comment">//		docs.addField("id","2");</span></span><br><span class="line"><span class="comment">//		docs.addField("name", "张三");</span></span><br><span class="line"><span class="comment">//		docs.addField("content","这是一个普通的名字");</span></span><br><span class="line"><span class="comment">//		solr.add(docs);</span></span><br><span class="line"><span class="comment">//		solr.commit();</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//第二种添加方式</span></span><br><span class="line"><span class="comment">//		Article article=new Article(7,"疯狂Java讲义","JavaSE部分",13.99);</span></span><br><span class="line"><span class="comment">//		solr.addBean(article);</span></span><br><span class="line">		List&lt;Article&gt; list=<span class="keyword">new</span> ArrayList&lt;Article&gt;();</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">25</span>;i++) &#123;			</span><br><span class="line">			list.add(<span class="keyword">new</span> Article(i,<span class="string">"疯狂前端讲义"</span>,<span class="string">"前端基础知识"</span>,<span class="number">93.3</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		solr.addBeans(list);</span><br><span class="line">		solr.commit();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 删除索引</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> SolrServerException</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delIndex</span><span class="params">()</span> <span class="keyword">throws</span> SolrServerException, IOException </span>&#123;</span><br><span class="line">		String urlString=<span class="string">"http://localhost:8080/solr/collection1"</span>;</span><br><span class="line">		SolrServer solr=<span class="keyword">new</span> HttpSolrServer(urlString);</span><br><span class="line">		solr.deleteById(<span class="string">"2"</span>);</span><br><span class="line">		solr.commit();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//更新的话如果id相同，它会直接更新</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 查询指定索引</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> SolrServerException</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFind</span><span class="params">()</span> <span class="keyword">throws</span> SolrServerException, IOException </span>&#123;</span><br><span class="line">		String urlString=<span class="string">"http://localhost:8080/solr/collection1"</span>;</span><br><span class="line">		SolrServer solr=<span class="keyword">new</span> HttpSolrServer(urlString);</span><br><span class="line">		<span class="comment">//以后参数都是这个对象去构造...</span></span><br><span class="line">		SolrQuery solrParams=<span class="keyword">new</span> SolrQuery();</span><br><span class="line">		solrParams.setQuery(<span class="string">"title:疯狂Java讲义"</span>);</span><br><span class="line">		</span><br><span class="line">		QueryResponse queryResponse = solr.query(solrParams);</span><br><span class="line">		</span><br><span class="line">		SolrDocumentList results = queryResponse.getResults();</span><br><span class="line">		<span class="keyword">for</span> (SolrDocument solrDocument : results) &#123;</span><br><span class="line">			Object id = solrDocument.get(<span class="string">"id"</span>);</span><br><span class="line">			Object name = solrDocument.get(<span class="string">"title"</span>);</span><br><span class="line">			Object content = solrDocument.get(<span class="string">"content"</span>);</span><br><span class="line">			System.out.println(id);</span><br><span class="line">			System.out.println(name);</span><br><span class="line">			System.out.println(content);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 分页查询</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> SolrServerException</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindPage</span><span class="params">()</span> <span class="keyword">throws</span> SolrServerException, IOException </span>&#123;</span><br><span class="line">		String urlString=<span class="string">"http://localhost:8080/solr/collection1"</span>;</span><br><span class="line">		SolrServer solr=<span class="keyword">new</span> HttpSolrServer(urlString);</span><br><span class="line">		<span class="comment">//以后参数都是这个对象去构造...</span></span><br><span class="line">		SolrQuery solrParams=<span class="keyword">new</span> SolrQuery();</span><br><span class="line">		solrParams.setQuery(<span class="string">"title:疯狂前端讲义"</span>);</span><br><span class="line">		solrParams.setRows(<span class="number">10</span>);</span><br><span class="line">		solrParams.setStart(<span class="number">0</span>);</span><br><span class="line">		</span><br><span class="line">		QueryResponse queryResponse = solr.query(solrParams);</span><br><span class="line">		SolrDocumentList results = queryResponse.getResults();</span><br><span class="line">		<span class="keyword">for</span> (SolrDocument solrDocument : results) &#123;</span><br><span class="line">			Object id = solrDocument.get(<span class="string">"id"</span>);</span><br><span class="line">			Object name = solrDocument.get(<span class="string">"title"</span>);</span><br><span class="line">			Object content = solrDocument.get(<span class="string">"content"</span>);</span><br><span class="line">			System.out.println(id);</span><br><span class="line">			System.out.println(name);</span><br><span class="line">			System.out.println(content);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 显示高亮</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> SolrServerException</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindHighLight</span><span class="params">()</span> <span class="keyword">throws</span> SolrServerException, IOException </span>&#123;</span><br><span class="line">		String urlString=<span class="string">"http://localhost:8080/solr/collection1"</span>;</span><br><span class="line">		SolrServer solr=<span class="keyword">new</span> HttpSolrServer(urlString);</span><br><span class="line">		<span class="comment">//以后参数都是这个对象去构造...</span></span><br><span class="line">		SolrQuery solrParams=<span class="keyword">new</span> SolrQuery();</span><br><span class="line">		solrParams.setQuery(<span class="string">"title:小健"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//高亮开启</span></span><br><span class="line">		solrParams.setHighlight(<span class="keyword">true</span>);</span><br><span class="line">		<span class="comment">//高亮显示格式</span></span><br><span class="line">		solrParams.setHighlightSimplePre(<span class="string">"&lt;font color='red'&gt;"</span>);</span><br><span class="line">		solrParams.setHighlightSimplePost(<span class="string">"&lt;/font&gt;"</span>);</span><br><span class="line">		<span class="comment">//我需要哪几个字段进行高亮</span></span><br><span class="line">		solrParams.setParam(<span class="string">"h1.fl"</span>, <span class="string">"title"</span>);</span><br><span class="line">		QueryResponse queryResponse = solr.query(solrParams);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//返回所有查询结果</span></span><br><span class="line">		SolrDocumentList results = queryResponse.getResults();</span><br><span class="line">		</span><br><span class="line">		Map&lt;String, Map&lt;String, List&lt;String&gt;&gt;&gt; maplist = queryResponse.getHighlighting();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> (SolrDocument solrDocument : results) &#123;</span><br><span class="line">			Object id = solrDocument.get(<span class="string">"id"</span>);</span><br><span class="line">			Map&lt;String, List&lt;String&gt;&gt; fieldMap = maplist.get(id);</span><br><span class="line">			List&lt;String&gt; list = fieldMap.get(<span class="string">"title"</span>);</span><br><span class="line">			System.out.println(list);</span><br><span class="line"><span class="comment">//			Object name = solrDocument.get("title");</span></span><br><span class="line"><span class="comment">//			Object content = solrDocument.get("content");</span></span><br><span class="line"><span class="comment">//			System.out.println(id);</span></span><br><span class="line"><span class="comment">//			System.out.println(name);</span></span><br><span class="line"><span class="comment">//			System.out.println(content);</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="添加自定义域名"><a href="#添加自定义域名" class="headerlink" title="添加自定义域名"></a>添加自定义域名</h2><ol>
<li>找到SolrCore下得config/schema.xml<ul>
<li>field属性：name域名称 type域名称 indexed是否索引 stored是否存储 multiValued是否可以存储多值。</li>
<li>dynamicFiled：name=<code>&quot;*_i&quot;</code>: 通配符</li>
<li><code>&lt;uniqueKey&gt;id&lt;/uniqueKey&gt;</code>：主要值</li>
<li>copyField属性：source源域名 dest目标域名</li>
<li>fieldType属性：name类型名称 class类型对应的类</li>
</ul>
</li>
<li>自定义field.在schema.xml中添加如下信息</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--自定义Field--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"title_ik"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"content_ik"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"false"</span> <span class="attr">multiValued</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">&lt;!--类型 IKAnalyzer--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"text_ik"</span> <span class="attr">class</span>=<span class="string">"solr.TextField"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">analyzer</span> <span class="attr">class</span>=<span class="string">"org.wltea.analyzer.lucene.IKAnalyzer"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">fieldType</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>把IkAnalyzer的jar和配置文件放到solr项目/WEB-INF/lib目录下，配置文件放到/solr/WEB-INF/classes目录下。classes如果没有，就重新创建。</li>
</ol>
<h2 id="将数据库中的数据导入到索引库"><a href="#将数据库中的数据导入到索引库" class="headerlink" title="将数据库中的数据导入到索引库"></a>将数据库中的数据导入到索引库</h2><p>solr-5.20版本</p>
<ol>
<li><p>在<code>solrHome</code>下创建一个<code>lib</code>目录</p>
</li>
<li><p>将mysql驱动包和<code>solr-5.20/dist/</code>下的两个<code>Dataimport</code>包拷贝到<code>lib</code>目录下.</p>
</li>
<li><p>修改<code>solrHome/core/conf</code>目录下<code>solrconfig.xml</code>配置文件，添加一个<code>requestHandler</code></p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--数据库导入--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">requestHandler</span> <span class="attr">name</span>=<span class="string">"/dataimport"</span> <span class="attr">class</span>=<span class="string">"org.apache.solr.handler.dataimport.DataImportHandler"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">lst</span> <span class="attr">name</span>=<span class="string">"defaults"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">str</span> <span class="attr">name</span>=<span class="string">"config"</span>&gt;</span>data-config.xml<span class="tag">&lt;/<span class="name">str</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">lst</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">requestHandler</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>编写<code>data-config.xml</code>文件，存放在<code>solrCore</code>的<code>conf</code>目录</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">dataConfig</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"JdbcDataSource"</span>   </span></span><br><span class="line"><span class="tag">		  <span class="attr">driver</span>=<span class="string">"com.mysql.jdbc.Driver"</span>   </span></span><br><span class="line"><span class="tag">		  <span class="attr">url</span>=<span class="string">"jdbc:mysql://localhost:3306/solr"</span>   </span></span><br><span class="line"><span class="tag">		  <span class="attr">user</span>=<span class="string">"root"</span>   </span></span><br><span class="line"><span class="tag">		  <span class="attr">password</span>=<span class="string">"123456"</span>/&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">document</span>&gt;</span>   </span><br><span class="line">	<span class="tag">&lt;<span class="name">entity</span> <span class="attr">name</span>=<span class="string">"product"</span> <span class="attr">query</span>=<span class="string">"SELECT pid,name,catalog_name,price,description,picture FROM products "</span>&gt;</span></span><br><span class="line">		 <span class="tag">&lt;<span class="name">field</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">name</span>=<span class="string">"id"</span>/&gt;</span> </span><br><span class="line">		 <span class="tag">&lt;<span class="name">field</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">name</span>=<span class="string">"product_name"</span>/&gt;</span> </span><br><span class="line">		 <span class="tag">&lt;<span class="name">field</span> <span class="attr">column</span>=<span class="string">"catalog_name"</span> <span class="attr">name</span>=<span class="string">"product_catalog_name"</span>/&gt;</span> </span><br><span class="line">		 <span class="tag">&lt;<span class="name">field</span> <span class="attr">column</span>=<span class="string">"price"</span> <span class="attr">name</span>=<span class="string">"product_price"</span>/&gt;</span> </span><br><span class="line">		 <span class="tag">&lt;<span class="name">field</span> <span class="attr">column</span>=<span class="string">"description"</span> <span class="attr">name</span>=<span class="string">"product_description"</span>/&gt;</span> </span><br><span class="line">		 <span class="tag">&lt;<span class="name">field</span> <span class="attr">column</span>=<span class="string">"picture"</span> <span class="attr">name</span>=<span class="string">"product_picture"</span>/&gt;</span> </span><br><span class="line">	<span class="tag">&lt;/<span class="name">entity</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;/<span class="name">document</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;/<span class="name">dataConfig</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>在<code>scheml.xml</code>中添加<code>field</code>属性</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"product_name"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span> <span class="attr">multiValued</span>=<span class="string">"true"</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"product_catalog_name"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span> <span class="attr">multiValued</span>=<span class="string">"true"</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"product_price"</span> <span class="attr">type</span>=<span class="string">"tdouble"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span> <span class="attr">multiValued</span>=<span class="string">"false"</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"product_description"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"false"</span> <span class="attr">multiValued</span>=<span class="string">"false"</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"product_picture"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"false"</span> <span class="attr">stored</span>=<span class="string">"true"</span> <span class="attr">multiValued</span>=<span class="string">"true"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>Solr-4.10版本</p>
<ol>
<li>找到SolrCore下得config/schema.xml,添加自定义域.</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--自定义Field--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"title_ik"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"content_ik"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"false"</span> <span class="attr">multiValued</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--类型 IKAnalyzer--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fieldType</span> <span class="attr">name</span>=<span class="string">"text_ik"</span> <span class="attr">class</span>=<span class="string">"solr.TextField"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">analyzer</span> <span class="attr">class</span>=<span class="string">"org.wltea.analyzer.lucene.IKAnalyzer"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">fieldType</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--product--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"product_name"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"product_price"</span>  <span class="attr">type</span>=<span class="string">"float"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"product_description"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"product_picture"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"false"</span> <span class="attr">stored</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"product_catalog_name"</span> <span class="attr">type</span>=<span class="string">"string"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"product_keywords"</span> <span class="attr">type</span>=<span class="string">"text_ik"</span> <span class="attr">indexed</span>=<span class="string">"true"</span> <span class="attr">stored</span>=<span class="string">"false"</span> <span class="attr">multiValued</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">copyField</span> <span class="attr">source</span>=<span class="string">"product_name"</span> <span class="attr">dest</span>=<span class="string">"product_keywords"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">copyField</span> <span class="attr">source</span>=<span class="string">"product_description"</span> <span class="attr">dest</span>=<span class="string">"product_keywords"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>导入数据</p>
<ul>
<li>定义<code>dataimport-handler</code>步骤：</li>
</ul>
<ol>
<li>打开collection1/cinfig/solrconfig.xml</li>
<li>导入jar包，放入到<code>solrHome\collection1\lib</code>,<code>solr-4.10.3\dist\solr-dataimporthandler-4.10.3.jar</code>、<code>solr-4.10.3\dist\solr-dataimporthandler-extras-4.10.3.jar</code>、<code>mysql-connector-java-5.1.7-bin.jar</code></li>
<li>在solrconfig.xml中，添加一个<code>requestHandler</code></li>
<li>创建配置文件<code>data-config.xml</code>，并将该配置文件放到<code>solrconfig</code>同级目录下</li>
<li>重启tomcat服务器。</li>
</ol>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--solrconfig.xml--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">requestHandler</span> <span class="attr">name</span>=<span class="string">"/dataimport"</span> <span class="attr">class</span>=<span class="string">"org.apache.solr.handler.dataimport.DataImportHandler"</span>&gt;</span></span><br><span class="line">		 <span class="tag">&lt;<span class="name">lst</span> <span class="attr">name</span>=<span class="string">"defaults"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">str</span> <span class="attr">name</span>=<span class="string">"config"</span>&gt;</span>data-config.xml<span class="tag">&lt;/<span class="name">str</span>&gt;</span></span><br><span class="line">		 <span class="tag">&lt;/<span class="name">lst</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">requestHandler</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--data-config.xml--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">dataConfig</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"JdbcDataSource"</span>   </span></span><br><span class="line"><span class="tag">		  <span class="attr">driver</span>=<span class="string">"com.mysql.jdbc.Driver"</span>   </span></span><br><span class="line"><span class="tag">		  <span class="attr">url</span>=<span class="string">"jdbc:mysql://localhost:3306/lucene"</span>   </span></span><br><span class="line"><span class="tag">		  <span class="attr">user</span>=<span class="string">"root"</span>   </span></span><br><span class="line"><span class="tag">		  <span class="attr">password</span>=<span class="string">"root"</span>/&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">document</span>&gt;</span>   </span><br><span class="line">	<span class="tag">&lt;<span class="name">entity</span> <span class="attr">name</span>=<span class="string">"product"</span> <span class="attr">query</span>=<span class="string">"SELECT pid,name,catalog_name,price,description,picture FROM products "</span>&gt;</span></span><br><span class="line">		 <span class="tag">&lt;<span class="name">field</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">name</span>=<span class="string">"id"</span>/&gt;</span> </span><br><span class="line">		 <span class="tag">&lt;<span class="name">field</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">name</span>=<span class="string">"product_name"</span>/&gt;</span> </span><br><span class="line">		 <span class="tag">&lt;<span class="name">field</span> <span class="attr">column</span>=<span class="string">"catalog_name"</span> <span class="attr">name</span>=<span class="string">"product_catalog_name"</span>/&gt;</span> </span><br><span class="line">		 <span class="tag">&lt;<span class="name">field</span> <span class="attr">column</span>=<span class="string">"price"</span> <span class="attr">name</span>=<span class="string">"product_price"</span>/&gt;</span> </span><br><span class="line">		 <span class="tag">&lt;<span class="name">field</span> <span class="attr">column</span>=<span class="string">"description"</span> <span class="attr">name</span>=<span class="string">"product_description"</span>/&gt;</span> </span><br><span class="line">		 <span class="tag">&lt;<span class="name">field</span> <span class="attr">column</span>=<span class="string">"picture"</span> <span class="attr">name</span>=<span class="string">"product_picture"</span>/&gt;</span> </span><br><span class="line">	<span class="tag">&lt;/<span class="name">entity</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;/<span class="name">document</span>&gt;</span>   </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dataConfig</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Java代码实现solr复杂查询"><a href="#Java代码实现solr复杂查询" class="headerlink" title="Java代码实现solr复杂查询"></a>Java代码实现solr复杂查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.dao;</span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * solrj操作服务器...</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 1huangzewei</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrQuery;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrQuery.ORDER;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrServer;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.impl.HttpSolrServer;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.response.QueryResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.SolrDocument;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.SolrDocumentList;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SolrManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchIndex</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		1.获取solr的服务器 用于连接solr项目</span></span><br><span class="line">		SolrServer solrServer=<span class="keyword">new</span> HttpSolrServer(<span class="string">"http://localhost:8080/solr/collection1"</span>);</span><br><span class="line">		SolrQuery solrQuery=<span class="keyword">new</span> SolrQuery();</span><br><span class="line">		<span class="comment">//设置主查询条件</span></span><br><span class="line"><span class="comment">//	      "q": "花儿朵朵",</span></span><br><span class="line">		solrQuery.setQuery(<span class="string">"花儿朵朵"</span>);</span><br><span class="line">		<span class="comment">//设置过滤查询</span></span><br><span class="line"><span class="comment">//		  "fq":"过滤"</span></span><br><span class="line">		solrQuery.set(<span class="string">"fq"</span>,<span class="string">"product_catalog_name:时尚卫浴"</span>);</span><br><span class="line">		solrQuery.set(<span class="string">"fq"</span>,<span class="string">"product_price:[0 TO 200]"</span>);</span><br><span class="line">		<span class="comment">//设置分页查询</span></span><br><span class="line"><span class="comment">//		  "start":"0",</span></span><br><span class="line"><span class="comment">//	      "rows":"10"</span></span><br><span class="line">		solrQuery.setStart(<span class="number">0</span>);</span><br><span class="line">		solrQuery.setRows(<span class="number">10</span>);</span><br><span class="line">		<span class="comment">//设置默认查询条件</span></span><br><span class="line"><span class="comment">//	      "df": "product_keywords",</span></span><br><span class="line">		solrQuery.set(<span class="string">"df"</span>,<span class="string">"product_keywords"</span>);</span><br><span class="line">		<span class="comment">//开启高亮</span></span><br><span class="line"><span class="comment">//	      "hl": "true",</span></span><br><span class="line"><span class="comment">//		  "hl.simple.pre": "&lt;span color='red'&gt;",</span></span><br><span class="line"><span class="comment">//	      "hl.simple.post": "&lt;/span&gt;",</span></span><br><span class="line"><span class="comment">//	      "hl.fl": "product_name",</span></span><br><span class="line">		solrQuery.setHighlight(<span class="keyword">true</span>);</span><br><span class="line">		solrQuery.setHighlightSimplePre(<span class="string">"&lt;span color='red'&gt;"</span>);</span><br><span class="line">		solrQuery.setHighlightSimplePost(<span class="string">"&lt;/span&gt;"</span>);</span><br><span class="line">		solrQuery.addHighlightField(<span class="string">"product_name"</span>);</span><br><span class="line">		<span class="comment">//设置排序</span></span><br><span class="line"><span class="comment">//	      "sort": "product_price asc",</span></span><br><span class="line">		solrQuery.setSort(<span class="string">"product_price"</span>, ORDER.asc);</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		执行查询</span></span><br><span class="line">		QueryResponse queryResponse = solrServer.query(solrQuery);</span><br><span class="line">		SolrDocumentList results = queryResponse.getResults();</span><br><span class="line">		System.out.println(<span class="string">"总条数:"</span>+results.getNumFound());</span><br><span class="line">		<span class="keyword">for</span> (SolrDocument solrDocument : results) &#123;</span><br><span class="line">			System.out.println(solrDocument.get(<span class="string">"id"</span>));</span><br><span class="line">			System.out.println(solrDocument.get(<span class="string">"product_name"</span>));</span><br><span class="line">			System.out.println(solrDocument.get(<span class="string">"product_catalog_name"</span>));</span><br><span class="line">			System.out.println(solrDocument.get(<span class="string">"product_price"</span>));</span><br><span class="line">			System.out.println(solrDocument.get(<span class="string">"product_description"</span>));</span><br><span class="line">			System.out.println(solrDocument.get(<span class="string">"product_picture"</span>));</span><br><span class="line">			System.out.println(<span class="string">"----------------------------------------------------"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="实现京东的案例"><a href="#实现京东的案例" class="headerlink" title="实现京东的案例"></a>实现京东的案例</h2><p>页面传到后台的</p>
<ol>
<li>当前页面，默认为0</li>
<li>每页显示条数 默认是60</li>
<li>主查询条件</li>
<li>过滤条件 商品类别和商品价格区间</li>
<li>价格排序 升序 降序</li>
</ol>
<p>后台提供页面的数据：</p>
<ol>
<li>商品列表 List</li>
<li>商品总条数</li>
<li>总页数</li>
<li>当前页码</li>
<li>每页显示的条数 </li>
</ol>
<p>（PageBean.java）</p>
<h2 id="搭建jd案例框架"><a href="#搭建jd案例框架" class="headerlink" title="搭建jd案例框架"></a>搭建jd案例框架</h2><p>分析</p>
<p>dao层</p>
<ol>
<li>SolrJ实现</li>
<li>application-dao.xml（省略，全部交给SpringMVC容器）</li>
<li>HttpSolrServer交给容器</li>
</ol>
<p>service层</p>
<ol>
<li>扫描器</li>
<li>applicationContext-service.xml（省略，全部交给SpringMVC容器）</li>
</ol>
<p>web层</p>
<ol>
<li>springmvc.xml</li>
<li>扫描器 （com.gdaib）</li>
<li>注解驱动</li>
<li>视图解析器</li>
</ol>
<p>步骤:</p>
<ol>
<li>创建一个web工程</li>
<li>导入jar:solrJ扩展包、solr扩展包、springmvc、spring</li>
<li>配置文件:springmvc.xml、log4j.properties</li>
<li>在web.xml配置前端控制器</li>
<li>引入静态资源</li>
</ol>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><ol>
<li>web.xml</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span> <span class="attr">version</span>=<span class="string">"3.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>solr-jd<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- SpringMVC前端控制器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.action<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- post中文乱码的解决问题 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>springmvc.xml</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">       <span class="comment">&lt;!--  SolrServer solrServer=new HttpSolrServer("http://localhost:8080/solr/collection1"); --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"solrServer"</span> <span class="attr">class</span>=<span class="string">"org.apache.solr.client.solrj.impl.HttpSolrServer"</span>&gt;</span></span><br><span class="line">       		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">value</span>=<span class="string">"http://localhost:8080/solr/collection1"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 扫描注解 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib.jd"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 注解确定， 注册HandlerMapping和HandlerAdapter--&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 视图解析器 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"viewResource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">      		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>pojo类</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.jd.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageBean</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> List&lt;Product&gt; productList;<span class="comment">//商品列表</span></span><br><span class="line">	<span class="keyword">private</span> Long recordCount;<span class="comment">//商品总数</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> pageCount;<span class="comment">//总页数</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> curPage;<span class="comment">//当前页</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProductList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> productList;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProductList</span><span class="params">(List&lt;Product&gt; productList)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.productList = productList;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Long <span class="title">getRecordCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> recordCount;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRecordCount</span><span class="params">(Long recordCount)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.recordCount = recordCount;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPageCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> pageCount;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPageCount</span><span class="params">(<span class="keyword">int</span> pageCount)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.pageCount = pageCount;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCurPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> curPage;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCurPage</span><span class="params">(<span class="keyword">int</span> curPage)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.curPage = curPage;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"PageBean [productList="</span> + productList + <span class="string">", recordCount="</span> + recordCount + <span class="string">", pageCount="</span> + pageCount</span><br><span class="line">				+ <span class="string">", curPage="</span> + curPage + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.jd.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 商品编号</span></span><br><span class="line">		<span class="keyword">private</span> String pid;</span><br><span class="line">		<span class="comment">// 商品名称</span></span><br><span class="line">		<span class="keyword">private</span> String name;</span><br><span class="line">		<span class="comment">// 商品分类名称</span></span><br><span class="line">		<span class="keyword">private</span> String catalog_name;</span><br><span class="line">		<span class="comment">// 价格</span></span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">float</span> price;</span><br><span class="line">		<span class="comment">// 商品描述</span></span><br><span class="line">		<span class="keyword">private</span> String description;</span><br><span class="line">		<span class="comment">// 图片名称</span></span><br><span class="line">		<span class="keyword">private</span> String picture;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> String <span class="title">getPid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> pid;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPid</span><span class="params">(String pid)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.pid = pid;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> name;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.name = name;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> String <span class="title">getCatalog_name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> catalog_name;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCatalog_name</span><span class="params">(String catalog_name)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.catalog_name = catalog_name;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> price;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.price = price;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> description;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDescription</span><span class="params">(String description)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.description = description;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> String <span class="title">getPicture</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> picture;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPicture</span><span class="params">(String picture)</span> </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.picture = picture;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">"Product [pid="</span> + pid + <span class="string">", name="</span> + name + <span class="string">", catalog_name="</span> + catalog_name + <span class="string">", price="</span> + price</span><br><span class="line">					+ <span class="string">", description="</span> + description + <span class="string">", picture="</span> + picture + <span class="string">"]"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>dao层</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.jd.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrQuery;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.jd.pojo.PageBean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ProductDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function">PageBean <span class="title">queryProduct</span><span class="params">(SolrQuery solrQuery)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.gdaib.jd.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrQuery;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrServer;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrServerException;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrQuery.ORDER;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.impl.HttpSolrServer;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.response.QueryResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.SolrDocument;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.common.SolrDocumentList;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.jd.dao.ProductDao;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.jd.pojo.PageBean;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.jd.pojo.Product;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductDaoImpl</span> <span class="keyword">implements</span> <span class="title">ProductDao</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> SolrServer solrServer;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> PageBean <span class="title">queryProduct</span><span class="params">(SolrQuery solrQuery)</span> </span>&#123;</span><br><span class="line">		PageBean pageBean=<span class="keyword">new</span> PageBean();</span><br><span class="line"><span class="comment">//		执行查询</span></span><br><span class="line">		QueryResponse queryResponse=<span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			queryResponse = solrServer.query(solrQuery);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SolrServerException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//高亮设置</span></span><br><span class="line">		Map&lt;String, Map&lt;String, List&lt;String&gt;&gt;&gt; highlighting = queryResponse.getHighlighting();</span><br><span class="line">		</span><br><span class="line">		SolrDocumentList results = queryResponse.getResults();</span><br><span class="line">		</span><br><span class="line">		pageBean.setRecordCount(results.getNumFound());</span><br><span class="line">		</span><br><span class="line">		List&lt;Product&gt; list=<span class="keyword">new</span> ArrayList&lt;Product&gt;();</span><br><span class="line">		<span class="keyword">for</span> (SolrDocument solrDocument : results) &#123;</span><br><span class="line">			Product product=<span class="keyword">new</span> Product();</span><br><span class="line">			product.setPid((String) solrDocument.get(<span class="string">"id"</span>));</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//添加高亮</span></span><br><span class="line">			Map&lt;String, List&lt;String&gt;&gt; map = highlighting.get((String) solrDocument.get(<span class="string">"id"</span>));</span><br><span class="line">			List&lt;String&gt; list2 = map.get(<span class="string">"product_name"</span>);</span><br><span class="line">			String product_name=<span class="string">""</span>;</span><br><span class="line">			<span class="keyword">if</span>(list2!=<span class="keyword">null</span> &amp;&amp; list2.size()&gt;<span class="number">0</span>) &#123;</span><br><span class="line">				product_name=list2.get(<span class="number">0</span>);</span><br><span class="line">			&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">				product_name=(String) solrDocument.get(<span class="string">"product_name"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			product.setName(product_name);</span><br><span class="line">			product.setDescription(<span class="keyword">null</span>);</span><br><span class="line">			product.setPrice((<span class="keyword">float</span>) solrDocument.get(<span class="string">"product_price"</span>));</span><br><span class="line">			product.setCatalog_name((String) solrDocument.get(<span class="string">"product_catalog_name"</span>));</span><br><span class="line">			product.setPicture((String) solrDocument.get(<span class="string">"product_picture"</span>));</span><br><span class="line">			list.add(product);</span><br><span class="line">		&#125;</span><br><span class="line">		pageBean.setProductList(list);</span><br><span class="line">		<span class="keyword">return</span> pageBean;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>service层</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.jd.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.jd.pojo.PageBean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ProductService</span> </span>&#123;</span><br><span class="line">	<span class="comment">//搜索引擎</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> PageBean <span class="title">queryProduct</span><span class="params">(<span class="keyword">int</span> page,String queryString,String catalog_name,String price,String sort)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.gdaib.jd.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrQuery;</span><br><span class="line"><span class="keyword">import</span> org.apache.solr.client.solrj.SolrQuery.ORDER;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.jd.dao.ProductDao;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.jd.pojo.PageBean;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.jd.service.ProductService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductServiceImpl</span> <span class="keyword">implements</span> <span class="title">ProductService</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> rows=<span class="number">60</span>;<span class="comment">//每页显示的条数</span></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> ProductDao productDao;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> PageBean <span class="title">queryProduct</span><span class="params">(<span class="keyword">int</span> page,String queryString,String catalog_name,String price,String sort)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		SolrQuery solrQuery=<span class="keyword">new</span> SolrQuery();</span><br><span class="line">		<span class="comment">//设置主查询条件</span></span><br><span class="line"><span class="comment">//	      "q": "花儿朵朵",</span></span><br><span class="line">		<span class="keyword">if</span>(queryString!=<span class="keyword">null</span>&amp;&amp;!queryString.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">			<span class="comment">//System.out.println("1");</span></span><br><span class="line">			solrQuery.setQuery(queryString);</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">//System.out.println("2");</span></span><br><span class="line">			solrQuery.setQuery(<span class="string">"*:*"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//设置过滤查询</span></span><br><span class="line"><span class="comment">//		  "fq":"过滤"</span></span><br><span class="line">		<span class="comment">//商品分类名称过滤</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> != catalog_name &amp;&amp; !<span class="string">""</span>.equals(catalog_name)) &#123;</span><br><span class="line">			solrQuery.addFilterQuery(<span class="string">"product_catalog_name:"</span> + catalog_name);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//价格区间过滤</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> != price &amp;&amp; !<span class="string">""</span>.equals(price)) &#123;</span><br><span class="line">			String[] strings = price.split(<span class="string">"-"</span>);</span><br><span class="line">			solrQuery.addFilterQuery(<span class="string">"product_price:["</span>+strings[<span class="number">0</span>]+<span class="string">" TO "</span>+strings[<span class="number">1</span>]+<span class="string">"]"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//设置分页查询</span></span><br><span class="line"><span class="comment">//		  "start":"0",</span></span><br><span class="line"><span class="comment">//	      "rows":"10"</span></span><br><span class="line">		solrQuery.setStart(page);</span><br><span class="line">		solrQuery.setRows(rows);</span><br><span class="line">		<span class="comment">//设置默认查询条件</span></span><br><span class="line"><span class="comment">//	      "df": "product_keywords",</span></span><br><span class="line">		solrQuery.set(<span class="string">"df"</span>,<span class="string">"product_keywords"</span>);</span><br><span class="line">		<span class="comment">//开启高亮</span></span><br><span class="line"><span class="comment">//	      "hl": "true",</span></span><br><span class="line"><span class="comment">//		  "hl.simple.pre": "&lt;span color='red'&gt;",</span></span><br><span class="line"><span class="comment">//	      "hl.simple.post": "&lt;/span&gt;",</span></span><br><span class="line"><span class="comment">//	      "hl.fl": "product_name",</span></span><br><span class="line">		solrQuery.setHighlight(<span class="keyword">true</span>);</span><br><span class="line">		solrQuery.setHighlightSimplePre(<span class="string">"&lt;span style=\"color:red\"&gt;"</span>);</span><br><span class="line">		solrQuery.setHighlightSimplePost(<span class="string">"&lt;/span&gt;"</span>);</span><br><span class="line">		solrQuery.addHighlightField(<span class="string">"product_name"</span>);</span><br><span class="line">		<span class="comment">//设置排序</span></span><br><span class="line"><span class="comment">//	      "sort": "product_price asc",</span></span><br><span class="line">		<span class="keyword">if</span>(sort.equals(<span class="string">"1"</span>)) &#123;</span><br><span class="line">			solrQuery.setSort(<span class="string">"product_price"</span>, ORDER.asc);<span class="comment">//设置升序</span></span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			solrQuery.setSort(<span class="string">"product_price"</span>, ORDER.desc);<span class="comment">//设置降序</span></span><br><span class="line">		&#125;</span><br><span class="line">		PageBean pageBean = productDao.queryProduct(solrQuery);</span><br><span class="line">		pageBean.setCurPage(page);</span><br><span class="line">		Long pageCount=pageBean.getRecordCount()/rows;<span class="comment">//计算总页数 总页数=总数/每页显示条数</span></span><br><span class="line">		<span class="keyword">if</span>(pageBean.getRecordCount()%rows&gt;<span class="number">0</span>) &#123; <span class="comment">//判断是否有余数 如果有余数 则总页数+1</span></span><br><span class="line">			pageCount++;</span><br><span class="line">		&#125;</span><br><span class="line">		pageBean.setPageCount(pageCount.intValue());</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> pageBean;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>controller层</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gdaib.jd.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.CrossOrigin;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gdaib.jd.pojo.PageBean;</span><br><span class="line"><span class="keyword">import</span> com.gdaib.jd.service.ProductService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> ProductService productService;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/list"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(Model model,@RequestParam(defaultValue = <span class="string">"1"</span>)</span><span class="keyword">int</span> page,String queryString,String catalog_name,String price,@<span class="title">RequestParam</span><span class="params">(defaultValue = <span class="string">"1"</span>)</span>String sort) </span>&#123;	</span><br><span class="line"></span><br><span class="line">		PageBean pageBean = productService.queryProduct(page, queryString, catalog_name, price, sort);</span><br><span class="line">		<span class="comment">//System.out.println(pageBean);</span></span><br><span class="line">		model.addAttribute(<span class="string">"result"</span>, pageBean);</span><br><span class="line">		System.out.println(pageBean);</span><br><span class="line">		<span class="comment">//数据回显</span></span><br><span class="line">		model.addAttribute(<span class="string">"queryString"</span>, queryString);</span><br><span class="line">		model.addAttribute(<span class="string">"price"</span>, price);</span><br><span class="line">		model.addAttribute(<span class="string">"catalog_name"</span>, catalog_name);</span><br><span class="line">		model.addAttribute(<span class="string">"sort"</span>, sort);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"product_list"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value=<span class="string">"/list2"</span>,method = &#123; RequestMethod.POST &#125;)</span><br><span class="line">	<span class="meta">@ResponseBody</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> PageBean <span class="title">list2</span><span class="params">(@RequestParam(defaultValue = <span class="string">"1"</span>)</span><span class="keyword">int</span> page,String queryString,String catalog_name,String price,@<span class="title">RequestParam</span><span class="params">(defaultValue = <span class="string">"1"</span>)</span>String sort) </span>&#123;	</span><br><span class="line"></span><br><span class="line">		PageBean pageBean = productService.queryProduct(page, queryString, catalog_name, price, sort);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> pageBean;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/29/搜索引擎框架介绍/">搜索引擎框架介绍</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-29T09:04:19.000Z" itemprop="datePublished">2019-11-29</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/搜索引擎框架介绍/">搜索引擎框架介绍</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="9个基于Java的搜索引擎框架"><a href="#9个基于Java的搜索引擎框架" class="headerlink" title="9个基于Java的搜索引擎框架"></a>9个基于Java的搜索引擎框架</h2><ul>
<li>转自：<code>https://blog.csdn.net/y19910825/article/details/78982429</code></li>
</ul>
<hr>
<h3 id="Java全文搜索引擎框架-Lucene"><a href="#Java全文搜索引擎框架-Lucene" class="headerlink" title="Java全文搜索引擎框架 Lucene"></a>Java全文搜索引擎框架 <code>Lucene</code></h3><ul>
<li>毫无疑问，Lucene是目前最受欢迎的Java全文搜索框架，准确地说，它是一个全文检索引擎的架构，提供了完整的查询引擎和索引引擎，部分文本分析引擎。Lucene为开发人员提供了相当完整的工具包，可以非常方便地实现强大的全文检索功能。下面有几款搜索引擎框架也是基于Lucene实现的。</li>
<li><code>官方网站：http://lucene.apache.org/</code><h3 id="开源Java搜索引擎Nutch"><a href="#开源Java搜索引擎Nutch" class="headerlink" title="开源Java搜索引擎Nutch"></a>开源Java搜索引擎<code>Nutch</code></h3></li>
<li>Nutch 是一个开源Java实现的搜索引擎。它提供了我们运行自己的搜索引擎所需的全部工具。包括全文搜索和Web爬虫。</li>
<li>利用Nutch，你可以做到以下这些功能：<ul>
<li>每为这些网页维护一个索引</li>
<li>个月取几十亿网页</li>
<li>对索引文件进行每秒上千次的搜索</li>
<li>提供高质量的搜索结果</li>
<li>最小的成本运作</li>
</ul>
</li>
<li><code>官方网站：http://nutch.apache.org/</code><h3 id="分布式搜索引擎Elasticsearch"><a href="#分布式搜索引擎Elasticsearch" class="headerlink" title="分布式搜索引擎Elasticsearch"></a>分布式搜索引擎<code>Elasticsearch</code></h3></li>
<li>ElasticSearch就是一款基于Lucene框架的分布式搜索引擎，并且也是一款为数不多的基于JSON进行索引的搜索引擎。ElasticSearch特别适合在云计算平台上使用。</li>
<li>官方网站：<a href="http://www.elasticsearch.org/" target="_blank" rel="noopener">http://www.elasticsearch.org/</a><h3 id="实时分布式搜索引擎Solandra"><a href="#实时分布式搜索引擎Solandra" class="headerlink" title="实时分布式搜索引擎Solandra"></a>实时分布式搜索引擎<code>Solandra</code></h3></li>
<li>Solandra 是一个实时的分布式搜索引擎，基于 Apache Solr 和 Apache Cassandra 构建。</li>
<li>其特性如下：<ul>
<li>支持Solr的大多数默认特性 (search, faceting, highlights)</li>
<li>数据复制，分片，缓存及压缩这些都由Cassandra来进行 </li>
<li>Multi-master (任意结点都可供读写)</li>
<li>实时性高，写操作完成即可读到</li>
<li>Easily add new SolrCores w/o restart across the cluster 轻松添加及重启结点</li>
</ul>
</li>
<li><code>官方网站：https://github.com/tjake/Solandra</code><h3 id="IndexTank"><a href="#IndexTank" class="headerlink" title="IndexTank"></a>IndexTank</h3></li>
<li>IndexTank是一套基于Java的索引-实时全文搜索引擎实现，IndexTank有以下几个特点：<ul>
<li>索引更新实时生效</li>
<li>地理位置搜索</li>
<li>支持多种客户端语言,<code>Ruby, Rails, Python, Java, PHP, .NET &amp; more!</code></li>
<li>支持灵活的排序与评分控制</li>
<li>支持自动完成</li>
<li>支持面搜索（facet search）</li>
<li>支持匹配高亮</li>
<li>支持海量数据扩展（Scalable from a personal blog to hundreds of millions of documents! ）</li>
<li>支持动态数据</li>
</ul>
</li>
<li><code>官方网站：https://github.com/linkedin/indextank-engine</code><h3 id="搜索引擎Compass"><a href="#搜索引擎Compass" class="headerlink" title="搜索引擎Compass"></a>搜索引擎Compass</h3></li>
<li>Compass是一个强大的,事务的,高性能的对象/搜索引擎映射(OSEM:object/search engine mapping)与一个Java持久层框架.Compass包括:<ul>
<li>搜索引擎抽象层(使用Lucene搜索引荐)</li>
<li>OSEM (Object/Search Engine Mapping) 支持</li>
<li>事务管理</li>
<li>类似于Google的简单关键字查询语言</li>
<li>可扩展与模块化的框架</li>
<li>简单的API</li>
</ul>
</li>
<li><code>官方网站：http://www.compass-project.org/</code><h3 id="Java全文搜索服务器solr"><a href="#Java全文搜索服务器solr" class="headerlink" title="Java全文搜索服务器solr"></a>Java全文搜索服务器<code>solr</code></h3></li>
<li>Solr也是基于Java实现的，并且是基于Lucene实现的，Solr的主要特性包括：高效、灵活的缓存功能，垂直搜索功能，高亮显示搜索结果。值得注意的是，Solr还提供一款很棒的Web界面来管理索引的数据。</li>
<li><code>官方网站：http://lucene.apache.org/solr/</code><h3 id="Lucene图片搜索-LIRE"><a href="#Lucene图片搜索-LIRE" class="headerlink" title="Lucene图片搜索 LIRE"></a>Lucene图片搜索 LIRE</h3></li>
<li>LIRE是一款基于Java的图片搜索框架，其核心也是基于Lucene的，利用该索引就能够构建一个基于内容的图像检索(content- based image retrieval，CBIR)系统，来搜索相似的图像。图片搜索LIRE</li>
<li><code>官方网站：http://www.semanticmetadata.net/lire/</code><h3 id="全文本搜索引擎Egothor"><a href="#全文本搜索引擎Egothor" class="headerlink" title="全文本搜索引擎Egothor"></a>全文本搜索引擎Egothor</h3></li>
<li>Egothor是一个用Java编写的开源而高效的全文本搜索引擎。借助Java的跨平台特性，Egothor能应用于任何环境的应用，既可配置为单独的搜索引擎，又能用于你的应用作为全文检索之用。</li>
<li><code>官方网站：http://www.egothor.org/cms/</code></li>
</ul>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/27/nginx/">nginx</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-27T02:46:39.000Z" itemprop="datePublished">2019-11-27</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/nginx/">nginx</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="什么是nginx"><a href="#什么是nginx" class="headerlink" title="什么是nginx"></a>什么是<code>nginx</code></h2><ul>
<li>是一个使用c语言开发的高性能的http服务器及反向代理服务器。</li>
<li>Nginx是一款高性能的http 服务器/反向代理服务器及电子邮件（IMAP/POP3）代理服务器。由俄罗斯的程序设计师Igor Sysoev所开发，官方测试nginx能够支支撑5万并发链接，并且cpu、内存等资源消耗却非常低，运行非常稳定。</li>
</ul>
<hr>
<h2 id="Nginx的应用场景"><a href="#Nginx的应用场景" class="headerlink" title="Nginx的应用场景"></a><code>Nginx</code>的应用场景</h2><ul>
<li>http服务器。Nginx是一个http服务可以独立提供http服务。可以做网页静态服务器。</li>
<li>虚拟主机。可以实现在一台服务器虚拟出多个网站。例如个人网站使用的虚拟主机。</li>
<li>反向代理，负载均衡。当网站的访问量达到一定程度后，单台服务器不能满足用户的请求时，需要用多台服务器集群可以使用nginx做反向代理。并且多台服务器可以平均分担负载，不会因为某台服务器负载高宕机而某台服务器闲置的情况。</li>
</ul>
<hr>
<h2 id="Nginx的安装"><a href="#Nginx的安装" class="headerlink" title="Nginx的安装"></a><code>Nginx</code>的安装</h2><ul>
<li><code>Nginx</code>一般推荐安装到linux系统，而且要安装c语言的编译环境gcc。</li>
<li>下载地址:<blockquote>
<ul>
<li>进入<code>http://nginx.org/en/download.html</code>下载<code>nginx1.8.0</code>版本（当前最新稳定版本）。</li>
</ul>
</blockquote>
</li>
<li>安装步骤：<blockquote>
<ul>
<li>先安装nginx依赖的包：<blockquote>
<ul>
<li>nginx是C语言开发，建议在linux上运行，本教程使用Centos6.5作为安装环境。</li>
<li>第一步：<code>gcc</code>：安装nginx需要先将官网下载的源码进行编译，编译依赖gcc环境，如果没有gcc环境，需要安装gcc：<code>yum install gcc-c++</code>；</li>
<li>第二步：<code>PCRE</code>：PCRE(Perl Compatible Regular Expressions)是一个Perl库，包括 perl 兼容的正则表达式库。nginx的http模块使用pcre来解析正则表达式，所以需要在linux上安装pcre库。<code>yum install -y pcre pcre-devel</code>；注：pcre-devel是使用pcre开发的一个二次开发库。nginx也需要此库；</li>
<li>第三步：<code>Zlib</code>：zlib库提供了很多种压缩和解压缩的方式，nginx使用zlib对http包的内容进行gzip，所以需要在linux上安装zlib库。<code>yum install -y zlib zlib-devel</code>；</li>
<li>第四步：<code>openssl</code>;OpenSSL 是一个强大的安全套接字层密码库，囊括主要的密码算法、常用的密钥和证书封装管理功能及SSL协议，并提供丰富的应用程序供测试或其它目的使用;nginx不仅支持http协议，还支持https（即在ssl协议上传输http），所以需要在linux安装openssl库;<code>yum install -y openssl openssl-devel</code>;</li>
</ul>
</blockquote>
</li>
<li>安装完依赖包之后，nginx的安装步骤：<blockquote>
<ul>
<li>第一步：把nginx的源码上传到linux系统。可以通过<code>finalshell</code>工具，该工具的下载链接在最下方。</li>
<li>第二步：把压缩包解压缩。</li>
<li>第三步：进行configure。<br>./configure \</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>-prefix=/usr/local/nginx \</li>
<li>-pid-path=/var/run/nginx/nginx.pid \</li>
<li>-lock-path=/var/lock/nginx.lock \</li>
<li>-error-log-path=/var/log/nginx/error.log \</li>
<li>-http-log-path=/var/log/nginx/access.log \</li>
<li>-with-http_gzip_static_module \</li>
<li>-http-client-body-temp-path=/var/temp/nginx/client \</li>
<li>-http-proxy-temp-path=/var/temp/nginx/proxy \</li>
<li>-http-fastcgi-temp-path=/var/temp/nginx/fastcgi \</li>
<li>-http-uwsgi-temp-path=/var/temp/nginx/uwsgi \</li>
<li>-http-scgi-temp-path=/var/temp/nginx/scgi</li>
</ul>
<p>注意：上边将临时文件目录指定为/var/temp/nginx，需要在/var下创建temp及nginx目录</p>
<blockquote>
<blockquote>
<ul>
<li>第四步：make</li>
<li>第五步：make install</li>
</ul>
</blockquote>
</blockquote>
<hr>
<h2 id="Nginx的启动、停止"><a href="#Nginx的启动、停止" class="headerlink" title="Nginx的启动、停止"></a>Nginx的启动、停止</h2><ul>
<li>启动：进入nginx的sbin目录，<code>./nginx</code>就可以启动。</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/zQnIYqt4TShNEO2.png" alt="图片1.png"></p>
<ul>
<li>如果访问不到，首先查看防火墙是否关闭。</li>
<li>service iptables status</li>
<li>关闭nginx：<blockquote>
<ul>
<li>可以使用kill命令，但是不推荐使用。</li>
<li>推荐使用：./nginx -s stop</li>
</ul>
</blockquote>
</li>
<li>刷新配置：./nginx -s reload</li>
</ul>
<hr>
<h2 id="Nginx的配置"><a href="#Nginx的配置" class="headerlink" title="Nginx的配置"></a><code>Nginx</code>的配置</h2><ul>
<li>在<code>/usr/local/nginx/conf</code>目录下<code>nginx.conf</code>文件是<code>nginx</code>的配置文件。</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/Yz6u8eRSIdqE9Al.png" alt="图片2.png"></p>
<hr>
<h2 id="使用nginx配置虚拟机"><a href="#使用nginx配置虚拟机" class="headerlink" title="使用nginx配置虚拟机"></a>使用<code>nginx</code>配置虚拟机</h2><ul>
<li><p>在<code>nginx.conf</code>文件中添加一个<code>Service</code>节点，修改端口号就可以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen       81;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html81;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过域名区分虚拟机</p>
<blockquote>
<ul>
<li>域名介绍</li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/x13mWjrUBS9zi2e.png" alt="1574833893_1_.png"></p>
<blockquote>
<ul>
<li>可以通过修改host文件指定域名的ip地址。</li>
<li>Host文件的位置：<code>C:\Windows\System32\drivers\etc</code></li>
</ul>
</blockquote>
<ul>
<li>配置基于域名的虚拟主机<blockquote>
<ul>
<li>需要修改nginx.conf配置文件。</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  test3.taotao.com;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html-test3;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<ul>
<li>修改配置后需要重新加载配置文件。</li>
</ul>
</blockquote>
<hr>
<h2 id="Nginx的反向代理"><a href="#Nginx的反向代理" class="headerlink" title="Nginx的反向代理"></a><code>Nginx</code>的反向代理</h2><ul>
<li>什么是反向代理<blockquote>
<ul>
<li>正向代理</li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/mYjQ9oKtSybpBrA.png" alt="1574834242_1_.png"></p>
<blockquote>
<ul>
<li>反向代理</li>
</ul>
</blockquote>
<p><img src="https://i.loli.net/2019/11/27/GZNuLDlJ8yiRwaM.png" alt="1574834269_1_.png"></p>
<blockquote>
<ul>
<li>反向代理服务器是引用在服务端。决定哪台服务器提供服务。</li>
<li>反向代理的模拟</li>
<li>反向代理:应该有一个nginx服务器有多个应用服务器（可以是tomcat）、可以使用一台虚拟机，安装一个nginx，多个tomcat，来模拟。</li>
<li>Nginx的配置文件：</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">upstream tomcats&#123;</span><br><span class="line">	server 192.168.25.148:8080;</span><br><span class="line">	server 192.168.25.148:8081;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  tomcat.taotao.com;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass   http://tomcats;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="nginx负载均衡"><a href="#nginx负载均衡" class="headerlink" title="nginx负载均衡"></a><code>nginx</code>负载均衡</h2><ul>
<li>只需要在upstream的server后面添加一个weight即可代表权重。权重越高，分配请求的数量就越多。默认权重是1</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/MNfPipO8eo2USCh.png" alt="图片3.png"></p>
<h2 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h2><ul>
<li><code>finalshell</code>下载链接：<code>http://www.hostbuf.com/</code></li>
</ul>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/21/redis/">redis</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-21T07:52:33.000Z" itemprop="datePublished">2019-11-21</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/redis/">redis</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="Redis简介"><a href="#Redis简介" class="headerlink" title="Redis简介"></a>Redis简介</h2><ul>
<li>Redis是完全开源免费的，遵守<code>BSD</code>协议，是一个高性能的key-value数据库.</li>
<li>Redis是一个开源的使用C语言编写的、支持网络、可基于内存亦可持久化的日志型、key-value数据库，并提供多种语言的API。</li>
<li>redis的作者，叫Salvatore Sanfilippo，来自意大利的西西里岛，现在居住在卡塔尼亚。目前供职于Pivotal公司。他使用的网名是antirez。</li>
<li>NOSQL介绍：<ul>
<li>泛指非关系型数据库：数据与数据之间没有关联关系</li>
</ul>
</li>
<li>SQL：<ul>
<li>关系型数据库：表与表之间有关联关系。</li>
</ul>
</li>
<li>NoSQL数据库的四大分类<ul>
<li>键值存储数据库：主要会使用哈希表；一个key对应一个value值，例如redis，MongoDb</li>
<li>列存储数据库：HBase</li>
<li>文档型数据库:MongoDb</li>
<li>图形数据库：Neo4J</li>
</ul>
</li>
<li>总结NoSQL数据库在以下的这几种情况下比较适用：<ul>
<li>数据模型比较简单；</li>
<li>需要灵活性更强的IT系统；</li>
<li>对数据库性能要求比较高；</li>
<li>不需要高度的数据库一致性；</li>
<li>对于给定的key，比较容易映射复杂值的情况;</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Linux安装"><a href="#Linux安装" class="headerlink" title="Linux安装"></a>Linux安装</h2><ul>
<li>官方网站：<code>http://redis.io</code></li>
<li>安装步骤<ul>
<li>安装gcc：<code>yum -y install gcc automake autoconf libtool make</code>  </li>
<li>到官网上下载<code>redis</code></li>
<li>把下载好的<code>redis</code>上传到<code>Linux</code>上</li>
<li>解压压缩文件 <code>tar zxvf 压缩文件名</code></li>
<li>然后进入redis文件夹，进行编译:<code>make</code>或<code>make MALLOC=libc</code>，如下图代表成功<br><img src="https://i.loli.net/2019/11/22/HINlM3DmErvZkqf.png" alt="1574386791_1_.png"></li>
<li><code>make PREFIX=/usr/local/redis install</code>：（安装编译后的文件）安装到指定目录。<ul>
<li>注意: PREFIX必须大写，同时会自动为我们创建redis目录，并将结果安装到此目录。</li>
</ul>
</li>
<li>到此<code>redis</code>安装完成。</li>
</ul>
</li>
<li><code>Redis</code>启动<ul>
<li>启动<code>Redis</code>服务<ul>
<li>进入对应的安装目录：<code>/usr/local/redis</code></li>
<li>执行命令：<code>./bin/redis-server</code> </li>
</ul>
</li>
<li>启动<code>Redis</code>客户端<ul>
<li>进入对应的安装目录：<code>/usr/local/redis</code></li>
<li>执行命令：<code>./bin/redis-cli</code> </li>
</ul>
</li>
<li>启动<code>redis</code>客户端命令：<ul>
<li>redis-cli -h IP地址 -p 端口</li>
</ul>
</li>
<li>退出客户端命令:<ul>
<li>Ctrl+C</li>
</ul>
</li>
<li>测试是否服务端启动<ul>
<li>启动redis客户端，打开终端并输入命令redis-cli。该命令连接到本地的redis服务。</li>
<li>使用<code>PING</code>检测是否连接成功。</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Redis配置文件详解redis-conf"><a href="#Redis配置文件详解redis-conf" class="headerlink" title="Redis配置文件详解redis.conf"></a><code>Redis</code>配置文件详解<code>redis.conf</code></h2><ul>
<li><code>Redis</code>的配置文件位于<code>Redis</code>安装目录下，文件名为<code>redis.conf</code>(Windows名为redis.windows.conf)。</li>
<li>到redis-4.0.14目录下的<code>redis</code>复制到<code>/usr/local/redis</code>:<code>cp redis.conf /usr/local/redis</code></li>
<li>你可以通过<code>CONFIG</code>命令查看或设置配置项。</li>
<li>语法：<code>Redis CONFIG</code>命令语法格式如下：<ul>
<li><code>reids 127.0.0.1:6379&gt;CONFIG GET CONFIG_SETTING_NAME</code> </li>
</ul>
</li>
<li>redis配置文件详解<ul>
<li><code>daemonize no</code>：Redis 默认不是以守护进程的方式运行，可以通过该配置项修改，使用 yes 启用守护进程（Windows 不支持守护线程的配置为 no ）。</li>
<li><code>pidfile /var/run/redis.pid</code>：当 Redis 以守护进程方式运行时，Redis 默认会把 pid 写入 /var/run/redis.pid 文件，可以通过 pidfile 指定。</li>
<li><code>port 6379</code>：指定 Redis 监听端口，默认端口为 6379，作者在自己的一篇博文中解释了为什么选用 6379 作为默认端口，因为 6379 在手机按键上 MERZ 对应的号码，而 MERZ 取自意大利歌女 Alessia Merz 的名字。</li>
<li><code>bind</code>命令：绑定主机地址.<code>bind 127.0.0.1</code>。</li>
<li><code>timeout 300</code>：当客户端闲置多长时间后关闭连接，如果指定为 0，表示关闭该功能</li>
<li><code>loglevel notice</code>：指定日志记录级别，Redis 总共支持四个级别：debug、verbose、notice、warning，默认为 notice。</li>
<li><code>logfile stdout</code>：日志记录方式，默认为标准输出，如果配置 Redis 为守护进程方式运行，而这里又配置为日志记录方式为标准输出，则日志将会发送给 /dev/null。</li>
<li><code>databases 16</code>：设置数据库的数量，默认数据库为0，可以使用SELECT 命令在连接上指定数据库id。</li>
<li><code>save &lt;seconds&gt; &lt;changes&gt;</code>：指定在多长时间内，有多少次更新操作，就将数据同步到数据文件，可以多个条件配合。<ul>
<li><code>redis</code>默认配置文件中提供如下三个：</li>
<li><code>save 900 1</code></li>
<li><code>save 300 10</code></li>
<li><code>save 60 10000</code></li>
<li>分别表示 900 秒（15 分钟）内有 1 个更改，300 秒（5 分钟）内有 10 个更改以及 60 秒内有 10000 个更改。</li>
</ul>
</li>
<li><code>rdbcompression yes</code>:指定存储至本地数据库时是否压缩数据，默认为 yes，Redis 采用 LZF 压缩，如果为了节省 CPU 时间，可以关闭该选项，但会导致数据库文件变的巨大.</li>
<li><code>dbfilename dump.rdb</code>：指定本地数据库文件名，默认值为 dump.rdb。</li>
<li><code>dir ./</code>：指定本地数据库存放目录。</li>
<li><code>slaveof &lt;masterip&gt; &lt;masterport&gt;</code>：设置当本机为 slave 服务时，设置 master 服务的 IP 地址及端口，在 Redis 启动时，它会自动从 master 进行数据同步。</li>
<li><code>masterauth &lt;master-password&gt;</code>：当 master 服务设置了密码保护时，slave 服务连接 master 的密码。</li>
<li><code>requirepass foobared</code>：设置 Redis 连接密码，如果配置了连接密码，客户端在连接 Redis 时需要通过 <code>AUTH &lt;password&gt;</code> 命令提供密码，默认关闭。</li>
<li><code>maxclients 128</code>：设置同一时间最大客户端连接数，默认无限制，Redis 可以同时打开的客户端连接数为 Redis 进程可以打开的最大文件描述符数，如果设置 maxclients 0，表示不作限制。当客户端连接数到达限制时，Redis 会关闭新的连接并向客户端返回 max number of clients reached 错误信息。</li>
<li><code>maxmemory &lt;bytes&gt;</code>：指定 Redis 最大内存限制，Redis 在启动时会把数据加载到内存中，达到最大内存后，Redis 会先尝试清除已到期或即将到期的 Key，当此方法处理 后，仍然到达最大内存设置，将无法再进行写入操作，但仍然可以进行读取操作。Redis 新的 vm 机制，会把 Key 存放内存，Value 会存放在 swap 区。</li>
<li><code>appendonly no</code>：指定是否在每次更新操作后进行日志记录，Redis 在默认情况下是异步的把数据写入磁盘，如果不开启，可能会在断电时导致一段时间内的数据丢失。因为 redis 本身同步数据文件是按上面 save 条件来同步的，所以有的数据会在一段时间内只存在于内存中。默认为 no。</li>
<li><code>appendfilename appendonly.aof</code>：指定更新日志文件名，默认为 appendonly.aof。</li>
<li><code>appendfsync everysec</code>：指定更新日志条件，公有三个可选值。no：表示等操作系统进行数据缓存同步到磁盘（快）；always：表示每次更新操作后手动调用 fsync() 将数据写到磁盘（慢，安全）；表示每秒同步一次（折中，默认值）；</li>
<li><code>vm-enabled no</code>：指定是否启用虚拟内存机制，默认值为 no，简单的介绍一下，VM 机制将数据分页存放，由 Redis 将访问量较少的页即冷数据 swap 到磁盘上，访问多的页面由磁盘自动换出到内存中（在后面的文章我会仔细分析 Redis 的 VM 机制）。</li>
<li><code>vm-swap-file /tmp/redis.swap</code>：虚拟内存文件路径，默认值为 /tmp/redis.swap，不可多个 Redis 实例共享。</li>
<li><code>vm-max-memory 0</code>：将所有大于 vm-max-memory 的数据存入虚拟内存，无论 vm-max-memory 设置多小，所有索引数据都是内存存储的(Redis 的索引数据 就是 keys)，也就是说，当 vm-max-memory 设置为 0 的时候，其实是所有 value 都存在于磁盘。默认值为 0。</li>
<li><code>vm-page-size 32</code>：Redis swap 文件分成了很多的 page，一个对象可以保存在多个 page 上面，但一个 page 上不能被多个对象共享，vm-page-size 是要根据存储的 数据大小来设定的，作者建议如果存储很多小对象，page 大小最好设置为 32 或者 64bytes；如果存储很大大对象，则可以使用更大的 page，如果不确定，就使用默认值。</li>
<li><code>vm-pages 134217728</code>：设置 swap 文件中的 page 数量，由于页表（一种表示页面空闲或使用的 bitmap）是在放在内存中的，，在磁盘上每 8 个 pages 将消耗 1byte 的内存。</li>
<li><code>vm-max-threads 4</code>：设置访问swap文件的线程数,最好不要超过机器的核数,如果设置为0,那么所有对swap文件的操作都是串行的，可能会造成比较长时间的延迟。默认值为4。</li>
<li><code>glueoutputbuf yes</code>：设置在向客户端应答时，是否把较小的包合并为一个包发送，默认为开启。</li>
<li><code>hash-max-zipmap-entries 64、hash-max-zipmap-value 512</code>：指定在超过一定的数量或者最大的元素超过某一临界值时，采用一种特殊的哈希算法。</li>
<li><code>activerehashing yes</code>：指定是否激活重置哈希，默认为开启（后面在介绍 Redis 的哈希算法时具体介绍）</li>
<li><code>include /path/to/local.conf</code>：指定包含其它的配置文件，可以在同一主机上多个Redis实例之间使用同一份配置文件，而同时各个实例又拥有自己的特定配置文件。</li>
</ul>
</li>
<li><code>Redis</code>缺点：占用很大的内存空间，在<code>redis</code>中有两种解决方案<ul>
<li>一是为数据设置超时时间。</li>
<li>二是采用LRU算法动态将不同的数据删除。</li>
</ul>
</li>
<li>设定内存空间，建议内存不要超过1G 256-512M</li>
<li>自定义配置<code>redis</code><ul>
<li>进入对应的安装目录：<code>/usr/local/redis</code>，修改redis.conf配置文件：<code>vim redis.conf</code></li>
<li>Redis配置默认必须修改<ul>
<li>daemonize no 修改为 daemonize yes</li>
<li>bind 127.0.0.1 注释掉</li>
<li>requirepass 设置密码 </li>
</ul>
</li>
</ul>
</li>
<li>重新启动redis服务：<code>./bin/redis-server ./redis-conf</code></li>
<li>查看状态：<code>ps -ef | grep -i redis</code></li>
<li>重启启动redis客户端：注意此时是带有密码。</li>
<li>远程服务执上行命令：<code>redis-cli -h host -p port -a password</code>、<code>redis-cli -h IP地址 -p 端口 -a 密码</code>。 </li>
<li><code>key *</code>：查看所有的key值。</li>
<li><code>set key</code>：指定key-value值。</li>
<li><code>get key</code>：获取key对应的值。</li>
</ul>
<hr>
<h2 id="Redis关闭"><a href="#Redis关闭" class="headerlink" title="Redis关闭"></a><code>Redis</code>关闭</h2><ul>
<li>第一种方式：（断电、非正常关闭。容易丢失数据）<ul>
<li>查询PID：<code>ps -ef | grep -i redis</code>。</li>
<li><code>kill -9 PID</code>。</li>
</ul>
</li>
<li>第二种方式：（正常关闭，数据保存）<ul>
<li><code>./bin/redis-cli shutdown</code>：关闭redis服务，通过客户端进行<code>shutdown</code></li>
<li>如果redis设置了密码，需要现在客户端通过密码登录，再进行<code>shutdown</code>即可关闭服务端。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Redis基本命令"><a href="#Redis基本命令" class="headerlink" title="Redis基本命令"></a><code>Redis</code>基本命令</h2><ul>
<li><code>Redis</code>命令用于在<code>Redis</code>服务上执行操作。</li>
<li>要在<code>Redis</code>服务上执行命令需要一个<code>Redis</code>客户端。</li>
<li><code>Redis</code>客户端在我们之前下载的<code>Redis</code>的安装包中。</li>
<li>Redis 键(key)<ul>
<li><code>Redis</code>健命令的基本语法：<code>COMMAND KEY_NAME</code></li>
<li><code>DEL key</code>：该命令用于在key存在时删除key。</li>
<li><code>DUMP key</code>：序列化给定key，并返回被序列化的值。</li>
<li><code>EXISTS key</code>：判断指定的key是否存在。 </li>
<li><code>EXPIRE key seconds</code>：为给定key设置过期时间，以秒计。</li>
<li><code>TTL key</code>：以秒为单位返回key的剩余的过期时间。</li>
<li><code>PTTL key</code>：以秒为单位返回key的剩余的过期时间（毫秒）。</li>
<li><code>EXPIRE key second</code>：为给定的key设置过期时间（以秒计）。</li>
<li><code>PEXPIRE key miilsecond</code>：为给定的key设置过期时间（以毫秒计）。</li>
<li><code>presist key</code>：将key永久有效</li>
<li><code>key pattern</code>：查找所有的key。* , ?</li>
<li><code>rename key newkey</code>：修改指定key的名称</li>
<li><code>move key  db</code>：将指定key移到指定数据库。</li>
<li><code>key</code>：返回指定key所存储的数据类型</li>
<li>… 剩余的查看<code>https://www.runoob.com/redis/redis-keys.html</code></li>
</ul>
</li>
<li>应用场景<ul>
<li><code>expire key seconds</code>：</li>
<li>限时的优惠活动信息。</li>
<li>网站数据缓存（对于一些需要定时更新的数据，例如：积分排行版）</li>
<li>手机验证码</li>
<li>限时网站访客访问频率（例如：1分钟最多访问10次）</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Redis中key的命名规范"><a href="#Redis中key的命名规范" class="headerlink" title="Redis中key的命名规范"></a><code>Redis</code>中key的命名规范</h2><ul>
<li><code>key</code>的命名建议：<ul>
<li><code>Redis</code>单个<code>key</code>存入512M大小</li>
<li>key可以不要太长，尽量不要超过1024字节，这不仅消耗内存，而且会降低查找的效率。</li>
<li>key也不要太短，太短的话，key的可读性会降低</li>
<li>在一个项目中，key最好使用统一的命名模式，例如<code>user:123:password</code></li>
<li>key的名称区分大小写</li>
</ul>
</li>
</ul>
<hr>
<h2 id="String类型简介"><a href="#String类型简介" class="headerlink" title="String类型简介"></a>String类型简介</h2><ul>
<li><p>String是redis最基本的类型，一个key对应一个value.</p>
</li>
<li><p>String是二进制完全。意思是redis的string可以包含任何数据。比如jpg图片或者是序列化对象.</p>
</li>
<li><p>String类型是redis最基本的数据类型，一个键最大能存储512MB。</p>
</li>
<li><p>二进制安全是指，在传输数据时，保证二进制数据的信息完全，也就是不被篡改、破译等，如果被攻击，能给即时检测出来。</p>
</li>
<li><p>二进制完全特点</p>
<ul>
<li>编码、解码发生在客户端完成，执行效率高。</li>
<li>不需要频繁的编解码，不会出现乱码。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="String类型的常用指令"><a href="#String类型的常用指令" class="headerlink" title="String类型的常用指令"></a>String类型的常用指令</h2><ul>
<li>赋值语法：SAET KEY_Name VALUE。用于给指定的key设置值，如果在key已经存储值，SET就覆写旧值，且无视类型。</li>
<li>取值语法：GET KEY_NAME，如果key不存在，则返回nil。如果key存储的值不是字符串类型，返回一个错误。</li>
<li>SETNX key value：如果key不存在时设置key的值。</li>
<li>getrange key start end：返回 key 中字符串值的子字符</li>
<li>GETBIT key offset：对 key 所储存的字符串值，获取指定偏移量上的位(bit)。</li>
<li>GETSET  key value： 将给定 key 的值设为 value ，并返回 key 的旧值(old value)。</li>
<li>MGET key1 <code>[key2..]</code>：获取所有(一个或多个)给定 key 的值。</li>
<li>strlen key：返回key所存储的字符串值的长度。</li>
<li>删除语法：del key_name：删除指定的key，如果存在，返回值数字类型。</li>
<li>自增/自减 incr key_name、DECR Key_Name；incrby key_name 数字/decrby ley_name 数字：自增数字/自减数字</li>
<li>set key value：解决分布式锁方案之一</li>
<li>应用场景<ul>
<li>String通常用于保存当个字符串或json字符串数据。</li>
<li>因String是二进制安全，通常可以利用它存储图片。</li>
<li>计数器。</li>
<li>Incr是原子性操作。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="哈希-Hash"><a href="#哈希-Hash" class="headerlink" title="哈希(Hash)"></a>哈希(Hash)</h2><ul>
<li>简介： hash 是一个 string 类型的 field 和 value 的映射表，hash 特别适合用于存储对象。Redis 中每个 hash 可以存储 232 - 1 键值对（40多亿）。</li>
<li>常用命令   <ul>
<li><code>hset key field value</code>：将哈希表中的key中的字段field的值设为value。</li>
<li><code>hmset key field value</code>：将多个值同时存储。</li>
<li><code>hget key field</code>：获取存储在哈希表中指定字段的值。</li>
<li><code>hmget key field1,field2</code>：获取key所有给定字段的值。</li>
<li><code>hmgetall key</code>：返回Hash表所有的字段和值。</li>
<li><code>hkeys key</code>：获取所有哈希表中的字段。</li>
<li><code>hlen key</code>：获取哈希表字段的数量。</li>
<li>删除语法: <code>hdel key field[field]</code>：删除指定key中的指定一个或多个属性。</li>
<li><code>hincrby key field increment</code>：将key中的field增加increment。</li>
<li><code>hsetex key age</code>：当不存在时设置值。</li>
<li><code>hexists key field</code>：查看hash表中，指定字段是否存在。</li>
<li><code>HINCRBYFLOAT key field increment</code>：为哈希表 key 中的指定字段的浮点数值加上增increment 。</li>
<li><code>hkeys key</code>：获取所有哈希表中的字段。</li>
<li><code>hvals key</code>:获取哈希表中所有值。</li>
</ul>
</li>
<li>应用场景:(存储一个用户信息对象数据)<ul>
<li>常用于存储一个对象。</li>
<li>为什么不使用string存储一个对象。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Java连接Redis"><a href="#Java连接Redis" class="headerlink" title="Java连接Redis"></a>Java连接Redis</h2><ul>
<li><p>在官方网站列一些Java客户端访问，有：Jedis/Redisson/Jredis/JDBC-Redis等，其中官方推荐使用的是Jedis和Redisson。常用Jedis。</p>
</li>
<li><p>Jedis的使用步骤:</p>
<ul>
<li>在Java工程中导入jar包</li>
<li>使用<code>Jedis jedis=new Jedis(&quot;192.168.166.132&quot;, 6379);</code>与redis建立连接，第一个参数为ip地址，第二个参数为端口号。</li>
<li>使用<code>jedis.auth(&quot;123456&quot;);</code>输入连接密码进行连接。</li>
<li>进行相关操作。注意：jedis中的方法与redis中的指令基本相同。</li>
<li>关闭连接对象。</li>
</ul>
</li>
<li><p>注意：此处还要释放Linux对外开放的端口号：6379；</p>
<ul>
<li>修改防火墙：<code>vim /etc/syscofnig/iptables</code></li>
<li>修改完之后重启防火墙：<code>service iptables restart</code></li>
</ul>
</li>
<li><p>案例实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String host=<span class="string">"192.168.166.132"</span>;</span><br><span class="line">    <span class="keyword">int</span> port=<span class="number">6379</span>;</span><br><span class="line">    <span class="comment">//连接redis服务器</span></span><br><span class="line">    Jedis jedis=<span class="keyword">new</span> Jedis(host, port);</span><br><span class="line">    <span class="comment">//连接redis密码</span></span><br><span class="line">    jedis.auth(<span class="string">"123456"</span>);</span><br><span class="line">    System.out.println(jedis.ping());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">    * 测试字符串string</span></span><br><span class="line"><span class="comment">    * Redis中有哪些命令，jedis就有哪些方法</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//连接redis服务器</span></span><br><span class="line">    Jedis jedis=<span class="keyword">new</span> Jedis(<span class="string">"192.168.166.132"</span>, <span class="number">6379</span>);</span><br><span class="line">    <span class="comment">//连接redis密码</span></span><br><span class="line">    jedis.auth(<span class="string">"123456"</span>);</span><br><span class="line">    jedis.set(<span class="string">"strName"</span>, <span class="string">"字符串的名称"</span>);</span><br><span class="line">    String strName = jedis.get(<span class="string">"strName"</span>);</span><br><span class="line">    System.out.println(<span class="string">"redis中的数据："</span>+strName);</span><br><span class="line">    <span class="comment">//关闭redis</span></span><br><span class="line">    jedis.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">    * redis作用：为了减轻数据库（Mysql）的访问压力</span></span><br><span class="line"><span class="comment">    * 需求：判断某key是否存在，如果存在，就从Redis中查询，如果不存在就查询数据库，且将查询结果存入到redis;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//连接redis服务器</span></span><br><span class="line">    Jedis jedis=<span class="keyword">new</span> Jedis(<span class="string">"192.168.166.132"</span>, <span class="number">6379</span>);</span><br><span class="line">    <span class="comment">//连接redis密码</span></span><br><span class="line">    jedis.auth(<span class="string">"123456"</span>);</span><br><span class="line">    </span><br><span class="line">    String key=<span class="string">"applicationName"</span>;<span class="comment">//key的名称</span></span><br><span class="line">    <span class="keyword">if</span>(jedis.exists(key)) &#123;</span><br><span class="line">        <span class="comment">//存在，直接获取</span></span><br><span class="line">        String result = jedis.get(key);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">        </span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//在数据库中查询</span></span><br><span class="line">        String result=<span class="string">"微信开发会议达人"</span>;</span><br><span class="line">        jedis.set(key, result);</span><br><span class="line">        System.out.println(<span class="string">"Mysql数据库中查询得到："</span>+result);</span><br><span class="line">    &#125;</span><br><span class="line">    jedis.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Jedis工具类"><a href="#Jedis工具类" class="headerlink" title="Jedis工具类"></a><code>Jedis</code>工具类</h2><ul>
<li><p><code>Jedis</code>连接池优化操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Jedis连接池</span></span><br><span class="line">    <span class="comment">//1.连接池Redis POOL 基本配置信息</span></span><br><span class="line">    JedisPoolConfig poolConfig=<span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">    poolConfig.setMaxTotal(<span class="number">5</span>);<span class="comment">//设置最大连接数</span></span><br><span class="line">    poolConfig.setMaxIdle(<span class="number">1</span>);<span class="comment">//设置最大空闲数</span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="comment">//2. 连接池</span></span><br><span class="line">    JedisPool pool=<span class="keyword">new</span> JedisPool(poolConfig, <span class="string">"192.168.166.132"</span>,<span class="number">6379</span>);</span><br><span class="line">    Jedis jedis=pool.getResource();</span><br><span class="line">    jedis.auth(<span class="string">"123456"</span>);</span><br><span class="line">    System.out.println(jedis.ping());</span><br><span class="line">    jedis.close();</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Jedis</code>工具类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * 获取redis连接工具类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 1huangzewei</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisPoolUtil</span> </span>&#123;</span><br><span class="line">	<span class="comment">//Jedis连接池对象</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> JedisPool pool;</span><br><span class="line">	<span class="comment">//连接redis的IP地址</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String host=<span class="string">"192.168.166.132"</span>;</span><br><span class="line">	<span class="comment">//连接redis的IP地址的所在端口</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> port=<span class="number">6379</span>;</span><br><span class="line">	<span class="comment">//连接redis服务端的密码</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> String pwd=<span class="string">"123456"</span>;</span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		<span class="comment">//Jedis连接池</span></span><br><span class="line">		<span class="comment">//1.连接池Redis POOL 基本配置信息</span></span><br><span class="line">		JedisPoolConfig poolConfig=<span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">		poolConfig.setMaxTotal(<span class="number">5</span>);<span class="comment">//设置最大连接数</span></span><br><span class="line">		poolConfig.setMaxIdle(<span class="number">1</span>);<span class="comment">//设置最大空闲数</span></span><br><span class="line">		<span class="comment">//...其他配置</span></span><br><span class="line">		<span class="comment">//2. 连接池</span></span><br><span class="line">		pool=<span class="keyword">new</span> JedisPool(poolConfig, host,port);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 获取连接对象</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> Jedis</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Jedis <span class="title">getJedis</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Jedis jedis = pool.getResource();</span><br><span class="line">		jedis.auth(pwd);</span><br><span class="line">		<span class="keyword">return</span> jedis;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 释放资源</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> jedis</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(Jedis jedis)</span> </span>&#123;</span><br><span class="line">		jedis.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<hr>
<h2 id="Jedis-hash类型读取"><a href="#Jedis-hash类型读取" class="headerlink" title="Jedis-hash类型读取"></a><code>Jedis-hash</code>类型读取</h2><ul>
<li><p>案例一</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">    * Jedis完成对hash类型操作</span></span><br><span class="line"><span class="comment">    * 需求：hash存储一个对象</span></span><br><span class="line"><span class="comment">    * 判断redis中是否存在该key，如果存在，直接返回，如果不存在，数据库查询，并将结果存储在redis</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Jedis jedis=RedisPoolUtil.getJedis();</span><br><span class="line">    String key=<span class="string">"users"</span>;</span><br><span class="line">    <span class="keyword">if</span>(jedis.exists(key)) &#123;</span><br><span class="line">        Map&lt;String, String&gt; map = jedis.hgetAll(key);</span><br><span class="line">        System.out.println(<span class="string">"从redis中查询的数据"</span>);</span><br><span class="line">        System.out.println(map.get(<span class="string">"id"</span>)+<span class="string">"\t"</span>+map.get(<span class="string">"name"</span>));</span><br><span class="line">        System.out.println(map.get(<span class="string">"age"</span>)+<span class="string">"\t"</span>+map.get(<span class="string">"remark"</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"从数据库中查询结果并且赋值到redis"</span>);</span><br><span class="line">        <span class="comment">//查询数据库并返回结果</span></span><br><span class="line">        jedis.hset(key,<span class="string">"id"</span>,<span class="string">"1"</span>);</span><br><span class="line">        jedis.hset(key,<span class="string">"name"</span>,<span class="string">"迪丽热巴"</span>);</span><br><span class="line">        jedis.hset(key, <span class="string">"age"</span>,<span class="string">"27"</span>);</span><br><span class="line">        jedis.hset(key, <span class="string">"remark"</span>,<span class="string">"这是一位女明星"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    RedisPoolUtil.close(jedis);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>案例二：对案例一进行优化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">    * 对上面方法进行优化</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t5</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Users selectById(String id);</span></span><br><span class="line">    Jedis jedis=RedisPoolUtil.getJedis();</span><br><span class="line">    <span class="keyword">int</span> id=<span class="number">1</span>;</span><br><span class="line">    String key=User.getKeyName()+id;<span class="comment">//user:1</span></span><br><span class="line">    <span class="keyword">if</span>(jedis.exists(key)) &#123;</span><br><span class="line">        <span class="comment">//从redis中取出对象</span></span><br><span class="line">        Map&lt;String, String&gt; hash = jedis.hgetAll(key);</span><br><span class="line">        User u=<span class="keyword">new</span> User(Integer.parseInt(hash.get(<span class="string">"id"</span>)),hash.get(<span class="string">"name"</span>),Integer.parseInt(hash.get(<span class="string">"age"</span>)),hash.get(<span class="string">"remark"</span>));</span><br><span class="line">        System.out.println(<span class="string">"redis中查询的结果："</span>+u);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//查询数据库并返回结果</span></span><br><span class="line">        User u=<span class="keyword">new</span> User(id,<span class="string">"迪丽热巴"</span>,<span class="number">27</span>,<span class="string">"这是一位女明星"</span>);</span><br><span class="line">        Map&lt;String,String&gt; map=<span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">        map.put(<span class="string">"id"</span>, id+<span class="string">""</span>);</span><br><span class="line">        map.put(<span class="string">"name"</span>,u.getName());</span><br><span class="line">        map.put(<span class="string">"age"</span>,u.getAge()+<span class="string">""</span>);</span><br><span class="line">        map.put(<span class="string">"remark"</span>,u.getRemark());</span><br><span class="line">        jedis.hmset(key, map);</span><br><span class="line">        System.out.println(<span class="string">"从数据库中查询结果并且赋值到redis的对象为："</span>+u);</span><br><span class="line">    &#125;</span><br><span class="line">    RedisPoolUtil.close(jedis);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<hr>
<p>-</p>
<h2 id="SpringData整合redis"><a href="#SpringData整合redis" class="headerlink" title="SpringData整合redis"></a>SpringData整合redis</h2><ol>
<li>步骤<blockquote>
<p>导入jar包</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Jedis客户端需要依赖的jar Redis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- springdata整个redis --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.data/spring-data-redis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.data<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/commons-logging/commons-logging --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<blockquote>
<p>编写配置文件：spring_redis.xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 注解扫描 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gdaib.service.impl"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span>	</span><br><span class="line">      <span class="comment">&lt;!-- 配置一个连接池信息 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jedisPoolConfig"</span> <span class="attr">class</span>=<span class="string">"redis.clients.jedis.JedisPoolConfig"</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 最大连接数 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxTotal"</span> <span class="attr">value</span>=<span class="string">"50"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 最大空闲数 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdle"</span> <span class="attr">value</span>=<span class="string">"5"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- Spring整合Jedis(redis) --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jedisConnectionFactory"</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.connection.jedis.JedisConnectionFactory"</span>&gt;</span> </span><br><span class="line">     	<span class="comment">&lt;!-- 指定服务器地址 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hostName"</span> <span class="attr">value</span>=<span class="string">"192.168.166.132"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 指定服务器端口号 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"port"</span> <span class="attr">value</span>=<span class="string">"6379"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 指定密码 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- 自定义连接池配置 --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"poolConfig"</span> <span class="attr">ref</span>=<span class="string">"jedisPoolConfig"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>	</span><br><span class="line">      <span class="comment">&lt;!-- RedisTemplate --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"redisTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.core.RedisTemplate"</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connectionFactory"</span> <span class="attr">ref</span>=<span class="string">"jedisConnectionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- key进行序列化设置，默认JDK改为String --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"keySerializer"</span>&gt;</span></span><br><span class="line">      		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.serializer.StringRedisSerializer"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      	<span class="comment">&lt;!-- value JDK默认为String --&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"valueSerializer"</span>&gt;</span></span><br><span class="line">      		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.serializer.StringRedisSerializer"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>编写业务逻辑接口：UserService</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * string 存和取测试</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getString</span><span class="params">(String key)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>编写该接口的实现类：UserServiceImpl.java</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * string类型测试	</span></span><br><span class="line"><span class="comment">	 * 通过某个key得到值</span></span><br><span class="line"><span class="comment">	 * 如果key在redis中不存在，到数据库查询</span></span><br><span class="line"><span class="comment">	 * 如果存在，就到redis中查询</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getString</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">		ValueOperations&lt;String, String&gt; string = redisTemplate.opsForValue();</span><br><span class="line">        <span class="comment">//先赋值后设置失效日期</span></span><br><span class="line">        <span class="comment">//redisTemplate.opsForValue().set("java1803", "这是一个测试数据");</span></span><br><span class="line">		<span class="comment">//redisTemplate.expire(key, 2, TimeUnit.HOURS);</span></span><br><span class="line">		redisTemplate.opsForValue().set(<span class="string">"java1803"</span>, <span class="string">"这是一个测试数据"</span>, <span class="number">2</span>, TimeUnit.SECONDS);</span><br><span class="line">		<span class="comment">//判断redis中是否存在key</span></span><br><span class="line">		<span class="keyword">if</span>(redisTemplate.hasKey(key)) &#123;</span><br><span class="line">			<span class="comment">//在redis中取出并返回</span></span><br><span class="line">			System.out.println(<span class="string">"在redis中取出并返回"</span>);</span><br><span class="line">			<span class="keyword">return</span> string.get(key);</span><br><span class="line">			</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">//查询数据库</span></span><br><span class="line">			String result=<span class="string">"RedisTemplate模板练习"</span>;</span><br><span class="line">			string.set(key,result);</span><br><span class="line">			System.out.println(<span class="string">"Mysql数据库中取出并返回"</span>);</span><br><span class="line">			<span class="keyword">return</span> result;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>编写测试类 RedisTemplateTest.java</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">    * 测试string RedisTemplate</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ApplicationContext ctx=<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"spring_redis.xml"</span>);</span><br><span class="line">    UserService userService = ctx.getBean(UserService.class);</span><br><span class="line">    String key=<span class="string">"java1803"</span>;</span><br><span class="line">    String result = userService.getString(key);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Redis客户端工具：<ul>
<li><code>https://redisdesktop.com/download</code></li>
<li><code>http://www.pc6.com/softview/SoftView_450180.html</code></li>
</ul>
</li>
<li>序列化：修改配置文件：<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- key进行序列化设置，默认JDK改为String --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"keySerializer"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.serializer.StringRedisSerializer"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- value JDK默认为String --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"valueSerializer"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.serializer.StringRedisSerializer"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<hr>
<h2 id="案例作业"><a href="#案例作业" class="headerlink" title="案例作业"></a>案例作业</h2><p>限制登录功能：用户在两个小时内仅允许输入错误密码3次。如果超过次数，限制其登录5小时。</p>
<ul>
<li>登录页面login.jsp（要求每次登录失败时，都给相应提示）</li>
<li>后台建个用户登录表。输入用户名和密码</li>
<li>如果用户在2分钟内输入密码错误3次，如果超过3次，给其提示：连续输错密码超过三次。限制其登录1小时</li>
<li>用户在2分钟内，仅允许输入错误密码5次、如果超过次数，限制其登录1小时。 （12306）</li>
</ul>
<hr>
<hr>
<h2 id="hash基本指令"><a href="#hash基本指令" class="headerlink" title="hash基本指令"></a>hash基本指令</h2><ul>
<li>案例<blockquote>
<p>业务逻辑 UserServiceImpl.java</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * hash 存储测试</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> u</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(User u)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">selectById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class="line">	<span class="comment">//模板的简化</span></span><br><span class="line">	<span class="meta">@Resource</span>(name=<span class="string">"redisTemplate"</span>)</span><br><span class="line">	HashOperations&lt;String, String,User&gt; hash;</span><br><span class="line">    <span class="comment">//存储 往redis中存储hash数据</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(User u)</span> </span>&#123;</span><br><span class="line">		hash.put(<span class="string">"user"</span>, u.getId()+<span class="string">""</span>, u);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据用户主键id查询对象</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">selectById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//先判断Redis中key是否存在，如果存在，从Redis中取出，并且返回</span></span><br><span class="line">		Boolean bol=<span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			bol = hash.hasKey(<span class="string">"user"</span>,id+<span class="string">""</span>);</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			bol=<span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(bol) &#123;</span><br><span class="line">			User u = (User) redisTemplate.opsForHash().get(<span class="string">"user"</span>, id+<span class="string">""</span>);</span><br><span class="line">			System.out.println(<span class="string">"redis数据库中查询的数据"</span>);</span><br><span class="line">			<span class="keyword">return</span> u;</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">//hash存储类型</span></span><br><span class="line">			com.gdaib.pojo.User u=<span class="keyword">new</span> com.gdaib.pojo.User(id,<span class="string">"哈哈呵呵"</span>,<span class="number">25</span>,<span class="string">"这是一个女明星！"</span>);</span><br><span class="line">			System.out.println(<span class="string">"mysql中查询的数据"</span>);</span><br><span class="line">			hash.put(<span class="string">"user"</span>, u.getId()+<span class="string">""</span>, u);</span><br><span class="line">			<span class="keyword">return</span> u;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//如果不存在，从数据库中查询，取出付给Redis，返回</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>测试代码</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisTemplateTest</span> </span>&#123;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 测试hash</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ApplicationContext ctx=<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"spring_redis.xml"</span>);</span><br><span class="line">		UserService userService = ctx.getBean(UserService.class);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//hash存储类型</span></span><br><span class="line">		com.gdaib.pojo.User u=<span class="keyword">new</span> com.gdaib.pojo.User(<span class="number">2</span>,<span class="string">"欧阳娜娜"</span>,<span class="number">20</span>,<span class="string">"这是一个女明星！"</span>);</span><br><span class="line">		userService.add(u);</span><br><span class="line">		System.out.println(<span class="string">"---------hash数据存储成功hash---------"</span>);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 测试hash</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ApplicationContext ctx=<span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"spring_redis.xml"</span>);</span><br><span class="line">		UserService userService = ctx.getBean(UserService.class);</span><br><span class="line">		<span class="keyword">int</span> id=<span class="number">7</span>;</span><br><span class="line">		User u = userService.selectById(id);</span><br><span class="line">		System.out.println(u);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>修改默认的序列化设置<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- RedisTemplate --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"redisTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.core.RedisTemplate"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connectionFactory"</span> <span class="attr">ref</span>=<span class="string">"jedisConnectionFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- hash key序列化设置，默认jdk改为hash --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hashKeySerializer"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.data.redis.serializer.StringRedisSerializer"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<hr>
<h2 id="List基本命令"><a href="#List基本命令" class="headerlink" title="List基本命令"></a><code>List</code>基本命令</h2><ul>
<li>Redis列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边）。</li>
<li>一个列表最多可以包含 2^32 - 1 个元素 (4294967295, 每个列表超过40亿个元素)。</li>
<li>类似于JAVA语言的<code>LinkedList</code>.</li>
<li>命令<blockquote>
<ul>
<li>赋值语法：<blockquote>
<ul>
<li><code>LPUSH key value1 [value2]</code>：讲一个或多个值插入到列表头部（从左侧添加）。</li>
<li><code>RPUSH key value1 [value2]</code>：在列表中添加一个或多个值（从右侧添加）。</li>
<li><code>LPUSHX key value</code>：将一个值插入到已经存在的列表头部。如果列表不存在，操作无效。</li>
<li><code>RPUSHX key value</code>：一个值插入到已经存在的列表的尾部（最右边）。如果列表不存在，操作无效。</li>
</ul>
</blockquote>
</li>
<li>取值语法：<blockquote>
<ul>
<li><code>LLEN key</code>：取得列表长度。</li>
<li><code>Lindex key index</code>：通过索引取得列表中的元素。</li>
<li><code>LRANGE key start stop</code>：获取列表指定范围的元素。（0代表一个元素，1代表第二个元素，-1代表最后元素，-2代表倒数第二个）</li>
</ul>
</blockquote>
</li>
<li>删除语法：<blockquote>
<ul>
<li><code>LPOP key</code>：溢出并获取列表的第一个元素（从左侧删除）。</li>
<li><code>RPOP key</code>：移除列表的最后一个元素，返回值为移除值。</li>
<li><code>BLPOP key1 [key2] timeout</code>：移除并获取列表的第一个元素，如果列表没有元素会阻塞列表直到等待超时或发现可弹出元素为止。（如果超时返回nil）</li>
<li><code>BRPOP key1 [key2 ] timeout</code>：移出并获取列表的最后一个元素， 如果列表没有元素会阻塞列表直到等待超时或发现可弹出元素为止。</li>
<li><code>LTRIM key start stop</code>：对一个列表进行修剪（trim），就是说，让列表只保留指定区间内的元素，不在指定区域内的元素都将被删除。</li>
</ul>
</blockquote>
</li>
<li>修改语法<blockquote>
<ul>
<li><code>LSET key index value</code>：通过索引设置列表元素的值。</li>
<li><code>LINSERT key BEFORE|AFTER world value2</code>:在列表指定元素前或后插入元素。</li>
</ul>
</blockquote>
</li>
<li>高级语法<blockquote>
<ul>
<li><code>RPOPLPUSH source destination</code>：移除列表最后一元素，并将该元素添加到另一个列表并返回。 </li>
<li><code>BRPOPLPUISH source destination timeout</code>：从列表中弹出一个值，将弹出的元素插入到另一个列表中并返回他；如果列表中没有元素会阻塞列表直到等待超时或者发现可弹出元素为止。</li>
<li><code>LREM key count value</code>：移除列表元素</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>应用场景<blockquote>
<ul>
<li>对数据量大的集合数据删减（列表展示、关注列表、粉丝列表、留言评价等…分页、热点新闻（TOP5）等）</li>
<li>任务队列</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Set类型"><a href="#Set类型" class="headerlink" title="Set类型"></a><code>Set</code>类型</h2><ul>
<li>Redis 的 Set 是 String 类型的无序集合。集合成员是唯一的，这就意味着集合中不能出现重复的数据。</li>
<li>Redis 中集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是 O(1)。</li>
<li>集合中最大的成员数为 232 - 1 (4294967295, 每个集合可存储40多亿个成员)。</li>
<li>底层是hashtable和intset。</li>
<li>命令<blockquote>
<ul>
<li>赋值语法<blockquote>
<ul>
<li><code>SADD key member1 [member2]</code>：向集合中添加一个或多个成员。</li>
</ul>
</blockquote>
</li>
<li>取值语法<blockquote>
<ul>
<li><code>SCARD key</code>：获取集合的成员数。</li>
<li><code>SMEMBERS key</code>：返回集合中的所有成员。</li>
<li><code>SISMENBER key member</code>：判断member元素是否是集合key的成员（开发中：验证是否存在判断）</li>
<li><code>SRANDMENBER key [count]</code>：返回集合中一个或多个随机数。</li>
<li><code>SSCAN key cursor [MATCH pattern] [COUNT count]</code>：迭代集合中的元素。</li>
</ul>
</blockquote>
</li>
<li>删除语法<blockquote>
<ul>
<li><code>SREM key member1 [member2]</code>：移除集合中一个或多个元素。</li>
<li><code>SPOP key[count]</code>：移除并返回集合中的一个随机元素。</li>
<li><code>SMOVE source destination member</code>：将member元素从source集合移动到destination集合。</li>
</ul>
</blockquote>
</li>
<li>差集语法<blockquote>
<ul>
<li><code>SDIFF key1 [key2]</code>：返回给定集合的差集（左侧）</li>
<li><code>SDIFFSTORE destination key1 [key2]</code>：返回给定所有集合的差集并存储在<code>destination</code>中。</li>
</ul>
</blockquote>
</li>
<li>交集语法<blockquote>
<ul>
<li><code>SINTER key1 [key2]</code>：返回给定所有集合的交集（共有的数据）。</li>
<li><code>SINTERSTORE key1 [key2]</code>：返回给定所有集合的交集并存储在<code>destination</code>中。</li>
</ul>
</blockquote>
</li>
<li>并集语法<blockquote>
<ul>
<li><code>SUNION key1 [key2]</code>：返回所有给定集合的并集。</li>
<li><code>SUNIONSTORE destination key1 [key2]</code>：返回所有给定集合的并集并存储在<code>destination</code>中。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>应用场景<blockquote>
<ul>
<li>常应用于：对两个集合间的数据【计算】进行并集、交集、差集运算。</li>
<li>非常方便实现如共同关注、共同爱好、二度好友等，</li>
<li>利用唯一性，还可以统计访问网站的所有独立IP。</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Zset类型"><a href="#Zset类型" class="headerlink" title="Zset类型"></a><code>Zset</code>类型</h2><ul>
<li>Redis 有序集合和集合一样也是string类型元素的集合,且不允许重复的成员。</li>
<li>不同的是每个元素都会关联一个double类型的分数。redis正是通过分数来为集合中的成员进行从小到大的排序。</li>
<li>有序集合的成员是唯一的,但分数(score)却可以重复。</li>
<li>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。 集合中最大的成员数为 232 - 1 (4294967295, 每个集合可存储40多亿个成员)。</li>
<li>底层是hashtable和intset。</li>
<li>命令<blockquote>
<ul>
<li>赋值语法<blockquote>
<ul>
<li><code>ZADD key source member1 [source2 member2]</code>：向有序集合中添加一个或多个成员，或者更新已存在成员的分数。</li>
</ul>
</blockquote>
</li>
<li>取值语法<blockquote>
<ul>
<li><code>ZCARD key</code>：获取有序集合元素的成员数。</li>
<li><code>ZCOUNT key min max</code>：计算在有序集合中指定区间分数的成员数。</li>
<li><code>ZRANK key member</code>：返回有序集合中指定成员（索引）。</li>
<li><code>ZRANGE key start stop [WITHSCORES]</code>：通过索引区间返回有序集合成员指定区间内的成员（低到高）。</li>
<li><code>ZREVRANGE key start stop[WITHSCORES]</code>：返回有序集合中指定区间内的成员，通过索引，分数从高到低。</li>
<li><code>ZREVRANGEBYSCORE key max min [WITHSCORES]</code>：返回有序集中指定分数区间内的成员，分数从高到低排序。</li>
<li><code>ZREVRANK key member</code>：返回有序集合中指定成员的排名，有序集成员按分数值递减(从大到小)排序。</li>
<li><code>ZSCORE key member</code>：返回有序集中，成员的分数值。</li>
<li><code>ZSCAN key cursor [MATCH pattern] [COUNT count]</code>:迭代有序集合中的元素（包括元素成员和元素分值）。</li>
<li><code>ZLEXCOUNT key min max</code>：在有序集合中计算指定字典区间内成员数量。</li>
<li><code>ZRANGEBYLEX key min max [LIMIT offset count]</code>：通过字典区间返回有序集合的成员。</li>
<li><code>ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT]</code>：通过分数返回有序集合指定区间内的成员。</li>
</ul>
</blockquote>
</li>
<li>删除语法<blockquote>
<ul>
<li><code>del key</code>：移除集合</li>
<li><code>ZREM key member [member2]</code>：移除有序集合中的一个或多个成员。</li>
<li><code>ZREMRANGEBYLEX key min max</code>：移除有序集合中给定的字典区间的所有成员。</li>
<li><code>ZREMRANGEBYRANK key start stop</code>：移除有序集合中给定的排名区间的所有成员(第一名为0)（低到高）。</li>
<li><code>ZREMRANGEBYSCORE key min max</code>：移除有序集合中给定的分数区间的所有成员。</li>
</ul>
</blockquote>
</li>
<li>并集语法<blockquote>
<ul>
<li><code>ZUNIONSTORE destination numkeys key [key ...]</code>：计算给定的一个或多个有序集的并集，并存储在新的 key 中</li>
</ul>
</blockquote>
</li>
<li>交集语法<blockquote>
<ul>
<li><code>ZINTERSTORE destination numkeys key [key ...]</code>：计算给定的一个或多个有序集的交集并将结果集存储在新的有序集合 key 中。</li>
</ul>
</blockquote>
</li>
<li>增量语法<blockquote>
<ul>
<li><code>ZINCRBY key increment member</code> ：有序集合中对指定成员的分数加上增量 increment。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>应用场景<blockquote>
<ul>
<li>常应用于：排行榜。</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="HyperLogLog类型"><a href="#HyperLogLog类型" class="headerlink" title="HyperLogLog类型"></a><code>HyperLogLog</code>类型</h2><ul>
<li>Redis 在 2.8.9 版本添加了 HyperLogLog 结构。</li>
<li>Redis HyperLogLog 是用来做基数统计的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定 的、并且是很小的。</li>
<li>在 Redis 里面，每个 HyperLogLog 键只需要花费 12 KB 内存，就可以计算接近 2^64 个不同元素的基 数。这和计算基数时，元素越多耗费内存就越多的集合形成鲜明对比。</li>
<li>但是，因为 HyperLogLog 只会根据输入元素来计算基数，而不会储存输入元素本身，所以 HyperLogLog 不能像集合那样，返回输入的各个元素。</li>
<li>什么是基数<blockquote>
<p>比如数据集 {1, 3, 5, 7, 5, 7, 8}， 那么这个数据集的基数集为 {1, 3, 5 ,7, 8}, 基数(不重复元素)为5。 基数估计就是在误差可接受的范围内，快速计算基数。</p>
</blockquote>
</li>
<li>命令<blockquote>
<ul>
<li>赋值语法<blockquote>
<ul>
<li><code>PFADD key element [element ...]</code>：添加指定元素到 HyperLogLog 中。</li>
</ul>
</blockquote>
</li>
<li>取值语法<blockquote>
<ul>
<li><code>PFCOUNT key [key ...]</code>：返回给定 HyperLogLog 的基数估算值。</li>
</ul>
</blockquote>
</li>
<li>合并语法<blockquote>
<ul>
<li><code>PFMERGE destkey sourcekey [sourcekey ...]</code>：将多个HyperLogLog合并为一个HyperLogLog。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Redis发布订阅"><a href="#Redis发布订阅" class="headerlink" title="Redis发布订阅"></a><code>Redis</code>发布订阅</h2><ul>
<li>简介：<ul>
<li>Redis发布订阅（pub/sub）是一种消息通信模式：发布者（pub）发布信息，订阅者（sub）接收信息。</li>
<li>Redis客户端可以订阅任意数量的频道。</li>
</ul>
</li>
<li>Redis 发布订阅命令<blockquote>
<ul>
<li>订阅频道<blockquote>
<ul>
<li><code>SUBSCRIBE channel [channel ...]</code>：订阅给定的一个或多个频道的信息。</li>
<li><code>PSUBSCRIBE pattern [pattern ...]</code>：订阅一个或多个符合给定模式的频道。</li>
</ul>
</blockquote>
</li>
<li>发布频道<blockquote>
<ul>
<li><code>PUBLISH channel message</code>：将信息发送到指定的频道。</li>
</ul>
</blockquote>
</li>
<li>退订频道<blockquote>
<ul>
<li><code>UNSUBSCRIBE [channel [channel ...]]</code>：指退订给定的频道。</li>
<li><code>PUNSUBSCRIBE [pattern [pattern ...]]</code>：退订所有给定模式的频道。</li>
</ul>
</blockquote>
</li>
<li>其他<blockquote>
<ul>
<li><code>PUBSUB subcommand [argument [argument ...]]</code>：查看订阅与发布系统状态。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>应用场景<blockquote>
<p>构建实时消息系统，比如普通的即时聊天，群聊等功能。</p>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Redis多数据库名称"><a href="#Redis多数据库名称" class="headerlink" title="Redis多数据库名称"></a><code>Redis</code>多数据库名称</h2><ul>
<li>简介<blockquote>
<ul>
<li><code>Redis</code>下，数据库是由一个整数索引标识，而不是由一个数据库名称。默认情况下，一个客户端连接到数据库0。</li>
<li><code>Redis</code>配置文件中下面的参数来控制数据库总数。<code>database 16(从0开始,1,2,3...15)</code></li>
</ul>
</blockquote>
</li>
<li>命令<blockquote>
<ul>
<li><code>select 数据库</code>：数据库切换。</li>
<li><code>move key名称 数据库</code>：将当前key移动另一库。</li>
<li><code>flushdb</code>：清除当前数据库所有的key。</li>
<li><code>flushall</code>：清除整个Redis的数据库所有key。</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Redis事务"><a href="#Redis事务" class="headerlink" title="Redis事务"></a><code>Redis</code>事务</h2><ul>
<li>简介<blockquote>
<ul>
<li>Redis 事务可以一次执行多个命令， 并且带有以下三个重要的保证：<blockquote>
<ul>
<li>批量操作在发送 EXEC 命令前被放入队列缓存。</li>
<li>收到 EXEC 命令后进入事务执行，事务中任意命令执行失败，其余的命令依然被执行。.</li>
<li>在事务执行过程，其他客户端提交的命令请求不会插入到事务执行命令序列中。</li>
</ul>
</blockquote>
</li>
<li>一个事务从开始到执行会经历以下三个阶段：<blockquote>
<ul>
<li>开始事务</li>
<li>命令入队</li>
<li>执行事务</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
</ul>
<h2 id><a href="#" class="headerlink" title></a><img src="https://i.loli.net/2019/11/24/FjEtpJTG7ebYIg2.png" alt="1574566543_1_.png"></h2><h2 id="Redis脚本"><a href="#Redis脚本" class="headerlink" title="Redis脚本"></a>Redis脚本</h2><ul>
<li>简介：<blockquote>
<ul>
<li>Redis脚本使用<code>Lua</code>解释器来执行脚本。Redis2.6版本通过内嵌支持Lua环境。执行脚本的命令为<code>EVAL</code>。</li>
</ul>
</blockquote>
</li>
<li>命令</li>
</ul>
<h2 id="-1"><a href="#-1" class="headerlink" title></a><img src="https://i.loli.net/2019/11/24/vz4SUXentQ2pONf.png" alt="1574586120_1_.png"></h2><h2 id="Redis连接"><a href="#Redis连接" class="headerlink" title="Redis连接"></a>Redis连接</h2><ul>
<li>redis连接命令主要用于连接redis服务</li>
<li>Redis连接命令<blockquote>
<ul>
<li><code>AUTH password</code>：检验密码是否正确</li>
<li><code>ECHO message</code>：打印字符串。</li>
<li><code>PING</code>：查看服务是否运行。</li>
<li><code>QUIT</code>：关闭当前连接。</li>
<li><code>SELECT index</code>：切换到指定的数据库。</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Redis持久化"><a href="#Redis持久化" class="headerlink" title="Redis持久化"></a>Redis持久化</h2><ul>
<li>简介<blockquote>
<ul>
<li>数据存放于：<blockquote>
<ul>
<li>内存：高效、断电内存会丢失。</li>
<li>硬盘：读写速度慢于内存，断电数据不会丢失。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>持久化方案<blockquote>
<ul>
<li>RDB</li>
<li>AOF</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Redis缓存与数据库一致性"><a href="#Redis缓存与数据库一致性" class="headerlink" title="Redis缓存与数据库一致性"></a><code>Redis</code>缓存与数据库一致性</h2><ul>
<li>解决方案<blockquote>
<ul>
<li>实现同步</li>
<li>异步队列</li>
<li>主从复制</li>
<li>采用UDF自定义函数的方式(触发器)</li>
<li>Lua实现</li>
<li>定时更新</li>
</ul>
</blockquote>
</li>
<li>缓存穿透</li>
<li>缓存雪崩</li>
<li>缓存击穿</li>
</ul>
<hr>
<h2 id="Redis高级"><a href="#Redis高级" class="headerlink" title="Redis高级"></a>Redis高级</h2><ul>
<li><p>高可用（一致都能用）0：通常描述一个系统经过专门的设计，从而减少停工时间，而保持其服务的高度可用性。</p>
</li>
<li><p>该并发：高并发式是互联网分布式系统架构设计中必须考虑的因素之一，他通常是指，通过设计保证系统能够同时并行处理很多请求。</p>
<blockquote>
<ul>
<li>高并发相关常用的一些指标有响应时间，吞吐量，每秒查询率（QPS）,并发用户数等。</li>
<li>响应时间：系统对请求做出响应的时间。例如系统处理一个HTTP请求需要200ms，这个200ms就是系统的响应时间。</li>
<li>吞吐量：单位时间内处理的请求数量。</li>
<li>QPS：每秒响应请求数。在互联网领域中，这个指标和吞吐量区分的没有这么明显。</li>
<li>并发用户数：同时承载正常使用系统功能的用户数量。 </li>
</ul>
</blockquote>
</li>
<li><p>提升系统的并发能力</p>
<blockquote>
<ul>
<li>垂直扩展</li>
<li>水平扩展</li>
</ul>
</blockquote>
</li>
</ul>
<hr>
<h2 id="Redis主从复制"><a href="#Redis主从复制" class="headerlink" title="Redis主从复制"></a>Redis主从复制</h2><ul>
<li>应用场景:多读少写</li>
</ul>
<hr>
<h2 id="Redis-Cluster集群"><a href="#Redis-Cluster集群" class="headerlink" title="Redis Cluster集群"></a><code>Redis Cluster</code>集群</h2><ul>
<li>简介：<blockquote>
<ul>
<li>为什么使用<code>redis-cluster</code>？</li>
<li>为了大流量访问下提供稳定的业务，集群化是存储的必然形态。</li>
<li>未来的发展趋势肯定是云计算和大数据紧密结合。</li>
<li>只有分布式架构满足需求。</li>
</ul>
</blockquote>
</li>
<li>Redis集群的搭建方案<blockquote>
<ul>
<li>Twitter开发的twemproxy</li>
<li>豌豆荚开发的codis</li>
<li>redis官方的redis-cluster</li>
</ul>
</blockquote>
</li>
<li><code>redis-cluster</code>特点</li>
<li><code>redis cluster</code>容错性</li>
</ul>
<hr>
<h2 id="Redis-Cluster集群搭建"><a href="#Redis-Cluster集群搭建" class="headerlink" title="Redis Cluster集群搭建"></a><code>Redis Cluster</code>集群搭建</h2><ul>
<li>简介：<blockquote>
<p>集群中至少应该有奇数个节点，所以搭建集群最少需要3台主机(master)。同时每个节点至少有一个备份节点（slaver），所以下面最少需要6台机器，才能完成Redis-Cluster集群（主节点，备节点由redis-cluster集群确定）</p>
</blockquote>
</li>
<li>真集群：准备6台机器</li>
<li>假集群：一台服务器存在6个redis服务。</li>
<li>搭建流程<blockquote>
<ul>
<li>创建<code>Redis</code>节点安装目录，<code>mkdir /usr/local/redis_cluster</code> //指定目录下 创建redis_cluster</li>
<li>在<code>redis_cluster</code>目录下，创建7001-7006个文件夹下，<code>mkdir 7001 7002 7003 7004 7005 7006</code></li>
<li>并将redis-conf分别拷贝到7001-7006文件夹下：<code>cp /root/redis-4.0.1/redis.conf ./7001</code></li>
<li>分别修改如下配置文件，修改如下内容：<blockquote>
<ul>
<li>同时<code>protected-mode</code>是为了禁止公网访问redis cache，加强了redis的安全性。</li>
<li>没有bind IP</li>
<li>没有设置访问密码</li>
<li>由于Linux上的redis处于安全保护模式，这就让你无法从虚拟机外部去轻松建立连接。</li>
<li>如果外部访问：redis.conf中设置保护模式：protected-mode yes </li>
<li>bind 127.0.0.1// 注释掉</li>
<li>port 7000 //绑定端口，必须修改，以此来区分Redis实例</li>
<li>daemonize yes//后台运行</li>
<li>pidfile /var/run/redis-7001.pid//修改pid进行文件名，以端口号命名</li>
<li>cluster-enabled yes//启用集群</li>
<li>cluster-config-file nodes-7000.conf //配置每个节点的配置文件，同样以端口为名称</li>
<li>cluster-node-timeout 15000 //配置集群的超时时间，可改可不改</li>
<li>appendonly yes://启动AOF增量持久化策略</li>
<li>appendfsync always//发生改变就记录日志</li>
</ul>
</blockquote>
</li>
<li>把redis/src/的文件拷贝到7001-7006目录下 cp -r ./src /usr/local/redis_cluster/7001</li>
<li>分别启动redis-server</li>
</ul>
</blockquote>
</li>
<li>创建集群<blockquote>
<ul>
<li>Redis官方提供了redis-trib.rb这个工具，就在解压目录下的src目录中（为了方便操作），将其文件复制到/usr//local/bin目录下，可直接访问此命令:<code>cd redis-4.0.1/</code>、<code>cd src</code>、<code>cp redis-trib.rb /usr/local/bin/</code></li>
<li>可以直接在命令中执行：ip:port格式<code>redis-trib.rb create --replicas 1 127.0.0.1:7001 ...</code> </li>
<li>如果出现下面此错误：则需要安装ruby，这个工具是用ruby实现的。</li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/r5NAg4F9Mikn1oj.png" alt="1574817437_1_.png"> </p>
<ul>
<li>安装ruby<blockquote>
<ul>
<li><code>yum -y install ruby ruby-devel rubygems rpm-build</code></li>
<li><code>gem install redis</code></li>
<li>如下错误原因，centos默认支持ruby到2.0.0，可gem安装redis需要最低是2.2.2</li>
<li>解决办法是：先安装rvm，再把ruby升级</li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/sk3GPXBix9MYUbW.png" alt="1574817822_1_.png"></p>
<ul>
<li><p>安装rvm （出现错误时查看以下一个点）</p>
<blockquote>
<ul>
<li><code>gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3</code></li>
<li><code>curl -sSL https://get.rvm.io | bash -s stable</code></li>
<li><code>find / -name rvm -print</code></li>
<li><code>source /usr/local/rvm/scripts/rvm</code></li>
<li><code>rvm list known</code>//查看rvm库中已知的ruby版本。</li>
</ul>
</blockquote>
</li>
<li><p>安装一个ruby版本</p>
<blockquote>
<ul>
<li><code>rvm install 2.4.4</code></li>
<li><code>rvm use 2.4.4</code>//使用一个ruby版本</li>
<li><code>rvm use 2.4.4 --default</code>//设置默认版本</li>
<li><code>ruby --version</code>//查看ruby版本</li>
<li><code>gem install redis</code>//安装redis</li>
</ul>
</blockquote>
</li>
<li><p>重新执行<code>redis-trib.rb create --replicas 1 127.0.0.1:7001 ...</code>创建集群，结果如下：</p>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/adNWkpr5PLX7jhS.png" alt="1574820682_1_.png"></p>
<ul>
<li>最终结果</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/YH6WpwbCTnctAUu.png" alt="1574820970_1_.png"></p>
<ul>
<li>创建成功。</li>
</ul>
<hr>
<h2 id="Linux-CentOS下通过ruby搭建redis集群"><a href="#Linux-CentOS下通过ruby搭建redis集群" class="headerlink" title="Linux CentOS下通过ruby搭建redis集群"></a>Linux CentOS下通过ruby搭建redis集群</h2><ul>
<li>通过下载安装包<blockquote>
<ul>
<li><code>ruby-2.3.1.tar.gz</code></li>
<li><code>redis-3.3.0.gem</code></li>
</ul>
</blockquote>
</li>
<li>通过wget命令<blockquote>
<ul>
<li><code>wget https://cache.ruby-lang.org/pub/ruby/2.3/ruby-2.3.1.tar.gz</code></li>
<li><code>wget http://rubygems.org/downloads/redis-3.3.0.gem</code></li>
</ul>
</blockquote>
</li>
<li>1跟2都会先出现 zlib包不存在以及openssl不存在的问题，zlib可以通过如下方式解决<blockquote>
<ul>
<li><code>yum -y install zlib-devel</code></li>
<li>进入ruby源码文件夹,安装ruby自身提供的zlib包<blockquote>
<ul>
<li><code>cd ruby-2.3.1/ext/zlib</code></li>
<li><code>ruby ./extconf.rb</code></li>
<li><code>make</code></li>
<li><code>make install</code></li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
<li>通过yum install<blockquote>
<ul>
<li>默认安装的ruby版本低于2.2，无法创建redis集群，可以安装了之后再通过rvm工具升级，还不如直接使用rvm</li>
</ul>
</blockquote>
</li>
<li>通过ruby的版本管理工具rvm<blockquote>
<ul>
<li>4.1:<code>curl -L get.rvm.io | bash -s stable</code></li>
<li><code>yum install -y crul</code>（如果发现curl没有安装，则执行这个之后再执行4.1）</li>
<li>如果遇到<code>CURLE_SSL_CONNECT_ERROR return</code> status(35)的错误，执行<code>yum -y update nss</code>，再重新执行4.1</li>
<li>此时打印信息</li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/oldEYHkaNhJFgwi.png" alt="1574819789_1_.png"></p>
<blockquote>
<ul>
<li>通过以上信息，需要try to install GPG v2再 fetch the public key</li>
<li>因此执行 <code>command curl -sSL https://rvm.io/mpapis.asc | gpg2 --import -</code> 再执行 4.1</li>
</ul>
</blockquote>
<ul>
<li><code>find / -name rvm -print</code></li>
<li><code>source /usr/local/rvm/scripts/rvm</code></li>
<li><code>rvm list known</code></li>
</ul>
<hr>
<h2 id="Redis-cluster集群验证"><a href="#Redis-cluster集群验证" class="headerlink" title="Redis cluster集群验证"></a><code>Redis cluster</code>集群验证</h2><ul>
<li>Redis集群测试<blockquote>
<ul>
<li>为方便测试，可将<code>redis-cli</code>客户端命令放到<code>/usr/local/bin</code>目录下</li>
<li><code>cd /root/redis-4.0.14/src</code> //进入该目录</li>
<li><code>cp redis-cli /usr/local/bin</code></li>
</ul>
</blockquote>
</li>
<li>在某台机器上（或）连接集群的7001端口的节点上：<blockquote>
<ul>
<li><code>redis-cli -h 127.0.0.1 -c -p 7001</code></li>
</ul>
</blockquote>
</li>
<li>查看集群信息<blockquote>
<ul>
<li><code>info replication</code></li>
</ul>
</blockquote>
</li>
<li>查看主从关系<blockquote>
<ul>
<li>输入命令 <code>cluster nodes</code></li>
</ul>
</blockquote>
</li>
</ul>
<p><img src="https://i.loli.net/2019/11/27/sVkTmc4ZuMAqEfH.png" alt="1574821797_1_.png"></p>
<p><img src="https://i.loli.net/2019/11/27/uTgBP5xiIEMNK3z.png" alt="1574821814_1_.png"></p>
<ul>
<li><p>主从复制：主做增删改，从做查询功能</p>
</li>
<li><p>外部使用(针对centos6)</p>
<blockquote>
<ul>
<li>开启端口权限，依次开放端口7001 7002…7006 <blockquote>
<ul>
<li><code>vi /etc/sysconfig/iptables</code> </li>
</ul>
</blockquote>
</li>
<li>重启防火墙<blockquote>
<ul>
<li><code>service iptables restart</code></li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
</ul>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/17/数据库系统概述/">数据库系统概述</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-17T11:50:32.000Z" itemprop="datePublished">2019-11-17</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/数据库系统概述/">数据库系统概述</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="第一章-绪论"><a href="#第一章-绪论" class="headerlink" title="第一章 绪论"></a>第一章 绪论</h2><h3 id="数据库系统概述"><a href="#数据库系统概述" class="headerlink" title="数据库系统概述"></a>数据库系统概述</h3><ol>
<li><p>数据库地位</p>
<blockquote>
<ul>
<li>数据库是管理数据的最新技术。</li>
<li>数据库技术是信息系统的核心和基础。</li>
</ul>
</blockquote>
</li>
<li><p>四个基本概念</p>
</li>
</ol>
<blockquote>
<ul>
<li><code>数据(data)</code><blockquote>
<ul>
<li>数据是数据库中存储的基本对象</li>
<li>数据的定义：描述事物的符号记录成为数据。</li>
<li>数据的语义：数据的含义成为数据的语义，数据与其语义是不可分的。</li>
<li>记录是计算机中表示和存储数据的一种格式或一种方法。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><code>数据库(DataBase，DB)</code><blockquote>
<ul>
<li>数据库，顾名思义，就是存储数据的仓库。只不过这个仓库是在计算机存储设备上，而且数据是按照一定的的格式存放的。</li>
<li>数据库的定义：数据库是长期存储在计算机中的、有组织的、可共享的大量的数据的集合。</li>
<li>数据库中的数据按照一定的额数据模型组织，描述和存储，具有较小的冗余度，较高的数据独立性和易扩展性，并可为多用户共享。</li>
<li>概括的讲，数据库数据具有永久存储、有组织和可共享三个基本特点。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><code>数据库管理系统(DataBase Management System，DBMS)</code><blockquote>
<ul>
<li>了解了数据和数据库的基本概念，下一个问题就是如何科学的组织和存储数据，如何高效的获取和恢复数据。完成这个任务的是一个软件–数据库管理系统。</li>
<li>数据库管理系统是位于用户与操作系统之间的一层数据管理软件。数据库管理系统与操作系统一样是计算机的基础软件，也是一个大型复杂的软件系统。</li>
<li>数据库管理的功能:数据定义功能(DDL)、数据组织，存储和管理、数据库的操纵功能、数据库的事务管理和运行管理、数据库的建立和维护功能、其他功能。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><code>数据库系统(DataBase System,DBS)</code><blockquote>
<ul>
<li>数据库系统是由数据库、数据库管理系统、应用程序和数据库管理员<code>(DataBase Administrator,DBA)</code>组成的存储、管理、处理和维护数据的系统。 </li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<p><img src="https://i.loli.net/2019/11/19/hfeGLaSRoBixvwp.png" alt="DBS.png"></p>
<blockquote>
<blockquote>
<ul>
<li>其中，数据库提供数据的存储功能，数据库管理系统提供数据的组织、存取、管理和维护等基础功能，数据库应用系统根据应用需求使用数据库，数据库管理员负责全面管理数据库系统。</li>
</ul>
</blockquote>
</blockquote>
<p><img src="https://i.loli.net/2019/11/19/BOz9LGVM4Z1Nxby.png" alt="层次结构.png"></p>
<blockquote>
<blockquote>
<ul>
<li>在一般不引起混杂的情况下，人们常常把数据库系统简称数据库。</li>
</ul>
</blockquote>
</blockquote>
<h3 id="数据库管理技术的产生和发展"><a href="#数据库管理技术的产生和发展" class="headerlink" title="数据库管理技术的产生和发展"></a>数据库管理技术的产生和发展</h3><ol>
<li>数据库技术是应数据管理任务的需要而产生的。</li>
<li>数据管理：数据管理是指对数据进行分类、组织、编码、存储、检索和维护，它是数据处理的中心问题。</li>
<li>数据处理：数据处理是指对各种数据进行收集、存储、加工和传播的一系列的活动的总和。</li>
<li>在应用需求的推动下，在计算机硬件、软件基础上，数据管理技术经历了人工管理、文件系统、数据库技术三个阶段。这三个阶段的特点如下表所示：</li>
</ol>
<p><img src="https://i.loli.net/2019/11/20/PWB5OjCcolwpfh7.png" alt="DBMS-3.png"></p>
<ol start="5">
<li>人工管理阶段<blockquote>
<ul>
<li>20世纪50年代中期以前，计算机主要用于科学计算。当时的硬件条件是，外存只有纸带、卡片和磁带、没有磁盘等直接存储的设备；软件条件是，没有操作系统，没有管理数据的专门软件;数据处理方式是批处理。</li>
<li>人工管理数据具有如下特点:<blockquote>
<ul>
<li>数据不保存</li>
<li>应用程序管理数据</li>
<li>数据不共享</li>
<li>数据不具备独立性</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
</li>
</ol>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/CPWS.github.io/2019/11/16/HttpClient/">HttpClient</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://CPWS.github.io/categories/back-end/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-11-16T08:24:20.000Z" itemprop="datePublished">2019-11-16</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/CPWS.github.io/tags/HttpClient/">HttpClient</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="HttpCLient使用步骤"><a href="#HttpCLient使用步骤" class="headerlink" title="HttpCLient使用步骤"></a>HttpCLient使用步骤</h2><p>模拟浏览器调用服务层请求数据.</p>
<h3 id="Get请求"><a href="#Get请求" class="headerlink" title="Get请求"></a>Get请求</h3><ul>
<li><p>实现步骤</p>
<ul>
<li>第一步：把HttpClient使用的jar包添加到工程中。</li>
<li>第二步：创建一个HttpClient的测试类</li>
<li>第三步：创建测试方法。</li>
<li>第四步：创建一个HttpClient对象</li>
<li>第五步：创建一个HttpGet对象，需要制定一个请求的url</li>
<li>第六步：执行请求。</li>
<li>第七步：接收返回结果。HttpEntity对象。</li>
<li>第八步：取响应的内容。</li>
<li>第九步：关闭HttpGet、HttpClient。</li>
</ul>
</li>
<li><p>测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testHttpGet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// 第一步：把HttpClient使用的jar包添加到工程中。</span></span><br><span class="line">    <span class="comment">// 第二步：创建一个HttpClient的测试类</span></span><br><span class="line">    <span class="comment">// 第三步：创建测试方法。</span></span><br><span class="line">    <span class="comment">// 第四步：创建一个HttpClient对象</span></span><br><span class="line">    CloseableHttpClient httpClient = HttpClients.createDefault();</span><br><span class="line">    <span class="comment">// 第五步：创建一个HttpGet对象，需要制定一个请求的url</span></span><br><span class="line">    HttpGet get = <span class="keyword">new</span> HttpGet(<span class="string">"http://www.itheima.com"</span>);</span><br><span class="line">    <span class="comment">// 第六步：执行请求。</span></span><br><span class="line">    CloseableHttpResponse response = httpClient.execute(get);</span><br><span class="line">    <span class="comment">// 第七步：接收返回结果。HttpEntity对象。</span></span><br><span class="line">    HttpEntity entity = response.getEntity();</span><br><span class="line">    <span class="comment">// 第八步：取响应的内容。</span></span><br><span class="line">    String html = EntityUtils.toString(entity);</span><br><span class="line">    System.out.println(html);</span><br><span class="line">    <span class="comment">// 第九步：关闭response、HttpClient。</span></span><br><span class="line">    response.close();</span><br><span class="line">    httpClient.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="Post请求"><a href="#Post请求" class="headerlink" title="Post请求"></a>Post请求</h3><ul>
<li>实现步骤<ul>
<li>第一步：创建一个httpClient对象</li>
<li>第二步：创建一个HttpPost对象。需要指定一个url</li>
<li>第三步：创建一个list模拟表单，list中每个元素是一个NameValuePair对象</li>
<li>第四步：需要把表单包装到Entity对象中。StringEntity</li>
<li>第五步：执行请求。</li>
<li>第六步：接收返回结果</li>
<li>第七步：关闭流。</li>
</ul>
</li>
<li>测试代码<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testHttpPost</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 第一步：创建一个httpClient对象</span></span><br><span class="line">    CloseableHttpClient httpClient = HttpClients.createDefault();</span><br><span class="line">    <span class="comment">// 第二步：创建一个HttpPost对象。需要指定一个url</span></span><br><span class="line">    HttpPost post = <span class="keyword">new</span> HttpPost(<span class="string">"http://localhost:8082/posttest.html"</span>);</span><br><span class="line">    <span class="comment">// 第三步：创建一个list模拟表单，list中每个元素是一个NameValuePair对象</span></span><br><span class="line">    List&lt;NameValuePair&gt; formList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    formList.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string">"name"</span>, <span class="string">"张三"</span>));</span><br><span class="line">    formList.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string">"pass"</span>, <span class="string">"1243"</span>));</span><br><span class="line">    <span class="comment">// 第四步：需要把表单包装到Entity对象中。StringEntity</span></span><br><span class="line">    StringEntity entity = <span class="keyword">new</span> UrlEncodedFormEntity(formList, <span class="string">"utf-8"</span>);</span><br><span class="line">    post.setEntity(entity);</span><br><span class="line">    <span class="comment">// 第五步：执行请求。</span></span><br><span class="line">    CloseableHttpResponse response = httpClient.execute(post);</span><br><span class="line">    <span class="comment">// 第六步：接收返回结果</span></span><br><span class="line">    HttpEntity httpEntity = response.getEntity();</span><br><span class="line">    String result = EntityUtils.toString(httpEntity);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">    <span class="comment">// 第七步：关闭流。</span></span><br><span class="line">    response.close();</span><br><span class="line">    httpClient.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>

        
    </section>
</article>




<nav class="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/CPWS.github.io/categories/back-end/page/2/">2</a><a class="page-number" href="/CPWS.github.io/categories/back-end/page/3/">3</a><a class="extend next" rel="next" href="/CPWS.github.io/categories/back-end/page/2/">Next &raquo;</a>
</nav>



            </div>
        </div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?e4027971a230b210f4671f485b33846a";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
</footer>

    </main>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }

            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle();
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp();
            }, 3000);
        }
    });
    </script>
    

</body>
</html>
